<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sleep Study — 2026-02-04</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:wght@300;400;500;600&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #0a0e14;
    color: #c5cdd8;
    font-family: 'IBM Plex Sans', sans-serif;
    padding: 8px 32px 0;
    min-height: 100vh;
    overflow: hidden;
  }

  h1 {
    font-size: 20px;
    font-weight: 600;
    color: #e8ecf0;
    margin-bottom: 4px;
    letter-spacing: -0.3px;
  }

  .subtitle {
    font-size: 13px;
    color: #6b7a8d;
    margin-bottom: 8px;
    font-family: 'IBM Plex Mono', monospace;
  }

  .chart-container {
    position: relative;
    width: 100%;
  }

  canvas {
    display: block;
    width: 100% !important;
  }

  canvas.zoomed { cursor: grab; }
  canvas.zoomed.panning { cursor: grabbing; }

  .legend {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    margin-bottom: 6px;
    padding: 6px 16px;
    background: #111822;
    border-radius: 6px;
    border: 1px solid #1e2a38;
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    font-family: 'IBM Plex Mono', monospace;
    color: #8899aa;
  }

  .legend-swatch {
    width: 14px;
    height: 4px;
    border-radius: 2px;
  }

  .legend-swatch.dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
  }

  .legend-swatch.bar {
    width: 14px;
    height: 10px;
    border-radius: 2px;
  }

  .tooltip-box {
    position: absolute;
    display: none;
    pointer-events: none;
    background: #161e28;
    border: 1px solid #2a3a4a;
    border-radius: 6px;
    padding: 8px 12px;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 11px;
    color: #c5cdd8;
    z-index: 100;
    white-space: nowrap;
    box-shadow: 0 4px 16px rgba(0,0,0,0.4);
  }

  .tooltip-box .tt-time {
    font-weight: 600;
    color: #e8ecf0;
    margin-bottom: 4px;
  }

  .tooltip-box .tt-row {
    display: flex;
    align-items: center;
    gap: 6px;
    margin: 2px 0;
  }

  .tooltip-box .tt-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .crosshair {
    position: absolute;
    top: 0;
    width: 1px;
    background: rgba(100,140,180,0.25);
    pointer-events: none;
    display: none;
  }

  .btn-bar {
    position: fixed;
    top: 12px;
    right: 16px;
    display: flex;
    gap: 8px;
    z-index: 200;
  }

  .theme-toggle {
    background: #1a2430;
    border: 1px solid #2a3a4a;
    color: #8899aa;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 11px;
    padding: 5px 12px;
    border-radius: 4px;
    cursor: pointer;
  }
  .theme-toggle:hover { background: #243040; color: #b0c0d0; }

  .version-stamp {
    position: fixed;
    top: 38px;
    right: 16px;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 9px;
    color: #2a3a4a;
    z-index: 200;
    text-align: right;
  }
  body.light-theme .version-stamp { color: #c0c0c0; }

  body.light-theme { background: #ffffff; color: #333; }
  body.light-theme h1 { color: #111; }
  body.light-theme .subtitle { color: #555; }
  body.light-theme .legend { background: #f0f0f0; border-color: #ccc; }
  body.light-theme .legend-item { color: #555; }
  body.light-theme .tooltip-box { background: #fff; border-color: #bbb; color: #333; box-shadow: 0 4px 16px rgba(0,0,0,0.15); }
  body.light-theme .tooltip-box .tt-time { color: #111; }
  body.light-theme .crosshair { background: rgba(0,0,0,0.2); }
  body.light-theme .theme-toggle { background: #e8e8e8; border-color: #ccc; color: #555; }
  body.light-theme .theme-toggle:hover { background: #ddd; color: #333; }

  @media print {
    body { background: #fff !important; color: #333 !important; padding: 4px 16px !important; overflow: visible !important; }
    h1 { color: #111 !important; }
    .subtitle { color: #555 !important; }
    .legend { background: #f5f5f5 !important; border-color: #ccc !important; }
    .legend-item { color: #555 !important; }
    .btn-bar { display: none !important; }
    .version-stamp { display: none !important; }
    .tooltip-box, .crosshair { display: none !important; }
  }
</style>
</head>
<body>

<div class="btn-bar">
  <button class="theme-toggle" id="resetZoom" style="display:none;" onclick="resetZoom()">&#x21BA; Reset Zoom</button>
  <button class="theme-toggle" id="savePng" onclick="savePNG(2)">&#x1F4BE; Save PNG 2x</button>
  <button class="theme-toggle" id="savePng1x" onclick="savePNG(1)">&#x1F4BE; Save PNG 1x</button>
  <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">&#x263C; Light</button>
</div>
<div class="version-stamp" id="versionStamp">v1.0.0 &middot; 2026-02-06</div>

<h1>Overnight Sleep Study</h1>
<div class="subtitle">2026-02-04 22:42 &rarr; 2026-02-05 07:04 &nbsp;&middot;&nbsp; ~8h 22m recording &nbsp;&nbsp; • &nbsp;Apneas &gt;10s: 194, &gt;50s: 1</div>

<div class="legend" id="legendBar">
  <div class="legend-item"><div class="legend-swatch" id="lsw-spo2" style="background:#48b8e8"></div>SpO&#x2082; (%)</div>
  <div class="legend-item"><div class="legend-swatch" id="lsw-hr" style="background:#e85878"></div>Heart Rate (bpm)</div>
  <div class="legend-item"><div class="legend-swatch" id="lsw-hrma" style="background:rgba(255,220,80,0.85)"></div>HR Trend (~5m avg)</div>
  <div class="legend-item"><div class="legend-swatch" id="lsw-resp" style="background:#58d888"></div>Resp. Rate (br/min)</div>
  <div class="legend-item"><div class="legend-swatch bar" id="lsw-apnea" style="background:rgba(255,80,60,0.5)"></div>Apnea Event</div>
  <div class="legend-item"><div class="legend-swatch bar" id="lsw-apnealong" style="background:rgba(255,220,40,0.8)"></div>Apnea &gt;50s</div>
  <div class="legend-item"><div class="legend-swatch dot" id="lsw-omod" style="background:#f0a030"></div>Obstruction (mod)</div>
  <div class="legend-item"><div class="legend-swatch dot" id="lsw-osev" style="background:#ff4040"></div>Obstruction (sev)</div>
  <div class="legend-item"><div class="legend-swatch bar" id="lsw-mot" style="background:rgba(160,140,220,0.5)"></div>Motion</div>
  <div class="legend-item"><div class="legend-swatch" id="lsw-good" style="background:rgba(80,200,120,0.5); border-top: 2px dotted rgba(80,200,120,0.8); height:0; width:18px;"></div>Restful (&ge;15m)</div>
</div>

<div class="chart-container" id="chartArea">
  <canvas id="mainCanvas"></canvas>
  <div class="crosshair" id="crosshair"></div>
  <div class="tooltip-box" id="tooltip"></div>
</div>

<script>
// ============================================================
// DATA (minutes since midnight of recording start date)
// ============================================================
const RAW = {"sleepU":{"t0":1362.45,"dt":0.066667,"spo2":[98,98,98,98,98,98,98,98,98,98,98,96,96,96,96,98,98,98,96,96,96,95,95,95,95,94,93,93,93,93,95,95,94,93,93,93,93,93,93,93,93,93,98,97,96,96,95,95,95,95,95,96,95,95,96,96,98,98,98,98,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,96,96,96,98,98,97,96,96,98,98,98,98,98,98,98,98,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,95,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,98,98,98,98,98,97,97,97,96,97,97,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,94,95,96,96,97,97,98,98,98,97,97,96,96,98,98,97,97,96,96,96,96,98,98,98,98,98,98,98,98,98,98,97,97,98,98,98,98,98,98,98,98,98,98,98,96,98,98,98,98,98,98,97,97,96,96,96,97,98,98,98,98,97,96,96,96,96,95,95,95,95,95,96,96,95,94,94,94,94,94,93,93,93,92,92,92,96,96,97,97,96,96,96,96,96,96,96,96,98,98,98,98,98,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,94,94,96,96,96,96,96,96,96,96,96,96,96,97,97,96,95,94,94,94,95,95,95,96,96,96,96,96,96,96,95,94,95,95,95,95,95,95,94,94,95,96,96,96,96,95,95,95,94,95,95,95,95,95,95,95,94,93,93,94,95,95,95,95,94,94,94,95,95,95,94,94,94,94,94,93,93,93,94,94,94,94,96,98,99,98,98,98,97,96,95,94,93,93,93,93,93,93,93,93,93,93,93,92,92,93,93,93,92,92,93,94,93,93,93,93,93,94,93,93,94,94,93,93,94,95,95,95,95,95,94,93,93,93,93,93,95,96,98,98,97,96,95,95,95,95,95,96,96,95,94,95,95,96,96,96,96,95,95,95,95,95,95,95,95,95,98,98,98,98,98,98,98,97,98,98,98,98,98,98,97,97,97,97,97,96,97,96,96,96,96,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,96,96,96,96,95,96,96,96,96,96,95,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,96,96,95,95,96,96,95,95,95,95,95,95,95,95,95,95,95,95,95,96,96,96,96,96,97,97,96,96,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,98,98,98,98,99,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,96,96,96,97,97,97,98,97,97,97,97,97,97,97,97,96,97,97,97,97,96,97,98,97,97,96,96,96,96,96,96,97,97,96,96,96,96,97,97,97,97,97,97,97,97,97,97,97,96,96,96,96,96,96,97,97,97,96,96,96,96,97,97,97,97,97,97,97,98,98,98,97,97,96,96,96,96,96,97,97,97,97,98,97,96,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,96,96,96,96,96,96,97,97,98,97,96,95,95,96,97,96,96,96,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,96,96,96,95,95,96,96,96,95,94,95,97,97,97,96,96,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,94,95,96,96,96,96,96,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,95,96,97,96,96,96,96,95,94,94,94,95,95,95,94,95,96,96,96,96,96,96,95,95,93,93,97,98,97,97,97,97,97,96,96,96,96,95,94,96,98,98,97,97,96,96,96,96,96,95,94,95,97,97,97,97,96,96,96,96,94,93,95,98,98,98,98,98,97,96,96,96,96,96,96,95,95,94,95,98,98,98,98,97,96,97,97,96,96,96,96,95,96,96,96,96,95,95,95,96,96,96,96,96,96,96,94,93,94,96,97,97,97,97,97,97,96,96,96,96,96,96,96,96,95,94,94,96,97,97,97,97,96,96,97,96,96,96,96,97,96,96,96,96,95,95,95,96,96,97,97,96,96,96,96,96,97,97,99,99,99,98,98,98,98,99,98,98,98,98,98,98,98,98,97,97,98,96,96,98,98,96,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,98,97,96,96,95,95,96,96,96,96,96,96,96,96,96,96,95,96,95,94,93,95,96,96,96,94,94,94,94,98,98,97,96,97,97,95,95,95,95,95,96,95,94,94,94,96,97,96,96,96,97,95,96,96,95,95,97,98,99,98,98,98,98,98,98,98,96,96,96,95,95,95,94,93,93,93,93,95,98,98,98,98,98,98,98,94,94,93,98,98,98,96,96,95,95,95,95,91,93,96,98,98,98,98,96,95,94,93,93,93,93,95,99,99,98,98,98,98,97,97,96,96,96,98,96,96,95,95,97,96,96,97,97,97,97,97,97,97,97,98,99,99,99,99,98,98,98,97,97,96,96,98,98,98,97,95,95,94,93,92,92,98,98,97,96,96,94,94,94,98,98,98,97,97,98,98,98,98,96,96,95,95,95,97,96,96,96,95,95,94,96,98,98,98,98,97,96,96,96,96,96,94,94,98,98,98,98,97,97,97,97,97,95,95,95,95,98,98,98,98,98,96,96,97,98,98,97,95,95,95,95,95,95,95,95,98,98,98,98,98,98,98,98,98,98,98,98,99,99,99,98,98,96,96,96,96,96,96,92,95,95,95,97,96,97,97,98,98,97,97,97,97,97,98,98,98,97,97,97,97,97,97,97,97,98,98,98,96,96,96,96,95,95,95,95,95,95,95,98,98,98,96,95,95,95,95,95,95,95,98,99,98,97,96,96,96,96,96,96,96,96,96,96,96,96,96,94,92,92,92,98,98,97,97,97,97,97,97,97,98,98,96,96,96,96,96,96,96,91,90,90,90,99,98,98,98,97,97,97,97,97,97,92,92,92,98,98,98,98,97,96,96,96,96,96,94,93,93,93,93,98,98,98,98,98,96,96,96,96,96,96,96,93,93,94,94,94,98,98,98,98,97,97,96,96,95,96,95,95,95,95,95,95,95,95,99,98,99,98,98,98,98,97,97,96,95,95,95,94,94,95,94,94,94,94,94,93,91,91,91,97,97,97,96,95,95,94,92,92,92,92,90,90,90,90,90,92,92,94,96,98,98,97,97,97,97,96,96,97,96,96,96,95,95,95,96,97,97,97,97,97,97,97,97,97,98,98,97,96,96,96,96,95,95,96,95,95,95,97,96,96,96,95,94,93,92,92,91,91,91,88,86,83,83,83,89,94,99,99,99,99,99,98,99,99,98,98,98,98,97,96,96,97,98,98,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,94,95,96,98,98,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,95,95,95,95,94,95,96,98,98,98,98,98,98,97,96,96,96,95,95,95,96,98,98,98,98,98,98,98,98,98,98,98,97,96,95,95,94,95,95,95,94,94,94,94,93,93,95,97,98,98,98,98,98,97,97,96,95,94,94,93,94,94,94,93,93,93,93,93,93,93,93,93,93,93,93,91,92,92,96,98,98,97,97,96,95,94,94,93,93,95,98,98,98,98,98,97,96,96,95,95,95,95,95,95,94,95,97,98,98,98,98,98,97,96,96,96,96,97,97,97,97,96,96,96,96,96,96,96,96,95,94,93,96,98,98,97,98,98,98,97,96,95,94,94,94,91,92,90,89,90,98,98,98,98,98,98,98,97,96,95,94,93,92,91,90,90,89,89,89,91,98,98,98,98,97,96,96,95,93,92,92,92,93,93,92,92,92,92,96,98,98,98,97,96,96,96,96,96,96,95,94,93,96,99,99,98,98,98,98,97,96,96,96,95,96,98,98,96,96,95,95,95,94,93,92,92,97,97,97,97,98,98,97,97,97,96,96,97,98,98,97,96,96,95,95,94,94,93,93,93,93,93,93,93,93,93,94,97,98,97,97,97,97,96,96,96,95,95,95,95,96,97,97,96,96,96,95,95,95,95,94,94,93,93,96,98,98,98,97,96,96,96,94,93,92,90,89,89,88,88,90,95,98,98,98,98,97,96,95,95,94,93,91,91,91,92,90,90,91,99,99,98,98,98,97,97,96,96,96,96,96,96,96,96,96,96,95,94,94,94,92,92,92,92,95,95,98,98,98,97,97,96,95,95,94,93,92,92,92,92,92,88,87,89,98,98,98,98,98,98,98,97,96,96,95,94,93,93,92,96,98,98,98,98,97,96,96,96,95,95,94,93,96,98,98,98,98,98,97,97,96,96,96,95,97,98,98,98,98,97,96,96,95,95,94,94,96,98,98,98,98,98,98,98,98,97,96,98,98,98,98,98,97,98,98,97,96,97,98,98,98,97,97,97,97,97,96,96,98,98,98,98,98,98,98,97,97,97,97,96,96,96,96,96,95,95,95,94,93,92,91,98,98,98,97,98,97,96,96,96,96,95,95,95,94,93,95,99,98,98,98,97,96,96,95,94,94,93,92,98,98,98,98,98,98,97,97,96,96,95,95,95,94,96,98,98,98,98,97,97,96,96,96,95,94,98,98,98,98,97,97,97,97,97,97,96,96,96,95,94,98,98,98,98,98,98,97,96,96,95,95,94,93,94,98,98,98,98,97,96,96,96,95,94,92,94,99,98,98,98,97,96,96,95,94,93,92,91,92,97,98,98,97,96,96,95,93,92,92,91,96,98,98,97,96,96,95,95,93,93,92,91,95,98,98,97,96,96,96,95,95,95,94,93,91,96,98,98,98,97,96,96,95,94,93,92,92,90,94,98,98,98,97,96,96,95,94,93,93,92,91,99,98,98,97,96,96,95,94,93,93,92,92,92,93,98,98,97,96,96,95,94,92,92,92,91,90,98,98,96,96,95,95,94,94,92,92,91,92,98,98,98,97,96,95,94,93,93,93,92,96,99,98,98,97,96,96,95,95,94,94,93,92,97,99,98,98,97,96,96,96,95,94,93,92,94,98,98,96,96,95,95,94,93,92,91,90,89,89,98,98,98,97,96,96,95,95,94,93,95,98,98,97,96,96,95,94,93,93,92,92,95,98,98,97,96,96,96,95,94,93,92,90,92,98,99,98,98,96,96,95,95,94,93,92,91,90,89,88,95,99,98,98,96,96,96,95,93,92,92,96,98,98,97,96,95,94,94,93,92,91,91,93,98,98,97,96,96,95,95,95,95,94,93,92,96,98,98,97,96,96,95,94,93,93,91,90,88,88,96,98,98,97,96,95,95,94,94,92,92,97,98,97,96,96,95,95,95,95,95,95,95,95,95,99,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,97,97,98,98,96,96,96,96,96,96,96,96,96,90,92,97,98,98,98,97,96,96,96,96,96,96,96,97,96,96,96,95,95,95,95,95,94,96,97,97,97,96,96,96,95,95,94,94,94,94,94,93,95,96,96,95,94,94,94,94,94,93,94,98,97,97,96,96,96,96,96,96,94,94,94,94,94,91,95,98,97,96,96,96,96,96,95,95,95,94,93,93,93,91,89,90,94,96,96,94,94,93,94,95,96,96,94,94,94,93,92,92,93,93,93,93,93,97,97,96,95,95,95,95,95,95,95,93,95,97,96,96,96,95,95,95,95,95,95,93,97,99,99,98,98,98,97,97,97,96,96,96,95,94,94,94,97,98,97,97,96,96,96,95,94,93,93,98,98,97,96,96,96,96,96,96,94,94,97,99,99,99,98,98,98,97,97,96,96,96,95,95,96,98,98,98,97,96,96,96,96,95,94,94,94,94,94,97,98,98,97,97,96,96,96,96,95,95,94,93,92,94,97,98,97,96,96,96,95,94,93,92,91,90,96,98,97,96,96,96,95,94,93,93,91,91,91,95,99,98,98,97,96,96,96,95,94,93,92,92,93,95,97,98,97,96,96,96,96,95,94,93,96,97,97,96,96,95,95,94,94,94,93,96,99,98,98,98,98,98,97,96,96,96,96,96,96,97,98,98,97,97,96,96,96,96,96,96,95,96,96,97,97,97,96,96,96,96,96,96,96,96,96,97,96,96,96,96,96,95,95,95,95,95,95,95,95,94,94,96,96,96,96,96,96,95,95,96,96,96,95,95,95,96,98,98,97,96,96,95,95,94,94,96,99,98,98,98,97,96,96,96,95,94,94,94,96,98,97,97,96,96,96,94,94,94,95,98,98,97,96,96,96,96,95,95,95,95,96,97,97,96,96,96,96,95,95,95,95,95,95,95,96,96,94,94,95,97,96,96,96,95,94,94,93,93,95,97,97,97,97,96,96,96,96,95,95,95,96,95,95,96,96,97,96,96,96,96,96,96,96,96,96,95,95,96,96,96,96,96,96,96,95,95,95,95,96,96,95,96,96,96,96,96,96,96,96,95,95,95,95,94,94,96,96,96,96,96,96,95,95,95,95,95,95,96,97,96,96,96,96,96,95,94,94,94,94,94,95,97,98,97,97,96,96,96,96,96,96,96,95,95,95,95,95,94,95,94,95,96,97,96,96,96,96,95,95,95,95,95,95,94,96,96,97,96,96,96,96,95,95,96,96,96,96,96,96,95,95,95,95,95,95,95,94,94,95,95,95,94,94,94,94,94,94,94,95,96,96,95,95,95,95,95,95,94,94,94,94,94,94,93,93,93,93,93,92,93,93,97,97,97,96,96,96,96,96,95,95,96,97,97,96,96,96,96,95,95,94,95,96,97,97,96,96,96,96,96,96,96,94,96,97,98,98,98,98,97,96,96,96,96,96,97,98,97,96,96,96,95,95,95,95,95,95,95,95,95,96,96,96,95,95,95,94,94,94,97,98,98,97,96,96,96,96,96,95,96,98,98,98,97,96,96,96,96,95,95,95,95,95,96,98,98,97,96,96,96,96,96,95,95,95,94,94,96,98,98,97,97,96,96,96,96,96,95,95,95,95,98,98,98,97,96,96,96,95,96,96,96,96,95,95,95,95,96,96,96,97,98,98,97,96,96,95,95,95,95,95,94,94,94,96,98,97,96,95,94,93,93,93,95,98,98,98,97,96,96,96,96,96,95,95,95,94,94,95,94,94,94,93,93,93,97,98,97,96,96,95,94,94,93,92,96,98,98,96,95,95,94,94,93,92,92,96,98,98,97,96,96,96,96,95,95,95,96,97,96,96,95,95,94,95,95,98,98,97,96,96,95,95,94,94,94,95,98,98,98,97,96,96,96,96,95,95,95,95,94,94,94,97,98,96,96,95,95,95,94,94,96,98,98,98,97,96,96,95,95,94,94,93,93,93,96,98,98,97,96,96,95,94,94,93,93,93,97,98,97,96,96,95,95,94,93,93,92,92,95,98,97,96,96,95,95,95,95,94,93,93,92,91,92,96,97,96,95,94,94,93,93,92,92,94,96,97,96,96,96,95,95,94,93,93,92,91,91,90,92,97,96,95,94,94,93,93,93,93,93,92,94,98,98,98,98,98,98,98,97,97,97,97,97,97,96,96,96,96,95,96,96,97,97,96,96,96,96,95,95,95,95,96,94,96,96,97,97,97,96,96,95,95,95,96,96,97,97,97,96,96,96,96,96,96,95,95,96,96,96,96,96,96,96,95,95,95,95,94,94,95,96,96,96,96,96,96,95,95,95,94,94,94,93,93,95,96,96,96,96,96,96,96,96,96,96,96,95,94,94,94,93,93,95,96,96,96,95,95,94,93,93,93,94,95,95,95,96,96,96,95,94,93,92,92,92,93,93,93,93,93,95,96,98,97,97,97,96,96,96,96,96,96,96,96,96,96,96,95,95,95,96,95,95,95,95,95,95,95,96,96,96,95,95,95,95,95,95,95,94,94,95,95,95,95,95,96,96,96,96,96,96,96,96,95,95,95,95,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,96,96,96,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,96,95,95,95,95,95,95,95,95,95,94,94,93,93,92,91,91,92,93,94,95,95,95,95,94,94,94,94,95,95,95,95,95,95,95,96,96,95,95,95,95,95,96,97,97,97,96,96,96,96,95,95,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,96,96,96,96,96,96,95,95,95,95,95,96,96,95,96,96,96,96,96,95,95,95,95,95,95,95,95,95,95,94,95,95,95,95,95,95,95,95,94,94,96,96,97,96,96,96,96,96,95,95,95,95,95,95,95,96,96,96,96,96,97,98,98,98,98,98,98,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,98,97,97,96,96,96,97,96,96,97,97,98,97,97,96,96,95,94,94,93,92,92,91,91,96,98,98,97,97,97,97,96,96,96,96,96,96,96,97,98,99,98,99,99,99,98,98,98,98,97,97,97,98,98,97,97,96,96,96,96,96,96,96,96,95,95,95,95,95,95,95,95,94,94,94,96,97,97,97,96,96,96,96,95,95,95,95,95,94,94,95,97,98,97,97,96,96,96,96,95,95,95,95,95,95,95,97,98,98,97,96,96,96,96,96,96,95,95,96,96,96,95,95,95,95,95,95,96,98,97,97,96,96,96,96,95,95,95,95,95,95,94,96,98,98,97,96,96,96,96,96,96,96,96,95,95,95,95,95,95,95,95,95,95,94,95,95,95,95,95,95,95,95,95,94,94,94,93,94,94,94,94,94,94,94,94,94,94,94,94,93,94,94,94,94,94,94,95,96,95,95,95,96,96,96,96,95,95,96,96,96,96,96,96,96,96,96,95,95,95,95,96,95,96,97,97,97,97,96,96,96,96,96,96,96,96,94,95,96,98,98,97,98,98,98,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,96,96,95,96,95,95,95,95,95,94,94,94,94,93,93,95,98,98,98,97,96,96,96,96,96,95,95,95,95,95,96,98,98,97,97,97,97,96,96,96,96,96,96,96,95,95,95,95,95,95,95,95,94,94,96,97,97,96,96,96,96,96,95,95,95,95,95,95,94,94,94,94,95,96,96,95,95,94,94,93,93,92,92,92,95,96,96,96,96,95,95,94,94,93,92,92,96,97,96,96,96,96,96,95,95,95,94,94,92,90,91,95,97,96,96,96,96,95,95,94,94,93,92,91,92,95,97,97,96,96,96,96,96,96,95,95,95,94,94,94,93,93,96,97,96,96,96,95,95,94,94,93,92,92,96,97,96,96,95,95,94,94,93,92,95,98,97,96,96,96,95,94,93,93,92,89,89,96,98,97,96,96,96,96,95,95,94,93,92,92,94,98,98,96,96,96,96,95,95,94,94,95,97,96,96,95,95,94,93,92,91,90,89,90,99,98,97,96,96,95,94,94,93,92,91,90,96,98,98,96,96,96,95,94,93,93,92,91,89,87,94,99,98,96,96,96,95,95,94,92,92,90,89,94,99,98,97,96,96,96,96,95,95,95,93,92,96,97,96,96,95,95,94,94,93,93,90,90,96,98,97,96,96,96,95,94,93,93,92,91,90,91,99,98,96,95,95,94,94,93,94,98,98,97,96,96,96,95,95,94,92,90,90,95,98,98,97,97,96,96,95,95,94,96,97,96,95,94,94,93,92,90,94,98,98,97,97,96,96,95,94,94,94,94,91,89,94,98,98,98,97,97,96,96,96,95,94,93,93,92,91,98,97,96,96,96,95,95,93,92,92,92,92,92,92,98,98,98,97,96,95,95,94,95,94,94,96,97,96,96,96,96,96,96,95,95,94,93,92,92,95,97,96,96,96,95,95,95,95,94,95,97,97,96,96,96,95,95,95,94,94,93,93,93,93,93,93,95,98,98,97,96,96,95,95,95,96,96,96,96,95,95,95,95,95,94,94,94,94,94,94,94,94,95,95,95,95,95,94,94,94,94,93,93,93,92,92,92,92,92,95,96,96,95,95,94,94,94,94,93,93,93,95,96,96,96,95,95,94,93,93,92,92,92,92,96,96,96,96,95,95,95,94,94,93,92,91,89,89,93,96,96,96,96,95,95,94,93,93,93,93,93,89,94,96,96,95,95,95,94,94,93,93,91,91,90,89,94,96,96,96,95,95,94,94,93,92,92,91,89,88,94,96,96,96,95,95,94,94,94,94,94,94,94,96,96,96,96,96,95,95,94,93,93,93,90,92,95,96,96,96,96,96,96,95,95,95,95,95,94,94,93,93,93,94,96,96,96,96,95,95,94,94,93,92,92,91,93,94,94,93,92,91,91,89,91,94,96,95,95,94,94,93,93,91,91,97,96,96,96,96,96,96,95,95,95,94,93,94,94,96,96,96,96,96,95,95,94,93,93,93,92,90,93,96,96,96,95,95,94,94,94,94,94,94,94,97,97,96,96,96,95,95,94,94,93,93,95,96,96,96,95,95,94,94,94,94,93,96,96,96,96,96,96,95,95,95,94,94,94,94,91,97,97,96,96,95,95,94,94,94,94,94,95,96,97,97,96,96,96,95,94,94,94,93,93,95,96,96,96,95,94,94,94,93,93,91,91,95,96,96,96,95,95,94,93,92,92,91,89,89,94,97,96,96,95,95,94,94,93,93,93,93,98,98,98,97,97,96,96,95,95,95,94,93,92,95,97,96,96,96,96,96,95,95,94,93,92,94,96,96,96,96,96,95,95,94,94,94,94,94,94,91,90,96,98,98,98,98,97,97,96,97,97,97,97,96,96,96,96,96,96,96,95,95,94,94,94,95,96,97,96,96,96,96,96,95,95,95,95,95,95,96,97,96,96,96,96,96,95,95,95,95,94,94,93,93,93,94,96,96,97,96,96,96,96,95,95,94,94,94,94,94,94,94,96,97,97,96,96,96,95,95,94,93,95,95,98,97,97,96,96,96,96,96,95,94,93,93,92,93,96,98,98,97,96,96,96,95,94,94,94,94,94,94,94,98,97,97,96,96,95,95,95,96,96,95,95,94,94,93,94,97,97,96,96,96,96,96,96,95,95,95,95,95,95,95,95,95,95,95,95,95,94,94,95,95,95,95,95,94,94,95,95,95,94,94,94,94,94,93,94,94,95,94,94,94,93,93,94,94,94,94,93,92,95,95,95,94,93,93,93,93,93,94,97,96,95,95,95,93,92,94,95,96,95,94,93,93,93,93,93,93,97,97,96,96,96,95,95,95,94,92,95,97,96,96,95,95,95,95,94,94,98,97,96,95,95,94,94,94,94,94,96,96,97,96,96,95,94,94,93,91,91,91,96,96,97,96,96,96,96,96,95,95,94,94,94,94,94,94,97,97,97,97,96,96,96,95,95,95,95,95,98,97,96,96,96,95,95,94,94,94,94,94,96,96,96,95,95,94,94,94,94,94,94,96,97,97,96,96,95,95,95,95,95,95,97,97,97,96,96,96,95,95,95,95,95,97,98,97,97,96,96,96,96,96,96,95,95,95,95,95,95,95,95,97,97,97,97,96,96,96,96,96,95,95,94,93,94,93,94,94,94,94,94,98,97,96,96,96,96,96,96,96,96,95,95,94,94,94,94,94,96,96,96,96,96,95,94,94,93,93,93,93,93,96,97,97,96,96,96,95,95,95,95,95,95,98,98,97,96,96,95,95,95,95,95,98,97,97,96,96,96,96,95,95,94,94,94,96,97,97,96,96,96,95,95,95,95,95,95,95,97,98,97,97,97,96,96,96,96,96,96,95,95,95,95,94,94,94,94,94,94,96,98,97,97,96,96,96,96,96,96,96,96,96,96,95,95,95,94,94,94,93,94,95,95,94,93,93,94,94,94,94,94,94,94,98,98,98,98,98,98,98,97,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,95,95,95,95,95,95,96,96,96,96,95,95,95,95,95,96,96,95,95,94,94,95,95,95,95,94,94,94,94,95,97,96,96,96,96,96,95,95,95,95,95,96,96,96,95,95,94,94,93,93,93,93,93,93,92,92,92,92,92,95,98,97,97,96,96,96,95,96,96,96,96,96,96,95,95,95,94,94,94,94,94,94,94,94,94,94,94,94,95,95,95,94,94,95,96,96,96,96,96,96,96,95,94,93,93,93,93,93,93,93,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,95,95,94,94,94,93,93,94,94,95,94,94,93,92,92,91,90,90,90,88,87,87,92,96,96,96,96,96,95,95,95,94,93,93,92,92,91,90,93,95,96,96,96,95,95,95,94,94,93,94,95,96,96,96,95,95,95,94,94,93,93,94,95,95,95,95,96,95,95,95,95,95,95,98,98,98,98,97,97,97,96,96,96,96,97,97,98,98,98,98,98,98,98,97,97,96,96,96,96,95,95,95,94,94,94,95,94,94,94,94,94,93,94,94,94,94,94,94,94,94,94,94,94,94,93,93,93,94,95,95,94,94,94,94,94,94,94,94,93,93,93,96,95,95,95,95,95,95,94,94,94,94,93,93,94,94,94,94,94,94,94,94,94,94,94,93,93,93,94,95,96,96,95,95,95,95,95,95,95,95,95,94,94,94,94,94,94,94,95,94,94,94,94,94,94,94,94,94,94,94,94,94,95,95,95,94,94,94,94,94,94,94,94,94,94,94,95,95,95,94,94,94,94,94,93,93,94,94,94,95,95,95,95,94,94,94,95,95,95,95,95,94,94,94,94,94,94,93,93,93,93,93,93,93,94,95,96,95,95,96,96,96,95,95,95,95,94,94,94,94,94,94,95,96,96,96,95,95,95,95,94,94,94,95,95,95,96,96,95,95,94,94,94,94,94,94,94,95,96,96,95,95,95,95,95,94,94,94,94,94,94,94,94,94,94,94,98,98,98,98,98,98,98,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,96,96,96,96,96,95,94,95,95,95,95,94,94,94,93,95,96,96,96,96,96,95,95,95,95,95,94,94,94,93,93,94,96,96,96,96,96,96,96,96,95,95,95,95,95,95,96,96,96,95,95,95,95,95,95,95,94,94,95,96,96,96,95,95,95,95,95,95,95,95,94,94,94,94,94,96,96,96,96,96,96,95,95,95,95,93,94,95,96,96,96,96,96,95,95,94,93,94,94,93,94,96,96,96,96,96,96,96,95,95,94,94,94,94,94,94,94,96,96,96,96,96,96,96,95,95,95,94,93,94,95,95,94,95,97,96,96,96,95,95,94,94,94,95,96,96,95,95,94,94,94,94,94,94,96,99,98,96,96,96,96,95,96,96,97,96,96,96,96,96,96,96,98,98,97,97,96,96,96,96,96,96,96,95,98,98,97,97,96,96,96,96,96,95,95,95,95,95,98,98,98,97,97,96,96,96,96,96,96,96,96,96,96,99,98,98,97,97,96,96,96,96,96,96,96,96,98,98,98,97,96,96,96,96,96,96,96,96,96,97,98,98,97,97,96,96,96,96,95,95,95,95,95,96,98,98,97,97,97,96,96,95,95,95,95,95,95,95,98,98,98,98,98,97,97,96,96,96,96,96,97,97,97,96,96,96,96,96,95,95,95,96,97,97,97,96,96,96,96,96,95,95,95,95,95,97,97,97,97,97,96,96,96,96,96,96,96,96,96,95,95,95,94,95,95,95,95,98,98,97,97,97,96,96,96,96,96,96,96,96,95,96,96,97,96,96,96,96,95,95,95,95,95,97,98,98,98,97,96,96,96,96,95,94,94,94,98,97,97,96,96,96,96,96,96,96,97,97,97,96,96,96,94,96,96,98,97,96,96,96,96,98,98,98,97,97,96,96,95,96,96,96,96,96,96,98,98,98,97,96,96,96,96,96,96,96,96,96,96,96,98,98,98,98,97,96,96,96,96,96,96,96,97,98,98,97,96,96,96,96,96,96,96,93,96,98,98,98,98,98,97,96,96,96,97,97,97,96,96,95,95,95,95,96,96,96,96,96,96,96,96,95,96,95,95,95,95,96,96,96,95,96,96,96,96,96,95,95,95,95,95,95,95,95,95,96,96,95,95,95,95,95,95,94,94,94,94,94,95,95,95,95,95,94,94,94,94,94,94,94,94,94,94,95,94,94,93,93,93,93,94,94,96,97,97,97,97,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,96,96,95,94,93,93,92,92,91,91,90,90,89,89,96,98,98,98,97,97,96,96,96,95,95,94,93,93,92,92,92,92,92,94,97,98,98,98,98,98,98,97,97,96,96,96,96,96,95,95,95,95,95,98,98,98,98,98,98,98,97,96,96,96,96,96,97,98,98,97,96,96,96,96,96,96,96,95,94,94,96,98,98,98,98,98,97,96,96,95,95,95,95,95,95,98,98,98,98,98,97,97,97,96,96,96,96,96,95,95,95,95,95,95,94,94,94,94,94,94,94,94,94,95,95,95,96,95,95,95,96,96,96,96,96,97,97,98,98,97,96,96,96,96,96,96,96,96,96,98,98,98,98,98,98,97,96,96,95,95,95,95,95,98,98,98,97,96,96,96,96,95,95,95,95,95,95,95,95,95,95,96,98,98,97,96,96,96,96,95,95,95,95,95,95,95,95,95,98,98,98,98,97,97,96,96,96,95,95,95,95,95,95,96,98,98,98,97,97,97,97,97,97,97,96,96,96,96,96,96,94,94,94,94,96,98,98,97,96,96,96,96,96,95,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,93,93,93,94,96,98,98,98,97,96,96,96,96,96,95,95,96,96,96,96,95,95,95,96,98,97,97,97,97,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,94,94,93,95,96,97,97,97,96,96,96,96,96,96,96,95,95,95,95,94,94,96,98,98,98,98,98,97,97,96,96,96,96,97,97,96,96,96,96,95,95,94,94,94,94,94,94,98,98,97,97,96,97,96,96,96,96,96,96,95,95,95,95,95,95,95,98,97,96,96,96,96,95,95,95,95,95,95,95,95,95,98,98,97,96,96,96,96,96,96,96,96,95,95,95,95,94,93,94,94,95,94,94,94,94,94,94,94,95,97,98,98,98,97,96,96,95,95,96,95,95,95,95,95,94,94,96,98,98,97,97,96,96,96,96,96,96,96,95,95,95,95,95,95,95,93,96,97,98,97,97,97,97,96,96,96,96,96,96,96,95,95,95,95,94,94,95,96,97,97,97,96,96,96,96,96,96,96,96,96,95,95,95,97,97,96,96,96,96,96,96,96,96,96,96,96,97,96,97,96,96,96,96,96,96,96,91,95,98,98,97,97,97,96,96,96,95,95,95,95,95,94,94,95,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,99,99,98,98,98,98,98,97,97,97,98,98,98,97,96,96,96,96,96,97,97,97,97,96,96,96,96,96,96,96,95,95,95,95,93,93,94,95,97,98,97,97,97,97,96,96,96,96,97,97,97,97,96,96,96,96,95,95,96,97,97,97,96,96,96,96,96,95,94,94,94,98,98,97,97,96,96,96,96,96,96,93,93,98,99,98,98,98,98,98,98,98,98,97,97,97,96,96,96,96,96,97,97,96,96,96,96,96,95,95,95,96,95,95,95,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,98,97,97,97,96,96,96,96,96,96,96,96,96,96,95,95,95,95,94,94,98,98,98,98,97,97,96,96,96,96,96,96,95,95,94,95,95,98,98,98,98,98,97,97,96,96,96,96,96,96,96,95,95,97,98,97,96,96,96,95,95,95,94,94,93,93,96,98,98,97,97,96,96,96,96,96,96,96,93,98,99,99,98,98,98,98,98,97,98,98,98,97,97,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,96,96,96,96,96,96,96,96,96,95,95,96,95,95,95,95,96,95,95,95,95,95,95,95,95,94,94,94,94,93,93,93,92,91,91,92,96,98,98,97,97,96,96,96,96,96,96,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,null,null],"hr":[94,94,91,81,80,80,80,80,80,80,80,75,76,76,77,78,79,82,82,84,82,80,77,76,76,72,72,73,73,73,72,72,73,73,73,72,72,72,72,72,72,72,70,69,70,72,73,72,73,74,75,74,73,73,74,74,77,77,77,77,71,72,73,73,71,70,70,71,71,71,71,73,74,73,73,72,72,72,72,72,72,72,72,72,72,72,73,74,74,75,75,75,75,76,75,74,75,75,76,76,76,77,77,77,75,75,75,75,75,75,75,78,79,76,76,76,76,76,76,76,75,74,73,74,77,77,77,77,77,77,77,78,78,78,78,78,77,74,77,77,77,78,78,77,76,76,77,76,76,76,75,74,74,73,73,73,74,75,78,81,81,83,77,74,74,74,74,74,74,73,73,73,73,75,74,74,74,74,74,75,74,74,67,73,76,76,75,75,75,76,76,74,74,76,75,75,75,76,75,74,75,76,75,75,76,77,77,76,76,75,73,73,73,73,79,83,80,79,81,81,80,76,75,74,74,74,78,80,79,79,80,80,80,80,80,80,80,77,75,74,71,69,69,71,72,70,69,69,71,75,74,71,70,69,68,68,68,69,69,70,69,68,69,70,70,70,67,68,67,67,67,67,68,68,68,68,68,69,67,67,72,69,69,69,68,67,68,69,70,73,79,77,77,78,78,75,72,72,72,70,70,69,69,70,70,69,67,68,68,68,67,68,68,68,66,66,67,67,67,68,68,69,68,68,69,69,68,67,68,67,67,66,66,67,68,68,68,69,72,75,76,73,70,69,69,70,69,68,68,68,68,67,68,68,69,69,70,70,70,70,70,70,69,68,68,67,65,67,68,68,68,67,67,68,68,67,66,67,67,65,66,67,68,68,69,68,69,69,69,68,69,69,67,67,69,70,70,72,72,71,69,68,67,67,67,68,68,68,67,67,67,68,67,68,67,67,66,70,71,73,71,73,73,72,71,71,71,69,68,69,68,69,69,69,67,68,70,70,69,68,68,67,67,68,68,68,69,70,70,69,70,71,70,70,70,70,70,69,68,68,69,69,68,68,70,69,68,67,68,67,65,65,68,70,70,70,71,71,71,69,67,68,67,69,69,69,69,69,68,68,68,69,71,70,70,70,70,70,70,70,70,70,79,79,79,79,89,87,82,76,73,71,69,68,68,68,67,66,67,68,66,63,65,66,67,64,63,64,65,64,63,64,66,66,67,66,64,63,66,69,69,68,65,65,69,71,66,63,63,66,68,67,65,63,66,68,66,63,59,61,62,61,65,69,71,70,67,62,61,63,61,58,59,60,61,63,67,72,71,66,62,61,64,67,68,69,70,71,72,73,73,73,72,71,70,71,71,71,71,71,70,70,71,72,70,68,67,67,67,68,69,69,70,70,69,68,68,70,72,72,71,67,64,63,64,65,63,63,66,66,62,61,62,62,62,64,64,63,64,65,63,63,63,62,62,71,78,82,80,81,79,76,74,71,67,67,69,71,69,68,66,64,62,65,66,67,63,59,61,63,61,59,59,63,66,65,62,60,58,60,61,61,60,59,58,61,61,61,58,60,61,62,65,66,63,62,65,66,62,60,63,64,60,62,69,70,67,62,63,66,66,66,66,72,90,90,85,78,74,66,62,60,60,62,65,69,69,64,60,58,60,62,66,64,60,60,61,61,61,61,62,59,59,60,61,63,64,62,61,61,64,67,66,61,59,62,65,65,62,58,60,62,61,60,60,65,67,65,61,61,62,61,59,59,63,66,65,60,59,61,64,67,66,64,62,62,61,59,58,60,65,68,65,63,61,65,65,65,65,83,81,76,67,58,56,60,65,67,64,59,58,61,62,61,58,60,62,62,59,58,60,60,60,60,61,58,60,62,62,64,67,66,62,58,60,62,61,62,64,62,59,60,61,62,61,60,60,59,61,61,60,63,71,76,77,84,83,78,74,69,61,60,66,67,59,57,60,62,66,67,74,72,65,59,61,62,61,63,64,62,57,57,60,61,61,60,59,60,64,63,58,58,64,66,64,61,66,77,85,83,76,73,66,62,59,60,59,62,62,58,55,58,60,60,58,59,59,60,61,62,70,78,75,63,61,62,63,61,62,68,78,81,77,72,69,64,59,59,59,61,59,58,60,61,62,71,76,73,62,60,62,61,59,58,58,59,61,63,78,85,82,78,71,64,61,60,60,60,63,67,69,70,76,78,71,64,63,63,61,62,61,60,62,62,59,57,60,62,62,63,68,79,79,71,63,62,63,63,64,66,67,65,66,68,78,77,71,63,66,66,65,66,65,64,68,75,83,79,70,61,58,59,60,60,61,61,61,62,67,80,81,77,70,62,64,63,62,60,62,62,68,86,80,69,65,64,63,62,60,60,64,70,80,81,82,79,74,67,61,61,62,62,61,64,66,67,66,71,88,86,81,77,66,59,60,65,63,60,60,64,66,65,66,66,65,64,67,68,68,75,77,74,64,66,65,62,62,66,75,83,78,75,78,75,66,59,60,61,64,65,63,63,65,66,65,69,78,81,77,71,68,63,62,64,66,65,61,60,72,79,71,63,61,63,62,70,77,79,82,78,71,62,62,63,64,65,65,65,65,80,88,87,81,77,77,82,83,81,79,82,79,78,79,77,74,73,73,69,66,69,68,64,63,67,65,60,62,66,66,63,61,62,65,65,62,61,65,66,64,62,62,65,68,67,65,62,62,63,62,63,63,60,59,60,61,64,63,62,53,61,62,62,65,65,66,66,72,72,72,72,72,60,59,61,62,62,62,63,63,63,63,63,72,65,65,59,59,59,59,61,63,66,69,72,74,76,76,70,60,60,60,60,59,59,59,59,59,56,53,52,59,54,56,59,65,65,65,65,62,62,62,63,65,65,65,65,77,77,71,59,60,62,62,62,59,59,59,59,58,59,58,59,63,63,63,63,69,78,75,75,75,75,75,72,72,60,58,59,61,62,62,63,65,68,75,72,63,61,61,63,62,61,62,62,62,62,62,62,62,62,67,74,74,74,74,71,62,60,60,62,63,63,64,65,65,65,73,79,79,67,59,61,63,63,65,68,77,74,74,74,68,65,60,59,60,66,69,75,81,75,69,63,63,63,63,64,64,58,70,70,78,72,66,61,61,61,65,64,64,67,70,73,66,63,64,63,60,63,65,65,65,65,65,71,71,71,71,62,61,62,63,63,56,57,60,65,64,62,60,63,69,69,69,69,69,69,65,63,63,63,63,64,64,64,64,64,70,73,71,68,59,60,64,62,64,64,64,67,67,65,58,55,55,61,58,58,61,63,72,75,75,75,75,71,63,63,65,67,70,70,70,70,70,70,70,62,63,63,60,63,65,66,58,58,58,58,58,58,58,63,65,66,65,61,61,61,61,61,61,61,61,67,65,66,68,70,70,70,70,70,70,70,65,58,58,58,58,61,64,64,64,66,63,64,64,64,64,64,64,64,61,58,63,66,66,63,63,63,63,72,72,72,69,63,63,63,69,71,71,71,71,71,71,80,78,70,65,65,63,64,67,68,70,70,70,70,73,76,76,76,76,73,67,61,54,54,64,64,64,64,64,64,64,65,65,65,65,65,63,64,67,68,67,64,62,65,67,67,66,66,66,66,66,66,72,72,65,63,65,65,63,63,66,69,67,62,63,64,63,63,64,66,65,66,66,60,60,63,66,69,66,63,63,62,63,64,65,66,65,66,66,66,69,69,69,69,69,69,69,66,64,68,65,61,61,61,61,64,64,66,69,74,80,81,74,70,69,69,68,68,69,69,69,69,69,66,67,66,65,65,67,71,70,70,70,71,65,64,62,59,56,65,63,64,65,67,66,63,61,58,58,61,79,84,85,85,81,81,82,83,83,83,83,98,96,88,77,69,68,69,71,73,75,77,80,78,72,65,66,71,72,70,68,67,67,70,70,67,64,67,72,73,76,80,84,82,77,69,67,67,64,65,67,71,68,64,63,65,65,66,71,72,70,70,76,81,88,85,81,71,65,66,67,67,66,65,66,69,67,64,62,63,66,66,64,63,66,68,69,69,70,73,77,81,83,80,77,75,75,74,72,64,61,63,65,67,70,75,78,80,78,76,72,73,77,79,78,76,76,76,73,68,65,69,73,73,74,75,75,75,75,74,75,79,83,85,84,82,84,85,82,73,68,68,71,72,71,70,71,71,71,72,74,75,77,78,79,80,80,78,76,78,81,82,85,86,86,92,94,89,79,73,70,70,70,71,76,81,81,78,76,77,76,68,62,61,63,65,65,65,67,67,67,67,67,76,92,85,76,70,64,62,60,63,71,77,83,80,75,67,62,59,61,62,63,62,63,64,66,70,70,74,75,77,76,76,76,71,62,63,65,67,70,72,71,72,72,72,75,75,74,77,75,71,68,66,62,60,60,61,62,62,62,63,65,67,72,76,82,80,73,72,71,70,71,71,69,69,71,72,71,70,72,74,77,82,84,84,82,80,78,75,73,69,68,69,71,76,76,78,78,79,77,76,75,76,73,69,69,72,77,79,81,83,80,75,71,70,67,63,64,66,74,74,83,78,75,72,71,71,71,73,76,79,83,86,82,76,70,68,66,63,65,66,67,68,69,69,69,70,71,74,77,78,78,82,84,81,77,77,75,72,73,73,74,74,75,76,78,78,75,74,71,67,66,65,64,66,67,72,76,78,77,76,76,74,75,74,72,73,74,69,67,71,73,74,75,80,88,88,83,82,73,71,70,68,67,67,69,69,65,64,67,70,70,72,75,78,85,86,79,72,75,77,78,78,78,79,76,76,76,76,76,76,76,76,76,76,75,76,76,73,71,71,71,71,71,65,72,74,71,73,71,67,69,68,66,65,66,66,66,66,66,78,90,86,77,73,69,68,71,68,72,68,69,72,80,87,86,80,70,64,63,66,67,67,68,70,74,81,83,83,78,70,70,69,66,69,67,64,71,77,83,86,83,75,68,71,72,71,70,71,70,77,81,77,69,68,69,64,62,64,64,72,78,82,79,72,67,64,62,62,65,64,63,74,78,76,73,67,67,68,69,66,68,68,68,68,86,89,81,73,71,73,74,72,68,66,68,67,66,66,66,66,64,64,65,74,78,89,85,77,65,64,64,63,64,67,71,71,71,72,71,77,81,87,80,71,65,65,67,67,67,66,70,76,83,85,81,73,68,67,69,69,64,65,64,63,68,67,72,80,85,82,75,72,71,71,65,67,71,72,71,79,81,70,65,66,66,71,69,63,63,66,66,69,76,81,84,83,78,69,63,66,64,64,64,66,68,69,75,82,85,79,75,70,65,63,65,66,66,67,75,80,85,81,72,69,69,64,63,65,66,65,68,66,66,78,80,74,72,74,70,65,66,71,71,75,86,85,79,71,65,65,66,65,65,67,69,70,81,86,84,76,71,72,68,64,66,66,64,70,80,86,86,79,75,72,74,71,70,71,73,73,71,74,81,87,82,74,68,70,69,66,67,69,72,75,80,86,87,79,70,63,65,68,68,67,68,68,76,81,88,90,82,75,71,71,68,71,73,72,76,80,89,90,86,77,70,68,67,65,68,69,72,78,78,86,74,69,71,72,71,70,67,65,71,83,90,92,87,77,73,74,73,70,69,72,76,81,86,92,92,83,71,66,69,72,72,73,72,73,75,81,87,85,78,75,78,74,71,71,74,75,75,79,90,92,93,88,79,69,69,71,68,67,73,77,83,77,71,64,67,72,68,67,69,70,76,84,91,89,83,79,75,75,75,72,74,76,75,79,86,90,84,75,71,71,71,70,71,73,71,73,73,76,83,92,95,91,81,75,72,70,70,70,72,74,80,88,88,82,71,68,68,69,71,70,71,75,83,90,87,83,79,73,70,69,68,70,70,71,68,68,71,86,81,76,71,69,68,66,68,69,71,68,71,84,89,82,77,75,73,73,74,71,70,78,86,87,88,78,74,76,78,77,76,75,73,73,73,73,73,73,73,73,70,64,62,71,73,72,72,72,72,72,72,66,67,67,70,70,70,70,70,70,70,64,59,65,63,63,63,63,63,63,63,63,66,78,90,79,74,75,75,74,78,84,87,79,68,67,65,64,64,66,65,65,65,65,65,65,65,67,71,73,73,73,73,70,69,68,69,69,79,82,76,71,70,70,63,71,71,71,71,71,74,77,71,67,65,66,66,66,68,70,73,77,77,77,77,77,71,72,70,65,60,63,66,67,66,68,71,73,75,76,76,76,73,67,64,64,65,68,70,71,70,67,67,69,69,70,72,76,74,70,67,68,68,68,68,70,71,70,67,66,67,70,72,72,72,72,75,74,75,73,70,67,68,68,68,68,68,68,86,88,78,67,64,64,65,66,70,75,75,75,79,83,79,72,67,68,69,69,69,68,68,73,79,85,82,76,69,69,69,67,68,71,71,71,71,77,95,88,76,68,66,67,65,65,66,68,72,77,80,77,73,66,66,66,66,67,68,69,69,68,71,71,80,86,83,77,68,66,66,66,69,72,74,72,69,71,77,84,89,82,74,69,68,67,66,67,68,68,73,79,84,75,69,67,67,67,69,70,70,70,70,72,72,78,85,83,76,71,70,68,69,72,74,76,77,82,85,85,86,92,90,80,71,69,69,68,69,69,77,78,73,74,76,76,74,74,77,83,84,84,84,99,97,95,93,88,79,73,71,71,70,72,77,84,88,86,81,75,71,72,74,74,74,74,79,79,78,76,75,71,70,71,70,70,73,74,79,79,79,74,75,78,78,75,73,75,77,76,74,74,74,74,73,72,76,77,75,70,71,72,73,74,79,79,78,74,72,71,71,76,75,74,73,75,75,76,76,79,82,85,85,80,71,65,66,69,70,71,72,71,72,80,82,77,72,70,72,74,74,74,75,77,84,84,77,71,69,70,70,68,69,72,74,83,88,87,82,72,69,69,68,68,68,70,71,71,74,77,76,71,73,76,82,75,73,71,71,69,68,68,70,81,87,88,84,77,71,69,70,71,72,71,71,70,71,71,71,80,91,89,83,75,69,68,67,67,68,70,72,76,78,84,80,75,71,68,68,69,69,68,68,72,73,75,75,79,80,77,74,71,71,72,74,74,74,71,71,73,78,78,76,73,73,70,69,71,72,73,75,78,82,85,81,76,70,72,75,73,73,73,73,73,75,78,81,88,88,83,76,70,70,70,69,67,69,72,74,73,73,74,75,76,76,74,74,83,81,76,74,73,73,73,73,73,77,82,84,85,85,85,97,103,99,88,78,73,75,79,82,84,80,73,69,69,70,72,72,72,75,76,75,76,76,70,68,70,71,69,68,70,74,81,84,85,81,76,71,70,70,70,70,72,74,76,79,78,75,73,75,77,76,75,74,78,80,88,86,80,72,70,71,71,71,71,75,81,85,82,79,73,73,74,71,71,77,83,88,88,88,82,75,71,70,70,72,76,82,82,82,91,97,93,85,74,69,70,72,73,77,83,86,83,76,71,71,71,70,73,74,73,74,72,72,75,78,73,69,71,73,76,74,77,81,87,88,86,77,71,69,72,72,70,77,82,86,86,82,74,67,70,72,70,68,69,74,77,84,87,89,85,75,70,72,70,68,70,75,77,77,80,84,86,84,80,74,68,68,69,71,75,77,76,79,82,84,87,86,79,72,69,69,70,71,72,74,77,78,79,78,78,77,79,85,85,94,98,94,82,73,70,71,72,70,70,71,74,75,79,82,81,75,74,73,73,73,74,80,86,90,90,84,74,67,69,70,68,67,68,70,71,71,72,74,76,76,76,76,80,84,87,83,76,73,75,77,78,78,80,86,89,87,80,73,73,75,75,74,75,78,84,90,89,82,72,68,74,74,77,74,75,78,81,80,75,76,77,76,77,77,85,89,85,80,78,78,80,80,77,77,83,88,93,92,89,81,74,69,71,72,73,73,73,77,80,83,85,89,86,78,75,74,74,72,76,82,87,87,88,81,74,73,73,73,76,78,80,80,80,83,88,86,82,79,78,77,72,69,72,76,81,85,88,87,83,77,73,73,74,78,78,76,78,83,89,94,89,77,69,68,69,69,69,71,72,72,74,79,85,91,89,81,72,70,72,71,73,77,82,86,87,88,83,77,75,76,75,76,76,75,74,78,79,82,82,80,71,69,73,74,74,73,75,76,77,77,77,86,99,100,100,101,100,93,86,80,76,75,78,76,73,72,73,74,78,80,81,81,79,74,73,76,78,79,79,77,76,81,81,84,87,103,102,100,89,77,74,74,77,78,83,85,89,88,88,86,85,80,77,73,72,74,79,83,84,87,87,81,75,74,77,79,79,77,78,81,83,86,86,80,74,71,72,72,73,74,76,76,78,83,86,86,85,82,75,71,70,73,78,78,76,74,74,72,74,74,74,76,78,77,74,75,72,70,73,73,73,77,80,80,80,82,81,76,70,68,70,73,73,74,75,77,75,76,83,89,89,89,102,103,100,94,83,80,81,82,83,82,82,81,78,71,69,67,67,69,69,68,66,66,67,68,70,72,75,78,76,74,74,78,79,77,74,74,76,78,77,78,81,83,84,84,83,81,79,77,79,80,80,78,77,74,74,76,78,79,78,78,79,80,81,81,81,80,82,83,83,82,84,84,83,80,81,81,80,79,80,81,81,81,78,78,82,81,81,80,80,81,85,86,82,80,82,81,81,82,82,79,77,77,78,78,79,79,78,77,77,77,77,79,81,82,83,84,84,83,85,87,87,85,84,84,84,85,83,83,83,85,85,85,84,84,85,84,85,85,86,86,85,84,82,82,83,83,82,80,78,77,77,75,75,76,78,78,78,80,79,78,77,79,80,79,77,76,77,78,78,77,77,78,78,77,78,78,80,81,80,80,79,80,80,80,81,80,79,77,79,80,80,80,80,80,80,81,82,82,81,82,84,85,84,83,84,86,87,86,86,87,88,89,86,81,77,74,72,72,73,73,75,75,72,68,72,80,80,89,89,86,84,85,85,82,81,77,73,71,72,74,74,73,72,72,74,77,78,79,77,73,69,67,68,71,73,75,78,80,79,75,73,72,72,73,72,72,75,77,74,74,77,74,76,82,80,75,72,74,75,76,75,74,71,69,84,78,71,71,74,78,77,70,66,68,71,71,77,77,77,77,89,106,103,98,93,92,92,86,79,75,75,74,76,74,72,70,72,71,70,71,72,72,72,72,71,71,70,66,64,66,66,65,67,68,78,85,83,80,75,76,75,74,72,72,76,77,78,78,80,82,85,84,81,79,79,81,80,78,75,74,74,73,72,74,74,73,71,72,71,69,68,70,72,73,71,69,70,73,75,74,73,74,72,70,71,77,81,82,80,78,75,75,76,76,77,77,75,72,71,75,76,76,76,76,88,95,88,80,79,79,77,77,76,74,72,71,71,72,73,74,75,75,75,76,77,76,75,78,80,80,79,77,76,76,78,75,74,73,75,73,75,77,77,77,76,75,75,76,76,77,78,79,79,80,82,83,84,82,84,87,90,92,91,87,82,82,86,90,88,86,83,82,83,86,86,85,81,78,76,77,79,81,81,84,85,85,84,82,80,79,82,82,82,82,81,81,81,81,81,90,88,81,75,75,79,81,80,77,74,76,77,78,79,78,78,78,78,80,80,81,80,79,79,80,79,78,78,78,75,73,75,77,78,78,77,77,77,77,80,101,104,93,78,74,79,76,74,74,76,75,78,81,82,83,80,76,73,74,72,72,76,78,76,75,78,79,77,76,77,76,76,79,78,74,72,78,83,80,74,74,75,74,74,76,77,76,76,77,76,74,75,76,76,77,80,79,75,71,71,72,73,74,74,76,78,80,78,77,74,69,68,70,72,73,73,75,78,81,81,79,77,74,73,73,73,71,72,75,75,75,77,78,78,75,79,77,77,78,77,74,74,76,77,76,77,78,85,90,94,93,87,76,73,73,74,77,78,76,73,74,74,73,73,77,81,80,74,70,71,72,72,72,73,76,76,76,78,80,75,68,68,71,76,75,73,77,84,82,77,74,73,72,71,72,73,73,72,73,73,76,85,80,76,75,75,74,72,71,72,73,74,76,80,83,83,76,73,73,73,73,74,78,80,80,79,78,75,73,73,74,73,73,74,75,78,80,82,78,73,71,72,72,72,71,72,73,75,78,80,83,77,71,71,73,73,71,72,74,75,77,79,81,82,80,72,68,67,71,73,71,69,72,76,77,76,77,85,84,78,74,74,75,74,70,70,72,74,76,78,76,71,70,72,72,72,74,74,73,73,74,74,79,76,76,77,76,72,72,72,73,67,67,76,83,86,79,74,73,74,73,71,70,73,73,75,67,68,70,72,72,71,73,76,78,81,84,89,83,74,71,73,74,72,70,71,73,74,74,72,72,72,75,76,78,82,86,80,75,74,74,72,72,73,74,74,74,77,78,78,81,84,88,83,75,69,71,71,71,72,74,75,75,77,79,79,76,75,77,78,75,74,74,74,80,87,87,87,87,87,87,97,88,83,80,77,75,74,80,87,91,88,80,71,69,70,76,76,72,70,72,73,76,80,86,79,72,69,71,72,72,72,71,74,77,86,81,77,74,73,73,71,71,72,72,75,86,89,90,90,90,90,90,93,100,93,84,77,78,81,82,80,76,73,73,74,74,72,71,69,69,69,71,72,75,77,80,84,89,90,84,75,73,75,74,73,72,73,75,76,76,76,77,79,85,84,75,72,70,71,72,74,76,74,76,79,84,85,79,75,71,72,73,73,71,72,74,76,76,76,76,75,75,77,77,75,76,77,79,77,78,80,83,78,87,87,81,78,75,75,75,76,76,75,75,75,75,75,83,79,76,72,73,75,75,74,78,82,82,84,86,93,93,86,76,73,73,72,74,75,76,76,79,79,81,90,88,82,76,71,73,77,78,77,75,78,78,78,78,78,80,78,75,78,81,81,80,79,79,81,84,93,96,94,87,79,75,77,78,75,74,74,73,72,74,76,76,78,83,89,86,77,74,76,79,80,77,78,77,77,81,82,81,79,79,80,81,81,84,86,92,84,83,81,80,78,78,79,81,86,90,93,86,82,79,75,74,73,73,75,76,77,77,82,79,79,83,81,80,80,80,78,76,75,77,78,81,83,84,77,74,74,77,78,77,77,79,78,79,79,79,82,83,82,82,82,80,80,79,82,86,90,91,85,78,76,76,74,74,75,80,84,87,88,94,92,85,75,75,75,74,73,73,75,77,77,80,77,73,73,75,78,78,76,76,78,79,79,79,85,81,81,81,79,76,76,76,77,84,89,90,88,80,76,76,76,75,73,76,78,79,79,88,88,85,82,81,83,81,78,79,82,82,83,85,93,87,82,78,79,79,78,77,80,82,85,85,85,88,89,82,76,75,76,75,75,75,76,78,84,90,88,85,80,75,75,75,74,76,77,79,86,92,94,88,81,78,78,76,76,78,80,81,81,86,88,88,88,91,97,107,101,94,89,88,91,94,96,91,85,81,82,82,83,82,79,75,77,78,77,77,83,88,90,93,94,89,80,77,80,82,82,81,80,82,84,85,83,78,73,71,71,72,73,75,75,76,77,79,79,80,82,88,91,91,87,76,72,72,73,75,78,78,77,80,79,76,78,82,82,77,74,73,72,71,71,72,73,79,83,84,81,80,78,77,74,72,72,74,76,78,79,79,84,89,92,91,86,76,73,72,73,73,75,78,82,82,82,82,82,82,82,91,89,80,74,74,73,73,73,73,74,75,76,77,77,89,85,76,73,73,75,74,73,74,73,72,71,71,72,75,77,76,74,71,72,75,76,75,75,77,76,74,73,75,74,73,73,75,77,77,76,76,80,81,81,78,78,76,75,73,74,74,75,73,75,78,81,82,84,77,75,75,76,78,81,82,83,83,82,75,73,72,77,81,82,79,80,75,74,73,77,80,78,72,72,72,72,75,76,76,77,76,75,74,73,74,76,77,77,75,75,77,78,78,80,80,85,79,76,75,74,74,75,76,77,77,77,77,75,76,80,80,77,74,75,76,78,78,78,84,77,75,73,73,74,75,76,78,77,76,77,80,80,80,80,80,78,74,75,76,77,76,76,76,78,78,78,78,80,78,78,77,77,75,75,76,76,76,76,76,75,76,77,76,75,77,78,78,78,78,78,77,76,77,78,78,77,80,82,82,82,82,78,77,76,75,76,78,77,77,77,77,77,73,74,75,77,81,81,80,81,82,80,81,84,84,84,84,84,84,84,77,75,75,79,79,78,75,78,80,80,79,78,79,81,81,82,82,82,82,82,76,76,75,78,78,78,78,75,76,78,79,78,78,78,78,78,78,75,78,79,79,80,83,80,79,78,78,78,78,78,77,77,79,80,80,79,78,78,78,78,78,78,77,77,78,78,77,77,80,80,80,79,76,75,73,74,76,79,80,80,80,82,82,82,78,74,75,79,75,76,77,79,79,79,79,79,79,78,78,77,76,76,77,78,79,76,76,79,80,80,80,81,80,79,79,79,79,79,82,88,82,77,77,77,78,79,78,76,77,78,79,78,77,76,78,79,83,83,82,79,80,81,82,83,84,86,86,86,86,86,86,101,113,111,106,103,102,100,100,100,99,93,86,81,81,83,85,81,78,77,80,81,82,86,91,91,87,83,80,80,83,82,80,79,80,81,81,81,82,84,85,81,82,84,80,77,80,83,80,76,77,78,78,76,76,77,77,77,74,72,75,81,88,88,83,82,86,88,83,81,83,85,85,85,86,85,81,81,81,76,74,74,77,78,76,74,74,75,78,79,84,87,87,87,87,93,95,88,79,78,81,84,82,79,77,75,74,73,71,70,69,70,69,69,71,73,75,74,74,76,77,76,75,75,79,83,85,81,83,88,90,88,83,78,74,73,74,73,72,71,75,75,75,75,75,75,88,84,83,85,86,83,83,83,80,78,78,78,79,79,79,79,80,80,80,81,85,86,84,79,78,79,79,76,75,73,72,72,71,71,71,71,83,94,88,79,75,74,74,75,75,75,76,77,78,77,80,84,89,88,87,86,84,81,80,81,81,82,84,86,88,89,92,91,87,80,79,81,82,84,87,89,89,89,88,85,80,77,79,84,86,86,86,86,86,86,95,107,101,101,96,94,89,90,92,93,94,94,94,92,91,91,91,91,91,94,103,102,98,97,93,91,89,88,92,90,89,88,89,86,83,81,79,81,83,85,88,90,91,89,89,87,84,81,79,78,79,84,85,87,89,90,88,88,89,90,88,84,81,80,81,83,83,89,95,94,91,91,91,90,89,85,81,80,81,82,80,77,79,82,84,85,86,87,85,79,75,76,79,81,82,83,86,85,81,77,77,80,83,83,85,87,87,85,81,77,78,80,83,81,76,74,76,76,76,75,76,75,75,75,76,79,80,82,80,78,75,76,77,76,74,74,75,76,77,80,81,79,77,78,80,79,75,75,75,75,77,80,83,84,83,80,77,76,77,77,76,78,78,77,74,75,75,75,75,76,77,77,77,77,77,77,78,80,84,83,81,79,76,74,74,75,76,76,74,73,74,76,77,77,77,79,81,81,77,77,78,76,74,74,76,78,78,78,80,83,85,85,82,81,83,82,79,78,79,79,81,82,84,81,77,75,74,75,75,76,75,75,78,79,79,81,82,82,82,82,82,82,82,97,107,104,100,96,95,94,95,93,89,83,78,76,77,78,77,75,77,79,79,77,77,78,80,78,74,73,75,77,78,78,81,84,84,81,79,80,78,74,73,77,78,75,73,74,79,82,81,80,79,78,76,74,74,76,77,77,77,79,81,81,80,80,80,79,78,77,77,75,74,73,75,76,75,75,80,81,76,74,77,77,74,71,74,78,79,79,78,80,80,77,71,72,79,79,74,72,75,78,77,76,76,78,78,78,79,83,78,74,75,78,79,76,75,78,80,81,81,82,80,79,78,77,76,76,79,80,79,78,80,82,83,77,73,74,76,77,74,74,76,78,76,73,76,79,79,78,79,84,80,76,74,74,74,73,74,75,77,79,81,79,76,77,80,81,75,75,78,79,77,75,77,78,80,79,77,76,76,78,77,78,77,77,77,77,77,80,86,87,78,75,76,77,75,75,73,72,72,72,71,71,72,72,72,73,72,71,71,73,71,69,69,72,73,73,73,70,69,69,71,73,74,71,71,72,74,74,74,74,74,74,71,72,72,73,74,73,71,72,73,73,73,73,73,73,73,69,69,69,71,72,72,71,70,71,71,71,71,77,73,73,71,72,73,74,72,72,73,73,73,73,73,77,77,77,76,74,73,73,73,75,78,78,78,78,81,81,74,73,74,75,75,75,76,77,78,78,78,78,78,78,87,90,89,88,82,78,75,75,76,78,80,77,76,75,76,76,75,74,75,77,78,81,82,78,75,76,77,76,77,76,75,75,77,77,77,80,79,74,73,74,75,76,74,73,73,73,74,75,75,74,74,75,73,72,72,75,75,75,76,74,74,74,74,75,75,73,73,72,73,75,76,76,75,73,73,72,72,73,75,75,76,76,76,76,76,74,74,74,75,76,76,76,76,76,77,77,76,73,72,72,71,72,73,74,74,74,74,74,72,72,72,73,73,75,77,73,72,74,75,75,75,75,75,73,73,74,74,74,75,75,74,75,75,75,75,75,75,72,71,72,72,73,73,74,77,77,77,76,76,76,76,76,72,72,72,73,74,75,75,75,75,75,75,78,76,74,74,74,74,73,72,72,72,72,72,78,99,105,98,86,77,77,80,80,76,74,73,72,71,72,75,76,76,75,76,78,79,76,74,76,78,77,75,74,75,75,74,74,75,78,78,77,74,75,77,79,78,77,77,77,78,77,75,75,76,75,73,74,76,79,81,81,80,78,77,77,77,77,76,78,79,79,80,81,82,80,77,77,77,78,81,81,79,76,75,74,72,72,73,77,80,84,84,82,81,82,82,81,80,79,78,76,75,75,75,74,73,74,75,76,78,80,81,83,85,84,78,74,74,76,76,75,75,74,73,73,75,77,84,88,86,81,79,80,82,82,79,77,78,79,79,78,79,77,79,81,83,84,84,96,95,92,92,98,98,92,86,84,82,79,77,77,76,73,72,74,77,77,77,77,77,89,89,85,84,84,80,78,77,76,76,78,77,73,73,76,77,75,71,72,76,80,80,80,80,84,80,80,82,82,76,72,72,74,77,75,72,72,72,72,72,72,72,78,81,79,77,77,76,76,77,76,75,75,73,72,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,75,75,74,76,76,73,69,69,69,69,69,69,75,74,73,72,71,69,73,73,73,73,73,73,73,76,74,74,72,70,70,71,72,73,74,76,77,77,77,74,70,69,70,71,73,73,75,75,76,77,76,74,75,75,75,75,75,75,81,81,79,76,75,76,77,77,78,77,78,79,79,79,79,79,77,77,75,73,73,71,72,72,72,70,72,72,72,72,78,96,91,83,79,78,77,76,74,72,72,74,75,74,72,73,76,78,78,84,86,86,83,79,77,76,73,70,69,69,69,71,73,76,75,70,69,70,72,73,75,75,75,77,80,82,83,83,87,87,81,75,75,77,78,77,75,73,71,70,72,74,73,71,69,71,73,78,78,75,72,74,76,75,74,75,77,78,78,75,75,77,79,76,74,75,78,81,80,80,81,82,84,82,77,74,74,74,75,75,74,73,72,71,73,76,74,70,73,81,82,75,73,73,74,74,75,75,76,77,77,76,73,74,74,75,75,75,75,75,76,77,77,77,78,78,78,78,78,87,82,77,77,78,77,76,75,76,78,80,79,77,77,77,77,77,77,76,76,76,77,76,76,77,77,76,76,76,77,77,77,77,73,74,74,75,73,73,75,75,75,76,77,78,78,78,78,78,76,73,74,75,76,77,77,78,78,78,78,78,86,82,80,80,78,77,76,77,78,77,77,76,75,75,76,78,77,74,73,74,75,75,75,75,76,75,75,75,75,74,75,77,77,77,77,77,77,77,78,78,78,78,77,76,76,76,75,75,75,75,77,77,76,76,77,80,81,79,76,74,75,76,75,75,75,74,73,73,73,75,75,75,78,78,77,75,75,75,75,75,74,74,74,74,74,74,74,75,74,74,75,77,77,77,77,77,77,77,80,78,79,80,79,74,74,74,75,75,74,74,74,74,74,76,73,70,71,72,74,75,74,73,74,74,74,74,74,74,74,74,74,86,107,102,89,79,74,75,75,74,72,69,68,69,70,71,73,79,82,81,81,79,74,70,72,72,72,72,73,73,73,75,76,75,75,85,91,91,90,87,84,79,73,72,74,75,76,78,75,71,69,71,72,71,71,72,73,74,74,73,72,71,72,72,73,73,73,73,77,79,79,76,74,74,75,73,71,71,72,74,74,74,74,95,105,103,100,98,101,97,90,85,80,74,73,72,72,71,72,73,72,70,69,70,71,70,71,73,75,75,74,74,75,75,73,73,73,70,70,73,75,74,72,72,71,71,71,72,74,73,70,69,69,70,73,75,75,75,73,73,73,73,72,71,72,72,73,72,72,72,75,75,74,73,76,78,80,76,71,69,70,71,72,71,70,70,70,70,70,71,73,75,79,79,78,73,72,71,70,71,73,73,71,70,72,73,72,72,74,75,73,69,69,70,72,72,72,71,73,75,76,78,80,79,75,74,75,77,75,73,73,74,75,77,77,77,77,83,104,101,88,73,69,72,72,70,69,70,71,71,72,72,70,68,69,72,72,72,73,74,73,72,71,71,72,72,71,72,74,75,75,75,77,77,75,72,72,74,73,74,75,75,75,76,76,76,74,72,74,75,75,74,75,77,80,78,72,71,74,78,76,71,70,73,77,78,74,72,74,78,79,76,73,74,76,76,76,75,76,78,77,75,74,76,78,77,75,75,78,79,77,76,78,79,81,85,88,91,90,85,78,74,74,75,76,75,74,74,74,73,73,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,null,null],"mot":[0,0,0,0,3,2,10,2,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,8,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,3,20,0,3,36,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,4,2,0,0,4,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,5,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,5,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,3,8,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,3,2,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,7,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,5,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,1,6,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,8,5,12,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,6,17,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,4,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,10,5,0,0,0,4,0,0,1,0,2,6,1,0,1,0,0,3,2,4,1,1,0,1,28,87,null,null]},"rr":[[1365.0,2],[1366.0,2],[1367.0,5],[1368.0,10],[1369.0,8],[1370.0,6],[1371.0,8],[1372.0,8],[1373.0,9],[1374.0,12],[1375.0,10],[1376.0,9],[1377.0,6],[1378.0,6],[1379.0,9],[1380.0,7],[1381.0,5],[1382.0,7],[1383.0,7],[1384.0,8],[1385.0,7],[1386.0,3],[1387.0,5],[1388.0,7],[1389.0,5],[1390.0,7],[1391.0,8],[1392.0,3],[1393.0,6],[1394.0,4],[1395.0,3],[1396.0,4],[1397.0,8],[1398.0,6],[1399.0,7],[1400.0,6],[1401.0,2],[1402.0,4],[1403.0,5],[1404.0,8],[1405.0,5],[1406.0,6],[1407.0,9],[1408.0,9],[1409.0,5],[1410.0,12],[1411.0,9],[1412.0,10],[1413.0,10],[1414.0,12],[1415.0,5],[1416.0,7],[1417.0,12],[1418.0,13],[1419.0,6],[1420.0,5],[1421.0,6],[1422.0,7],[1423.0,7],[1424.0,5],[1425.0,13],[1426.0,11],[1427.0,13],[1428.0,11],[1429.0,8],[1430.0,9],[1431.0,8],[1432.0,7],[1433.0,5],[1434.0,8],[1435.0,8],[1436.0,8],[1437.0,11],[1438.0,7],[1439.0,7],[1440.0,10],[1441.0,13],[1442.0,10],[1443.0,8],[1444.0,9],[1445.0,8],[1446.0,6],[1447.0,6],[1448.0,7],[1449.0,11],[1450.0,7],[1451.0,9],[1452.0,8],[1453.0,10],[1454.0,8],[1455.0,8],[1456.0,12],[1457.0,9],[1458.0,12],[1459.0,8],[1460.0,3],[1461.0,4],[1462.0,6],[1463.0,5],[1464.0,4],[1465.0,9],[1466.0,5],[1467.0,6],[1468.0,9],[1469.0,8],[1470.0,10],[1471.0,4],[1472.0,6],[1473.0,6],[1474.0,8],[1475.0,2],[1476.0,7],[1477.0,10],[1478.0,12],[1479.0,10],[1480.0,11],[1481.0,10],[1482.0,7],[1483.0,12],[1484.0,5],[1485.0,11],[1486.0,8],[1487.0,7],[1488.0,3],[1489.0,10],[1490.0,8],[1491.0,6],[1492.0,3],[1493.0,7],[1494.0,5],[1495.0,5],[1496.0,5],[1497.0,11],[1498.0,8],[1499.0,12],[1500.0,6],[1501.0,7],[1502.0,3],[1503.0,11],[1504.0,10],[1505.0,1],[1506.0,6],[1507.0,3],[1508.0,6],[1509.0,3],[1510.0,5],[1511.0,4],[1512.0,7],[1513.0,7],[1514.0,4],[1515.0,7],[1516.0,7],[1517.0,3],[1518.0,2],[1519.0,4],[1520.0,4],[1521.0,6],[1522.0,2],[1523.0,1],[1524.0,3],[1525.0,3],[1526.0,3],[1527.0,4],[1528.0,7],[1529.0,5],[1530.0,4],[1531.0,2],[1532.0,4],[1533.0,2],[1534.0,5],[1535.0,5],[1536.0,3],[1537.0,3],[1538.0,7],[1539.0,6],[1540.0,2],[1541.0,11],[1542.0,9],[1543.0,8],[1544.0,12],[1545.0,12],[1546.0,7],[1547.0,4],[1548.0,9],[1549.0,8],[1550.0,6],[1551.0,4],[1552.0,9],[1553.0,7],[1554.0,9],[1555.0,4],[1556.0,9],[1557.0,7],[1558.0,6],[1559.0,9],[1560.0,10],[1561.0,11],[1562.0,9],[1563.0,9],[1564.0,13],[1565.0,11],[1566.0,11],[1567.0,9],[1568.0,10],[1569.0,10],[1570.0,8],[1571.0,8],[1572.0,12],[1573.0,10],[1574.0,12],[1575.0,12],[1576.0,8],[1577.0,9],[1578.0,9],[1579.0,10],[1580.0,9],[1581.0,8],[1582.0,8],[1583.0,12],[1584.0,7],[1585.0,11],[1586.0,10],[1587.0,11],[1588.0,9],[1589.0,10],[1590.0,9],[1591.0,10],[1592.0,5],[1593.0,6],[1594.0,8],[1595.0,10],[1596.0,5],[1597.0,3],[1598.0,3],[1599.0,6],[1600.0,11],[1601.0,5],[1602.0,7],[1603.0,8],[1604.0,11],[1605.0,5],[1606.0,9],[1607.0,6],[1608.0,9],[1609.0,9],[1610.0,9],[1611.0,7],[1612.0,8],[1613.0,12],[1614.0,11],[1615.0,13],[1616.0,14],[1617.0,12],[1618.0,15],[1619.0,4],[1620.0,8],[1621.0,9],[1622.0,14],[1623.0,11],[1624.0,9],[1625.0,7],[1626.0,7],[1627.0,8],[1628.0,13],[1629.0,10],[1630.0,6],[1631.0,9],[1632.0,10],[1633.0,12],[1634.0,10],[1635.0,11],[1636.0,12],[1637.0,11],[1638.0,9],[1639.0,11],[1640.0,11],[1641.0,13],[1642.0,11],[1643.0,8],[1644.0,6],[1645.0,10],[1646.0,12],[1647.0,8],[1648.0,7],[1649.0,11],[1650.0,10],[1651.0,9],[1652.0,9],[1653.0,10],[1654.0,8],[1655.0,9],[1656.0,8],[1657.0,5],[1658.0,4],[1659.0,3],[1660.0,2],[1661.0,1],[1662.0,1],[1663.0,2],[1664.0,1],[1665.0,7],[1666.0,4],[1667.0,2],[1668.0,3],[1669.0,4],[1670.0,5],[1671.0,3],[1672.0,7],[1673.0,8],[1674.0,2],[1675.0,8],[1676.0,11],[1677.0,11],[1678.0,9],[1679.0,6],[1680.0,6],[1681.0,5],[1682.0,10],[1683.0,5],[1684.0,2],[1685.0,10],[1686.0,10],[1687.0,4],[1688.0,7],[1689.0,8],[1690.0,5],[1691.0,6],[1692.0,6],[1693.0,6],[1694.0,4],[1695.0,5],[1696.0,6],[1697.0,8],[1698.0,5],[1699.0,9],[1700.0,6],[1701.0,10],[1702.0,6],[1703.0,9],[1704.0,10],[1705.0,7],[1706.0,11],[1707.0,5],[1708.0,10],[1709.0,10],[1710.0,12],[1711.0,13],[1712.0,14],[1713.0,10],[1714.0,7],[1715.0,4],[1716.0,6],[1717.0,12],[1718.0,8],[1719.0,4],[1720.0,9],[1721.0,6],[1722.0,8],[1723.0,11],[1724.0,9],[1725.0,9],[1726.0,7],[1727.0,7],[1728.0,10],[1729.0,6],[1730.0,11],[1731.0,10],[1732.0,11],[1733.0,8],[1734.0,9],[1735.0,8],[1736.0,8],[1737.0,6],[1738.0,10],[1739.0,7],[1740.0,11],[1741.0,1],[1742.0,5],[1743.0,10],[1744.0,9],[1745.0,3],[1746.0,4],[1747.0,9],[1748.0,5],[1749.0,10],[1750.0,9],[1751.0,8],[1752.0,6],[1753.0,6],[1754.0,7],[1755.0,7],[1756.0,9],[1757.0,9],[1758.0,10],[1759.0,7],[1760.0,8],[1761.0,8],[1762.0,6],[1763.0,7],[1764.0,6],[1765.0,6],[1766.0,5],[1767.0,7],[1768.0,6],[1769.0,8],[1770.0,10],[1771.0,11],[1772.0,5],[1773.0,7],[1774.0,10],[1775.0,10],[1776.0,8],[1777.0,7],[1778.0,7],[1779.0,11],[1780.0,10],[1781.0,9],[1782.0,12],[1783.0,9],[1784.0,8],[1785.0,6],[1786.0,7],[1787.0,9],[1788.0,11],[1789.0,9],[1790.0,8],[1791.0,9],[1792.0,9],[1793.0,9],[1794.0,10],[1795.0,7],[1796.0,8],[1797.0,7],[1798.0,10],[1799.0,11],[1800.0,12],[1801.0,12],[1802.0,9],[1803.0,12],[1804.0,14],[1805.0,11],[1806.0,10],[1807.0,10],[1808.0,7],[1809.0,5],[1810.0,3],[1811.0,12],[1812.0,14],[1813.0,10],[1814.0,8],[1815.0,10],[1816.0,9],[1817.0,9],[1818.0,8],[1819.0,11],[1820.0,9],[1821.0,9],[1822.0,11],[1823.0,9],[1824.0,11],[1825.0,8],[1826.0,9],[1827.0,7],[1828.0,11],[1829.0,8],[1830.0,9],[1831.0,10],[1832.0,7],[1833.0,10],[1834.0,11],[1835.0,8],[1836.0,9],[1837.0,9],[1838.0,10],[1839.0,9],[1840.0,4],[1841.0,9],[1842.0,9],[1843.0,7],[1844.0,5],[1845.0,5],[1846.0,5],[1847.0,6],[1848.0,7],[1849.0,3],[1850.0,9],[1851.0,8],[1852.0,9],[1853.0,7],[1854.0,7],[1855.0,8],[1856.0,9],[1857.0,10],[1858.0,11],[1859.0,11]],"apnea":[[1398.4,11.9],[1399.5,11.1],[1400.1,10.5],[1400.9,11.6],[1407.9,10.3],[1411.7,14.0],[1431.3,20.7],[1432.0,21.5],[1433.0,23.2],[1435.2,15.7],[1437.8,11.9],[1438.5,10.5],[1440.0,12.5],[1446.2,17.5],[1446.9,15.4],[1448.2,20.6],[1450.2,12.1],[1452.2,20.6],[1455.3,11.2],[1459.2,14.0],[1459.9,18.2],[1460.7,23.8],[1461.6,15.9],[1462.3,20.2],[1462.9,18.5],[1463.6,22.5],[1464.2,28.0],[1466.1,18.9],[1467.3,11.8],[1468.5,20.1],[1471.0,37.8],[1472.2,16.2],[1474.7,50.2],[1476.7,10.9],[1477.3,12.5],[1483.7,12.6],[1487.8,32.3],[1489.0,12.9],[1490.8,29.5],[1492.0,42.4],[1493.2,22.6],[1494.4,19.7],[1495.4,16.9],[1496.0,18.9],[1500.7,40.9],[1501.9,41.6],[1504.9,46.0],[1506.4,18.5],[1507.2,20.0],[1507.9,21.9],[1509.0,10.7],[1509.5,21.5],[1510.2,10.6],[1510.9,18.8],[1512.5,17.7],[1513.6,12.8],[1514.2,22.5],[1515.4,11.2],[1516.1,18.9],[1517.0,16.3],[1517.9,22.6],[1518.6,27.9],[1519.4,27.6],[1520.4,17.1],[1521.0,28.5],[1522.0,17.7],[1522.8,27.4],[1523.7,21.2],[1524.6,22.6],[1525.3,26.3],[1526.2,27.1],[1527.0,26.7],[1527.8,17.3],[1528.9,10.2],[1529.5,15.2],[1530.3,20.7],[1531.0,28.0],[1531.9,10.8],[1532.8,35.8],[1533.7,22.2],[1534.7,14.7],[1535.3,17.3],[1536.1,36.9],[1537.1,20.3],[1537.8,26.1],[1539.5,17.4],[1547.3,11.7],[1547.7,22.4],[1554.9,20.9],[1576.2,12.7],[1580.6,22.2],[1581.4,12.7],[1582.2,11.8],[1590.1,18.4],[1592.8,21.2],[1596.6,18.0],[1597.4,16.2],[1598.4,14.4],[1599.2,14.9],[1600.9,12.1],[1601.7,29.5],[1602.4,23.0],[1605.5,17.5],[1606.5,15.2],[1607.2,10.6],[1610.9,14.7],[1612.1,10.1],[1619.0,10.3],[1619.2,21.3],[1626.1,10.5],[1644.5,27.7],[1647.8,19.8],[1657.8,25.4],[1658.9,12.6],[1659.5,30.5],[1660.5,14.9],[1661.0,12.2],[1661.3,13.4],[1661.9,26.5],[1662.8,43.5],[1663.8,24.7],[1664.5,25.5],[1665.7,11.5],[1666.2,24.9],[1666.9,19.5],[1667.7,23.1],[1668.4,17.8],[1669.0,29.1],[1670.3,21.2],[1671.8,30.8],[1673.5,27.6],[1674.3,26.6],[1675.3,19.8],[1677.2,12.4],[1679.3,18.5],[1680.9,34.3],[1683.0,13.2],[1683.9,16.6],[1684.6,26.8],[1686.9,10.8],[1688.0,12.8],[1689.7,18.0],[1690.5,15.6],[1691.3,10.4],[1691.5,12.1],[1692.1,18.0],[1693.6,29.0],[1694.5,28.2],[1695.3,20.7],[1696.1,23.3],[1697.1,10.5],[1698.8,13.6],[1701.0,20.5],[1703.0,18.5],[1707.1,23.8],[1715.7,19.6],[1716.5,13.9],[1719.0,30.0],[1729.0,22.6],[1735.0,21.0],[1737.7,21.7],[1739.7,11.5],[1742.1,24.4],[1743.0,10.2],[1743.6,11.7],[1744.7,32.9],[1745.7,38.6],[1746.8,17.5],[1747.5,16.8],[1748.2,15.5],[1754.3,10.2],[1755.0,10.2],[1756.5,14.5],[1767.5,13.5],[1772.4,27.5],[1775.3,13.0],[1776.3,11.1],[1777.6,16.0],[1786.8,15.3],[1796.1,13.4],[1797.1,19.2],[1799.1,10.1],[1804.3,11.8],[1808.2,20.3],[1808.8,33.2],[1809.8,31.1],[1818.6,16.4],[1820.0,24.1],[1833.2,10.8],[1840.7,22.8],[1841.2,14.6],[1841.9,17.0],[1843.2,16.0],[1845.3,22.3]],"obstr":[[1365.2,77.95,1],[1366.7,42.7,1],[1429.5,5.07,1],[1429.9,8.95,0],[1438.0,12.25,0],[1445.8,5.62,1],[1447.2,14.03,0],[1447.9,5.48,1],[1450.5,15.2,1],[1454.0,6.38,0],[1455.6,6.15,1],[1457.7,13.8,1],[1461.2,12.88,1],[1463.3,9.6,0],[1463.9,11.75,1],[1465.7,10.78,0],[1468.9,19.62,1],[1473.5,18.15,0],[1479.7,15.92,0],[1496.4,22.33,0],[1501.7,3.67,0],[1503.7,4.33,0],[1509.8,16.35,1],[1510.5,17.0,0],[1511.2,22.93,1],[1512.8,9.27,1],[1513.8,15.48,1],[1516.4,7.8,1],[1517.4,17.2,1],[1519.1,14.8,0],[1522.4,16.27,1],[1523.3,19.0,0],[1524.1,18.83,0],[1525.0,18.23,1],[1526.7,13.05,1],[1527.4,17.0,1],[1528.3,18.5,1],[1530.0,12.22,0],[1530.8,13.95,1],[1531.5,14.92,1],[1532.3,16.93,1],[1533.3,16.35,1],[1534.2,8.43,1],[1534.3,5.53,1],[1534.9,7.55,1],[1535.2,3.75,1],[1535.8,14.07,1],[1536.7,13.32,0],[1537.4,13.23,1],[1538.2,9.85,1],[1539.2,14.0,1],[1542.1,17.5,1],[1543.0,15.65,1],[1543.8,12.02,1],[1544.8,8.08,0],[1546.0,9.17,1],[1546.5,5.45,0],[1547.1,7.55,1],[1547.5,13.53,0],[1548.2,12.75,1],[1548.9,18.47,1],[1549.8,6.38,0],[1549.9,20.6,0],[1550.8,15.7,1],[1551.5,20.73,0],[1553.1,17.1,0],[1554.1,4.52,0],[1554.4,9.1,1],[1555.2,13.98,1],[1556.1,20.5,0],[1557.0,20.73,1],[1558.5,23.38,1],[1562.8,12.73,0],[1563.2,11.9,1],[1563.8,16.1,1],[1565.4,13.95,1],[1567.4,12.6,1],[1568.0,3.62,0],[1569.0,14.2,0],[1570.0,3.55,0],[1570.9,18.88,0],[1571.9,9.35,1],[1574.9,3.9,1],[1575.0,2.4,0],[1575.7,4.17,1],[1578.0,21.25,0],[1581.7,6.42,0],[1583.6,4.2,1],[1587.6,6.33,0],[1588.5,9.33,0],[1588.7,4.8,0],[1588.7,8.88,0],[1593.3,14.47,0],[1595.3,9.15,0],[1597.9,17.78,1],[1600.4,4.88,1],[1601.1,18.07,0],[1605.1,25.5,1],[1648.5,15.7,1],[1652.2,15.42,1],[1652.9,12.53,1],[1654.0,14.6,1],[1654.8,19.18,1],[1656.0,16.03,1],[1656.8,10.73,1],[1657.5,14.73,0],[1658.4,16.22,1],[1659.3,12.75,1],[1660.0,8.1,1],[1660.8,12.88,1],[1661.7,12.58,1],[1662.6,11.83,1],[1663.5,14.8,1],[1664.3,8.32,0],[1665.1,10.4,1],[1666.0,8.2,1],[1666.6,12.72,1],[1667.5,14.7,1],[1668.2,5.15,1],[1668.7,17.35,1],[1669.7,11.05,1],[1669.9,8.35,1],[1670.7,8.47,1],[1671.3,15.52,1],[1676.8,3.3,0],[1677.9,12.23,0],[1679.6,15.05,0],[1680.5,17.42,0],[1681.5,16.2,1],[1687.6,14.93,0],[1688.3,10.0,1],[1695.8,12.6,1],[1696.7,15.43,1],[1704.9,12.27,0],[1711.9,7.75,0],[1714.0,20.03,0],[1716.1,16.4,1],[1716.9,8.62,0],[1720.3,19.12,1],[1721.0,15.6,0],[1721.8,12.52,1],[1726.3,15.7,1],[1727.1,19.2,0],[1727.8,8.2,0],[1730.8,14.52,0],[1732.3,10.73,1],[1732.6,6.85,1],[1772.1,15.55,1],[1773.8,11.4,1],[1774.9,14.85,1],[1776.0,11.55,1],[1777.3,17.0,1],[1784.8,7.5,0],[1836.5,16.5,0],[1839.2,15.45,0],[1840.1,28.05,1],[1842.8,10.6,0],[1848.9,47.85,1],[1853.0,15.7,0],[1853.8,22.67,1]]};
const T_MIN_FULL = 1359.5;
const T_MAX_FULL = 1867.7;
let T_MIN = T_MIN_FULL;
let T_MAX = T_MAX_FULL;

// ============================================================
// Color Themes
// ============================================================
const THEMES = {
  dark: {
    bodyBg: '#0a0e14',
    titleText: '#e8ecf0',
    subtitleText: '#6b7a8d',
    legendBg: '#111822',
    legendBorder: '#1e2a38',
    legendText: '#8899aa',
    versionText: '#2a3a4a',
    panelBg: '#0d1219',
    panelBorder: '#1a2430',
    gridLine: 'rgba(30,42,56,0.6)',
    gridLineX: 'rgba(30,42,56,0.4)',
    yAxisText: '#4a5a6a',
    xAxisText: '#5a6a7a',
    xAxisLine: '#1a2430',
    spo2: '#48b8e8',
    hr: '#e85878',
    resp: '#58d888',
    respArea: 'rgba(88,216,136,0.12)',
    spo2Ref: 'rgba(255,80,60,0.3)',
    evtLabel: '#ff6050',
    apneaBar: 'rgba(255,70,50,0.35)',
    obstrSevere: '#ff4040',
    obstrMod: '#f0a030',
    sevLabel: 'rgba(255,70,50,0.4)',
    modLabel: 'rgba(240,160,48,0.4)',
    motionBar: 'rgba(160,140,220,0.7)',
    motionAxis: 'rgba(160,140,220,0.7)',
    hrMA: 'rgba(255,220,80,0.85)',
    apneaLong: 'rgba(255,220,40,0.8)',
    apneaLongText: '#ffe060',
    spo2DipText: '#ff6060',
    goodSleep: 'rgba(80,200,120,0.5)',
  },
  light: {
    bodyBg: '#ffffff',
    titleText: '#111111',
    subtitleText: '#555555',
    legendBg: '#f0f0f0',
    legendBorder: '#cccccc',
    legendText: '#555555',
    versionText: '#c0c0c0',
    panelBg: '#f8f8f8',
    panelBorder: '#cccccc',
    gridLine: 'rgba(0,0,0,0.12)',
    gridLineX: 'rgba(0,0,0,0.10)',
    yAxisText: '#444444',
    xAxisText: '#444444',
    xAxisLine: '#999999',
    spo2: '#0077aa',
    hr: '#cc2244',
    resp: '#228844',
    respArea: 'rgba(34,136,68,0.10)',
    spo2Ref: 'rgba(200,50,30,0.4)',
    evtLabel: '#cc3322',
    apneaBar: 'rgba(200,50,30,0.4)',
    obstrSevere: '#cc2222',
    obstrMod: '#cc7700',
    sevLabel: 'rgba(200,50,30,0.5)',
    modLabel: 'rgba(200,120,0,0.5)',
    motionBar: 'rgba(80,60,160,0.65)',
    motionAxis: 'rgba(80,60,140,0.8)',
    hrMA: 'rgba(180,120,0,0.85)',
    apneaLong: 'rgba(200,160,0,0.75)',
    apneaLongText: '#806000',
    spo2DipText: '#cc0000',
    goodSleep: 'rgba(40,160,80,0.45)',
  }
};
let theme = THEMES.dark;

function updateLegendColors() {
  document.getElementById('lsw-spo2').style.background = theme.spo2;
  document.getElementById('lsw-hr').style.background = theme.hr;
  document.getElementById('lsw-hrma').style.background = theme.hrMA;
  document.getElementById('lsw-resp').style.background = theme.resp;
  document.getElementById('lsw-apnea').style.background = theme.apneaBar;
  document.getElementById('lsw-apnealong').style.background = theme.apneaLong;
  document.getElementById('lsw-omod').style.background = theme.obstrMod;
  document.getElementById('lsw-osev').style.background = theme.obstrSevere;
  document.getElementById('lsw-mot').style.background = theme.motionBar;
  const goodEl = document.getElementById('lsw-good');
  goodEl.style.background = 'none';
  goodEl.style.borderTop = '2px dotted ' + theme.goodSleep;
}

function toggleTheme() {
  const body = document.body;
  const btn = document.getElementById('themeToggle');
  if (body.classList.contains('light-theme')) {
    body.classList.remove('light-theme');
    theme = THEMES.dark;
    btn.innerHTML = '&#x263C; Light';
  } else {
    body.classList.add('light-theme');
    theme = THEMES.light;
    btn.innerHTML = '&#x263D; Dark';
  }
  draw();
  updateLegendColors();
}

// Auto-switch theme for printing
window.addEventListener('beforeprint', () => {
  if (!document.body.classList.contains('light-theme')) {
    document.body.classList.add('light-theme');
    document.body.dataset.wasdk = '1';
    theme = THEMES.light;
    draw();
    updateLegendColors();
  }
});
window.addEventListener('afterprint', () => {
  if (document.body.dataset.wasdk === '1') {
    document.body.classList.remove('light-theme');
    delete document.body.dataset.wasdk;
    theme = THEMES.dark;
    draw();
    updateLegendColors();
  }
});

// ============================================================
// Layout (dynamic — fills viewport)
// ============================================================
const canvas = document.getElementById('mainCanvas');
const ctx = canvas.getContext('2d');

const DPR = window.devicePixelRatio || 1;
// Panel proportional weights: SpO2, HR, Resp, Events, Motion
const PANEL_WEIGHTS = [0.25, 0.25, 0.20, 0.20, 0.10];
const PANEL_GAP = 4;
const MARGIN = { top: 6, right: 24, bottom: 28, left: 54 };

let W, TOTAL_H, PANEL_HEIGHTS, plotW;

function computeLayout() {
  W = canvas.parentElement.clientWidth;
  // Available height = viewport minus header elements
  const headerH = document.getElementById('chartArea').getBoundingClientRect().top;
  const availH = window.innerHeight - headerH - 4;
  TOTAL_H = Math.max(300, availH);
  const panelSpace = TOTAL_H - MARGIN.top - MARGIN.bottom - PANEL_GAP * (PANEL_WEIGHTS.length - 1);
  PANEL_HEIGHTS = PANEL_WEIGHTS.map(w => Math.round(w * panelSpace));
  plotW = W - MARGIN.left - MARGIN.right;

  canvas.width = W * DPR;
  canvas.height = TOTAL_H * DPR;
  canvas.style.height = TOTAL_H + 'px';
  ctx.setTransform(DPR, 0, 0, DPR, 0, 0);

  const crosshair = document.getElementById('crosshair');
  crosshair.style.height = (TOTAL_H - MARGIN.bottom) + 'px';
}

computeLayout();

function tToX(t) { return MARGIN.left + (t - T_MIN) / (T_MAX - T_MIN) * plotW; }
function xToT(x) { return T_MIN + (x - MARGIN.left) / plotW * (T_MAX - T_MIN); }

function minToClockStr(m) {
  let h = Math.floor(m / 60) % 24;
  let mn = Math.floor(m % 60);
  let s = Math.round((m % 1) * 60);
  let str = `${h.toString().padStart(2,'0')}:${mn.toString().padStart(2,'0')}`;
  if (s !== 0) str += `:${s.toString().padStart(2,'0')}`;
  return str;
}

function minToClockStrFull(m) {
  let h = Math.floor(m / 60) % 24;
  let mn = Math.floor(m % 60);
  let s = Math.round((m % 1) * 60);
  return `${h.toString().padStart(2,'0')}:${mn.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
}

function panelTop(i) {
  let y = MARGIN.top;
  for (let j = 0; j < i; j++) y += PANEL_HEIGHTS[j] + PANEL_GAP;
  return y;
}

function valToY(v, vMin, vMax, panelIdx) {
  const pt = panelTop(panelIdx);
  const ph = PANEL_HEIGHTS[panelIdx];
  const pad = 6;
  return pt + pad + (1 - (v - vMin) / (vMax - vMin)) * (ph - 2*pad);
}

// ============================================================
// Drawing helpers
// ============================================================
function drawPanelBg(idx) {
  const y = panelTop(idx);
  const h = PANEL_HEIGHTS[idx];
  ctx.fillStyle = theme.panelBg;
  ctx.fillRect(MARGIN.left, y, plotW, h);
  ctx.strokeStyle = theme.panelBorder;
  ctx.lineWidth = 1;
  ctx.strokeRect(MARGIN.left, y, plotW, h);
}

function drawLine(data, tKey, vKey, vMin, vMax, panelIdx, color, lineWidth) {
  ctx.beginPath();
  ctx.strokeStyle = color;
  ctx.lineWidth = lineWidth || 1.2;
  ctx.lineJoin = 'round';
  let first = true;
  for (const pt of data) {
    const x = tToX(pt[tKey]);
    const y = valToY(pt[vKey], vMin, vMax, panelIdx);
    if (x < MARGIN.left || x > MARGIN.left + plotW) continue;
    if (first) { ctx.moveTo(x, y); first = false; }
    else ctx.lineTo(x, y);
  }
  ctx.stroke();
}

function drawArea(data, tKey, vKey, vMin, vMax, panelIdx, fillColor) {
  const pt0 = panelTop(panelIdx);
  const ph = PANEL_HEIGHTS[panelIdx];
  const baseY = pt0 + ph - 6;
  ctx.beginPath();
  let first = true;
  let lastX;
  for (const pt of data) {
    const x = tToX(pt[tKey]);
    const y = valToY(pt[vKey], vMin, vMax, panelIdx);
    if (x < MARGIN.left || x > MARGIN.left + plotW) continue;
    if (first) { ctx.moveTo(x, baseY); ctx.lineTo(x, y); first = false; }
    else ctx.lineTo(x, y);
    lastX = x;
  }
  if (lastX !== undefined) {
    ctx.lineTo(lastX, baseY);
    ctx.closePath();
    ctx.fillStyle = fillColor;
    ctx.fill();
  }
}

function drawYAxis(vMin, vMax, panelIdx, ticks, unit, color) {
  ctx.font = '10px IBM Plex Mono';
  ctx.textAlign = 'right';
  ctx.textBaseline = 'middle';
  for (const v of ticks) {
    const y = valToY(v, vMin, vMax, panelIdx);
    ctx.strokeStyle = theme.gridLine;
    ctx.lineWidth = 0.5;
    ctx.beginPath();
    ctx.moveTo(MARGIN.left, y);
    ctx.lineTo(MARGIN.left + plotW, y);
    ctx.stroke();
    ctx.fillStyle = theme.yAxisText;
    ctx.fillText(v.toString(), MARGIN.left - 6, y);
  }
  ctx.save();
  ctx.translate(14, panelTop(panelIdx) + PANEL_HEIGHTS[panelIdx]/2);
  ctx.rotate(-Math.PI/2);
  ctx.textAlign = 'center';
  ctx.font = '500 10px IBM Plex Mono';
  ctx.fillStyle = color;
  ctx.fillText(unit, 0, 0);
  ctx.restore();
}

function drawXAxis() {
  const y = TOTAL_H - MARGIN.bottom + 4;
  ctx.font = '11px IBM Plex Mono';
  ctx.fillStyle = theme.xAxisText;
  ctx.textAlign = 'center';
  ctx.textBaseline = 'top';

  // Work in integer seconds to avoid floating-point modulo errors
  const rangeMin = T_MAX - T_MIN;
  const rangeSec = rangeMin * 60;

  // Adaptive intervals (all in seconds)
  let majorSec, minorSec, tickSec;
  // tickSec = smallest marks (short hairline at bottom only)
  // minorSec = intermediate (dashed line through panels)
  // majorSec = labelled (solid line through panels)
  if (rangeSec > 14400)     { majorSec = 3600; minorSec = 1800; tickSec = 0; }
  else if (rangeSec > 5400) { majorSec = 1800; minorSec = 900;  tickSec = 0; }
  else if (rangeSec > 2700) { majorSec = 900;  minorSec = 300;  tickSec = 60; }
  else if (rangeSec > 1200) { majorSec = 300;  minorSec = 60;   tickSec = 0; }
  else if (rangeSec > 480)  { majorSec = 120;  minorSec = 60;   tickSec = 10; }
  else if (rangeSec > 180)  { majorSec = 60;   minorSec = 10;   tickSec = 0; }
  else                      { majorSec = 30;   minorSec = 10;   tickSec = 0; }

  const finest = tickSec > 0 ? tickSec : minorSec;
  const tMinSec = Math.round(T_MIN * 60);
  const tMaxSec = Math.round(T_MAX * 60);
  const firstSec = Math.ceil(tMinSec / finest) * finest;

  for (let s = firstSec; s <= tMaxSec; s += finest) {
    const tMin = s / 60;
    const x = tToX(tMin);
    if (x < MARGIN.left - 1 || x > MARGIN.left + plotW + 1) continue;

    const isMajor = (s % majorSec) === 0;
    const isMinor = !isMajor && (s % minorSec) === 0;

    if (isMajor) {
      ctx.strokeStyle = theme.gridLineX;
      ctx.lineWidth = 0.8;
      ctx.setLineDash([]);
      ctx.beginPath();
      ctx.moveTo(x, MARGIN.top);
      ctx.lineTo(x, TOTAL_H - MARGIN.bottom);
      ctx.stroke();
      // Major tick mark on axis
      ctx.strokeStyle = theme.xAxisText;
      ctx.lineWidth = 1.2;
      ctx.beginPath();
      ctx.moveTo(x, TOTAL_H - MARGIN.bottom - 7);
      ctx.lineTo(x, TOTAL_H - MARGIN.bottom);
      ctx.stroke();
      ctx.fillText(minToClockStr(tMin), x, y);
    } else if (isMinor) {
      // Minor ticks: solid marks on axis, 5px tall
      ctx.strokeStyle = theme.xAxisText;
      ctx.lineWidth = 0.7;
      ctx.setLineDash([]);
      ctx.beginPath();
      ctx.moveTo(x, TOTAL_H - MARGIN.bottom - 5);
      ctx.lineTo(x, TOTAL_H - MARGIN.bottom);
      ctx.stroke();
    } else {
      // Finest tick marks: short solid marks, 3px tall
      ctx.strokeStyle = theme.xAxisText;
      ctx.lineWidth = 0.4;
      ctx.setLineDash([]);
      ctx.beginPath();
      ctx.moveTo(x, TOTAL_H - MARGIN.bottom - 3);
      ctx.lineTo(x, TOTAL_H - MARGIN.bottom);
      ctx.stroke();
    }
  }
  ctx.strokeStyle = theme.xAxisLine;
  ctx.lineWidth = 1;
  ctx.setLineDash([]);
  ctx.beginPath();
  ctx.moveTo(MARGIN.left, TOTAL_H - MARGIN.bottom);
  ctx.lineTo(MARGIN.left + plotW, TOTAL_H - MARGIN.bottom);
  ctx.stroke();
}

// ============================================================
// Prepare data arrays
// ============================================================
// SleepU stored compactly: {t0, dt, spo2:[], hr:[], mot:[]}
// Reconstruct time from index: t = t0 + i * dt
const _su = RAW.sleepU;
const spo2Data = [];
const hrData   = [];
const motData  = [];
for (let i = 0; i < _su.spo2.length; i++) {
  const t = _su.t0 + i * _su.dt;
  if (_su.spo2[i] !== null) spo2Data.push({t, v: _su.spo2[i]});
  if (_su.hr[i]   !== null) hrData.push({t, v: _su.hr[i]});
  if (_su.mot[i]  !== null) motData.push({t, v: _su.mot[i]});
}
const rrData    = RAW.rr.map(d => ({t: d[0], v: d[1]}));
const apneaData = RAW.apnea.map(d => ({t: d[0], dur: d[1]}));
const obstrData = RAW.obstr.map(d => ({t: d[0], dur: d[1], sev: d[2]}));

// ============================================================
// Compute dynamic Y-axis ranges from data
// ============================================================
const spo2Vals = spo2Data.map(d => d.v);
const hrVals = hrData.map(d => d.v);
const rrVals = rrData.map(d => d.v);

const SPO2_MIN = Math.max(70, Math.min(...spo2Vals) - 2);
const SPO2_MAX = 100;
const HR_MIN = Math.max(30, Math.floor((Math.min(...hrVals) - 3) / 5) * 5);
const HR_MAX = Math.min(200, Math.ceil((Math.max(...hrVals) + 3) / 5) * 5);
const RR_MIN = 0;
const RR_MAX = Math.ceil((Math.max(...rrVals) + 2) / 5) * 5;
const MOT_MAX = Math.max(10, Math.ceil(Math.max(...motData.map(d => d.v)) / 5) * 5);

// Compute apnea Y-axis range (seconds)
const APNEA_MAX_DUR = apneaData.length > 0
  ? Math.ceil(Math.max(...apneaData.map(d => d.dur)) / 10) * 10
  : 60;

// Compute HR moving average (window ~5 minutes centered)
const HR_MA_WINDOW = 75;  // samples each side (~5 min half-window at 4s interval)
const hrMA = [];
for (let i = 0; i < hrData.length; i++) {
  let lo = Math.max(0, i - HR_MA_WINDOW);
  let hi = Math.min(hrData.length - 1, i + HR_MA_WINDOW);
  let sum = 0;
  for (let j = lo; j <= hi; j++) sum += hrData[j].v;
  hrMA.push({t: hrData[i].t, v: Math.round(sum / (hi - lo + 1) * 10) / 10});
}

// Detect SpO2 dips below 85% (local minima with >=20 sample spacing)
const SPO2_DIP_THRESH = 85;
const spo2Dips = [];
const DIP_MIN_SEP = 20; // minimum samples between reported dips
for (let i = 1; i < spo2Data.length - 1; i++) {
  const v = spo2Data[i].v;
  if (v >= SPO2_DIP_THRESH) continue;
  // Check it's a local minimum within a window of ±5 samples
  let isMin = true;
  for (let j = Math.max(0, i-5); j <= Math.min(spo2Data.length-1, i+5); j++) {
    if (j !== i && spo2Data[j].v < v) { isMin = false; break; }
  }
  if (!isMin) continue;
  // Enforce spacing from previous dip
  if (spo2Dips.length > 0 && i - spo2Dips[spo2Dips.length-1].idx < DIP_MIN_SEP) {
    // Keep the deeper one
    if (v < spo2Dips[spo2Dips.length-1].v) spo2Dips[spo2Dips.length-1] = {idx: i, t: spo2Data[i].t, v};
    continue;
  }
  spo2Dips.push({idx: i, t: spo2Data[i].t, v});
}

// Compute HR 15-minute moving average (for good-sleep detection)
const HR_MA15_WINDOW = 112;  // samples each side (~7.5 min half-window → 15 min total at 4s)
const hrMA15 = [];
for (let i = 0; i < hrData.length; i++) {
  let lo = Math.max(0, i - HR_MA15_WINDOW);
  let hi = Math.min(hrData.length - 1, i + HR_MA15_WINDOW);
  let sum = 0;
  for (let j = lo; j <= hi; j++) sum += hrData[j].v;
  hrMA15.push({t: hrData[i].t, v: sum / (hi - lo + 1)});
}

// ============================================================
// Detect "good sleep" periods (≥20 min contiguous)
//   1. No apnea events
//   2. No obstructions (moderate or severe)
//   3. SpO2 ≥ 96%
//   4. 15-min HR MA non-increasing
// ============================================================
const GOOD_MIN_DURATION = 15; // minutes
const HR_RISE_TOL = 1.0;     // bpm tolerance for "non-increasing"
const HR_LOOKBACK = 30;      // samples (~2 min) for slope check

// Build sorted event intervals for quick overlap checks
const evtIntervals = [];
for (const a of apneaData) evtIntervals.push({t0: a.t, t1: a.t + a.dur / 60});
for (const o of obstrData) evtIntervals.push({t0: o.t, t1: o.t + o.dur / 60});
evtIntervals.sort((a, b) => a.t0 - b.t0);

// Scan at HR data resolution
const goodMask = new Uint8Array(hrData.length); // 1 = good at this sample
for (let i = 0; i < hrData.length; i++) {
  const t = hrData[i].t;

  // Check 1 & 2: no apnea or obstruction overlapping this time
  let hasEvent = false;
  for (const ev of evtIntervals) {
    if (ev.t0 > t + 0.5) break; // events are sorted, no need to check further
    if (ev.t1 >= t - 0.5) { hasEvent = true; break; }
  }
  if (hasEvent) continue;

  // Check 3: SpO2 ≥ 96% (find nearest SpO2 sample)
  // Binary-ish search: SpO2 data is same resolution as HR from same source
  let spo2Ok = false;
  for (let si = Math.max(0, i - 2); si <= Math.min(spo2Data.length - 1, i + 2); si++) {
    if (Math.abs(spo2Data[si].t - t) < 0.2) {
      if (spo2Data[si].v >= 96) spo2Ok = true;
      break;
    }
  }
  if (!spo2Ok) continue;

  // Check 4: 15-min HR MA non-increasing (not rising >1 bpm vs 2 min ago)
  if (i >= HR_LOOKBACK) {
    if (hrMA15[i].v > hrMA15[i - HR_LOOKBACK].v + HR_RISE_TOL) continue;
  }

  goodMask[i] = 1;
}

// Extract contiguous runs ≥ GOOD_MIN_DURATION
const goodPeriods = [];
let runStart = -1;
for (let i = 0; i <= hrData.length; i++) {
  if (i < hrData.length && goodMask[i]) {
    if (runStart < 0) runStart = i;
  } else {
    if (runStart >= 0) {
      const tStart = hrData[runStart].t;
      const tEnd = hrData[i - 1].t;
      if (tEnd - tStart >= GOOD_MIN_DURATION) {
        goodPeriods.push({t0: tStart, t1: tEnd});
      }
      runStart = -1;
    }
  }
}

// Append restful total to subtitle
const restfulTotal = Math.round(goodPeriods.reduce((s, gp) => s + (gp.t1 - gp.t0), 0));
document.querySelector('.subtitle').insertAdjacentHTML('beforeend',
  ` \u00a0\u00a0\u2022 \u00a0Restful: ${restfulTotal}m`);

// Generate tick arrays
function makeTicks(lo, hi, step) {
  const ticks = [];
  for (let v = Math.ceil(lo/step)*step; v <= hi; v += step) ticks.push(v);
  return ticks;
}

const spo2Ticks = makeTicks(SPO2_MIN, SPO2_MAX, 5);
const hrTicks = makeTicks(HR_MIN, HR_MAX, (HR_MAX - HR_MIN > 40) ? 10 : 5);
const rrTicks = makeTicks(RR_MIN, RR_MAX, 5);
const apneaTicks = makeTicks(0, APNEA_MAX_DUR, APNEA_MAX_DUR > 80 ? 20 : 10);
const motTicks = makeTicks(0, MOT_MAX, MOT_MAX > 30 ? Math.ceil(MOT_MAX / 3 / 5) * 5 : 5);

// ============================================================
// DRAW
// ============================================================
function draw() {
  ctx.fillStyle = theme.bodyBg;
  ctx.fillRect(0, 0, W, TOTAL_H);
  for (let i = 0; i < 5; i++) drawPanelBg(i);
  drawXAxis();

  // Panel 0: SpO2
  drawYAxis(SPO2_MIN, SPO2_MAX, 0, spo2Ticks, 'SpO\u2082 %', theme.spo2);
  const y90 = valToY(90, SPO2_MIN, SPO2_MAX, 0);
  ctx.strokeStyle = theme.spo2Ref;
  ctx.lineWidth = 1;
  ctx.setLineDash([4,4]);
  ctx.beginPath(); ctx.moveTo(MARGIN.left, y90); ctx.lineTo(MARGIN.left+plotW, y90); ctx.stroke();
  ctx.setLineDash([]);
  drawLine(spo2Data, 't', 'v', SPO2_MIN, SPO2_MAX, 0, theme.spo2, 1.0);

  // Label SpO2 dips below 85%
  ctx.font = 'bold 11px IBM Plex Mono';
  ctx.fillStyle = theme.spo2DipText;
  ctx.textAlign = 'center';
  ctx.textBaseline = 'top';
  for (const dip of spo2Dips) {
    const dx = tToX(dip.t);
    const dy = valToY(dip.v, SPO2_MIN, SPO2_MAX, 0);
    ctx.fillText(dip.v + '%', dx, dy + 3);
  }

  // Panel 1: HR
  drawYAxis(HR_MIN, HR_MAX, 1, hrTicks, 'HR bpm', theme.hr);
  drawLine(hrData, 't', 'v', HR_MIN, HR_MAX, 1, theme.hr, 1.0);
  drawLine(hrMA, 't', 'v', HR_MIN, HR_MAX, 1, theme.hrMA, 2.0);

  // Panel 2: Respiratory Rate
  drawYAxis(RR_MIN, RR_MAX, 2, rrTicks, 'Resp br/m', theme.resp);
  drawArea(rrData, 't', 'v', RR_MIN, RR_MAX, 2, theme.respArea);
  drawLine(rrData, 't', 'v', RR_MIN, RR_MAX, 2, theme.resp, 1.2);

  // Panel 3: Events (apnea bars scaled to seconds Y-axis)
  const EVT_TOP = panelTop(3);
  const EVT_H = PANEL_HEIGHTS[3];
  drawYAxis(0, APNEA_MAX_DUR, 3, apneaTicks, 'Apnea (s)', theme.evtLabel);

  // Draw good-sleep indicators (green dotted line at panel midpoint)
  const goodY = EVT_TOP + EVT_H * 0.5;
  ctx.strokeStyle = theme.goodSleep;
  ctx.lineWidth = 2;
  ctx.setLineDash([6, 4]);
  for (const gp of goodPeriods) {
    const x0 = Math.max(tToX(gp.t0), MARGIN.left);
    const x1 = Math.min(tToX(gp.t1), MARGIN.left + plotW);
    if (x1 <= x0) continue;
    ctx.beginPath();
    ctx.moveTo(x0, goodY);
    ctx.lineTo(x1, goodY);
    ctx.stroke();
  }
  ctx.setLineDash([]);

  // Draw all apnea bars first (clipped to plot area)
  const apneaBars = [];
  const plotLeft = MARGIN.left;
  const plotRight = MARGIN.left + plotW;
  for (const a of apneaData) {
    let x = tToX(a.t);
    const w = Math.max(1.5, (a.dur / 60) / (T_MAX - T_MIN) * plotW);
    let x2 = x + w;
    // Clip to plot area
    if (x2 < plotLeft || x > plotRight) continue;
    x = Math.max(x, plotLeft);
    x2 = Math.min(x2, plotRight);
    const clampDur = Math.min(a.dur, APNEA_MAX_DUR);
    const barBot = EVT_TOP + EVT_H - 6;
    const barTop = valToY(clampDur, 0, APNEA_MAX_DUR, 3);
    const h = barBot - barTop;
    const isLong = a.dur > 50;
    ctx.fillStyle = isLong ? theme.apneaLong : theme.apneaBar;
    ctx.fillRect(x, barTop, x2 - x, h);
    apneaBars.push({x, w: x2 - x, barTop, barBot, dur: a.dur, isLong});
  }

  // Collect obstruction dot bounding boxes
  const obstrBoxes = [];
  for (const o of obstrData) {
    const ox = tToX(o.t);
    if (ox < plotLeft || ox > plotRight) continue;
    const oy = EVT_TOP + (o.sev === 1 ? 6 : 16);
    const r = o.sev === 1 ? 2.5 : 2;
    obstrBoxes.push({x: ox - r, y: oy - r, w: r*2, h: r*2});
    ctx.beginPath();
    ctx.arc(ox, oy, r, 0, Math.PI*2);
    ctx.fillStyle = o.sev === 1 ? theme.obstrSevere : theme.obstrMod;
    ctx.fill();
  }

  // Place >50s apnea labels: prefer left/right of bar, no leader lines
  ctx.font = 'bold 11px IBM Plex Mono';
  const LABEL_H = 12;
  const LABEL_GAP = 3;
  const placedLabels = []; // {x, y, w, h} bounding boxes

  function boxOverlaps(ax, ay, aw, ah, bx, by, bw, bh) {
    return ax < bx + bw && ax + aw > bx && ay < by + bh && ay + ah > by;
  }

  function labelCollides(lx, ly, lw) {
    for (const ob of obstrBoxes) {
      if (boxOverlaps(lx, ly, lw, LABEL_H, ob.x - 2, ob.y - 2, ob.w + 4, ob.h + 4)) return true;
    }
    for (const pl of placedLabels) {
      if (boxOverlaps(lx, ly, lw, LABEL_H, pl.x, pl.y, pl.w, pl.h)) return true;
    }
    for (const b of apneaBars) {
      if (boxOverlaps(lx, ly, lw, LABEL_H, b.x - 1, b.barTop, b.w + 2, b.barBot - b.barTop)) return true;
    }
    return false;
  }

  // Collect long bars and group into clusters (nearby = within 40px)
  const longBars = apneaBars.filter(b => b.isLong);
  const CLUSTER_DIST = 40;
  const clusters = [];
  for (const b of longBars) {
    const cx = b.x + b.w / 2;
    if (clusters.length > 0) {
      const last = clusters[clusters.length - 1];
      const lastCx = last[last.length - 1].x + last[last.length - 1].w / 2;
      if (cx - lastCx < CLUSTER_DIST) {
        last.push(b);
        continue;
      }
    }
    clusters.push([b]);
  }

  for (const cluster of clusters) {
    for (let ci = 0; ci < cluster.length; ci++) {
      const b = cluster[ci];
      const label = Math.round(b.dur) + 's';
      const lw = ctx.measureText(label).width + 4;
      const midY = b.barTop + Math.min(12, (b.barBot - b.barTop) * 0.3);

      // Build ordered candidate positions
      const candidates = [];
      const leftX = b.x - lw - LABEL_GAP;
      const rightX = b.x + b.w + LABEL_GAP;
      const aboveX = b.x + b.w/2 - lw/2;
      const aboveY = b.barTop - LABEL_H - 2;

      if (cluster.length === 1) {
        // Isolated: try right, left, then above
        candidates.push({x: rightX, y: midY});
        candidates.push({x: leftX, y: midY});
        candidates.push({x: aboveX, y: aboveY});
      } else if (cluster.length === 2) {
        // Pair: first goes left, second goes right
        if (ci === 0) {
          candidates.push({x: leftX, y: midY});
          candidates.push({x: rightX, y: midY});
          candidates.push({x: aboveX, y: aboveY});
        } else {
          candidates.push({x: rightX, y: midY});
          candidates.push({x: leftX, y: midY});
          candidates.push({x: aboveX, y: aboveY});
        }
      } else {
        // 3+: outer go outward, middle ones go above then left/right
        if (ci === 0) {
          candidates.push({x: leftX, y: midY});
          candidates.push({x: aboveX, y: aboveY});
          candidates.push({x: rightX, y: midY});
        } else if (ci === cluster.length - 1) {
          candidates.push({x: rightX, y: midY});
          candidates.push({x: aboveX, y: aboveY});
          candidates.push({x: leftX, y: midY});
        } else {
          candidates.push({x: aboveX, y: aboveY});
          candidates.push({x: rightX, y: midY});
          candidates.push({x: leftX, y: midY});
        }
      }

      // Try each candidate, pick first that fits
      let placed = false;
      for (const c of candidates) {
        if (c.x < MARGIN.left - 4 || c.x + lw > MARGIN.left + plotW + 4) continue;
        if (c.y < EVT_TOP) continue;
        if (!labelCollides(c.x, c.y, lw)) {
          ctx.fillStyle = theme.apneaLongText;
          ctx.textAlign = 'left';
          ctx.textBaseline = 'top';
          ctx.fillText(label, c.x, c.y);
          placedLabels.push({x: c.x, y: c.y, w: lw, h: LABEL_H});
          placed = true;
          break;
        }
      }
      // Fallback: draw to right regardless
      if (!placed) {
        const fx = rightX;
        const fy = midY;
        ctx.fillStyle = theme.apneaLongText;
        ctx.textAlign = 'left';
        ctx.textBaseline = 'top';
        ctx.fillText(label, fx, fy);
        placedLabels.push({x: fx, y: fy, w: lw, h: LABEL_H});
      }
    }
  }

  // Panel 4: Motion
  const MOT_TOP = panelTop(4);
  const MOT_H = PANEL_HEIGHTS[4];
  drawYAxis(0, MOT_MAX, 4, motTicks, 'Motion', theme.motionAxis);
  for (const m of motData) {
    if (m.v === 0) continue;
    const x = tToX(m.t);
    if (x < MARGIN.left || x > MARGIN.left + plotW) continue;
    const barH = Math.max(1, (Math.min(m.v, MOT_MAX) / MOT_MAX) * (MOT_H - 8));
    const y = MOT_TOP + MOT_H - 3 - barH;
    ctx.fillStyle = theme.motionBar;
    ctx.fillRect(x - 0.5, y, 1.5, barH);
  }
}

draw();

// ============================================================
// Tooltip / Crosshair
// ============================================================
const tooltip = document.getElementById('tooltip');
const chartArea = document.getElementById('chartArea');

function findNearest(arr, t) {
  const maxDist = Math.max(0.5, (T_MAX - T_MIN) * 0.006); // ~0.6% of visible range
  let best = null, bestDist = Infinity;
  for (const pt of arr) {
    const d = Math.abs(pt.t - t);
    if (d < bestDist) { bestDist = d; best = pt; }
  }
  return bestDist < maxDist ? best : null;
}

chartArea.addEventListener('mousemove', (e) => {
  if (panState) {
    crosshair.style.display = 'none';
    tooltip.style.display = 'none';
    return;
  }
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  const my = e.clientY - rect.top;

  if (mx < MARGIN.left || mx > MARGIN.left + plotW || my > TOTAL_H - MARGIN.bottom) {
    crosshair.style.display = 'none';
    tooltip.style.display = 'none';
    return;
  }

  const t = xToT(mx);
  crosshair.style.display = 'block';
  crosshair.style.left = mx + 'px';

  const sp = findNearest(spo2Data, t);
  const hr = findNearest(hrData, t);
  const hrm = findNearest(hrMA, t);
  const rr = findNearest(rrData, t);
  const mo = findNearest(motData, t);

  let apnStr = '';
  for (const a of apneaData) {
    if (t >= a.t && t <= a.t + a.dur/60) {
      apnStr = `${a.dur.toFixed(0)}s apnea`;
      break;
    }
  }

  let html = `<div class="tt-time">${minToClockStrFull(t)}</div>`;
  if (sp) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.spo2}"></div>SpO\u2082: ${sp.v}%</div>`;
  if (hr) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.hr}"></div>HR: ${hr.v} bpm</div>`;
  if (hrm) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.hrMA}"></div>HR avg: ${hrm.v} bpm</div>`;
  if (rr) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.resp}"></div>Resp: ${rr.v} br/min</div>`;
  if (mo && mo.v > 0) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.motionAxis}"></div>Motion: ${mo.v}</div>`;
  if (apnStr) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.obstrSevere}"></div>${apnStr}</div>`;

  tooltip.innerHTML = html;
  tooltip.style.display = 'block';

  let tx = mx + 16;
  let ty = my - 10;
  const tw = tooltip.offsetWidth;
  if (tx + tw > W - 8) tx = mx - tw - 16;
  if (ty < 4) ty = 4;
  tooltip.style.left = tx + 'px';
  tooltip.style.top = ty + 'px';
});

chartArea.addEventListener('mouseleave', () => {
  crosshair.style.display = 'none';
  tooltip.style.display = 'none';
});

// ============================================================
// Zoom & Pan
// ============================================================
const ZOOM_FACTOR = 0.8; // scroll-zoom sensitivity (smaller = zoom faster)
const MIN_RANGE = 2;     // minimum visible range in minutes

function updateZoomUI() {
  const btn = document.getElementById('resetZoom');
  const isZoomed = Math.abs(T_MIN - T_MIN_FULL) > 0.1 || Math.abs(T_MAX - T_MAX_FULL) > 0.1;
  btn.style.display = isZoomed ? 'block' : 'none';
  canvas.classList.toggle('zoomed', isZoomed);
}

function resetZoom() {
  T_MIN = T_MIN_FULL;
  T_MAX = T_MAX_FULL;
  updateZoomUI();
  draw();
}

// Wheel zoom: centered on cursor position
chartArea.addEventListener('wheel', (e) => {
  e.preventDefault();
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  if (mx < MARGIN.left || mx > MARGIN.left + plotW) return;

  const tCursor = xToT(mx);
  const range = T_MAX - T_MIN;
  const factor = e.deltaY > 0 ? 1 / ZOOM_FACTOR : ZOOM_FACTOR;
  const newRange = Math.max(MIN_RANGE, Math.min(T_MAX_FULL - T_MIN_FULL, range * factor));

  // Fraction of cursor within the current view
  const frac = (tCursor - T_MIN) / range;
  T_MIN = tCursor - frac * newRange;
  T_MAX = tCursor + (1 - frac) * newRange;

  // Clamp to full range
  if (T_MIN < T_MIN_FULL) { T_MAX += T_MIN_FULL - T_MIN; T_MIN = T_MIN_FULL; }
  if (T_MAX > T_MAX_FULL) { T_MIN -= T_MAX - T_MAX_FULL; T_MAX = T_MAX_FULL; }
  T_MIN = Math.max(T_MIN, T_MIN_FULL);
  T_MAX = Math.min(T_MAX, T_MAX_FULL);

  updateZoomUI();
  draw();
}, {passive: false});

// Click-drag pan
let panState = null;
chartArea.addEventListener('mousedown', (e) => {
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  if (mx < MARGIN.left || mx > MARGIN.left + plotW) return;
  // Only pan when zoomed in
  if (Math.abs(T_MAX - T_MIN - (T_MAX_FULL - T_MIN_FULL)) < 0.1) return;
  panState = { startX: e.clientX, startTMin: T_MIN, startTMax: T_MAX };
  canvas.classList.add('panning');
});

window.addEventListener('mousemove', (e) => {
  if (!panState) return;
  const dx = e.clientX - panState.startX;
  const dtPerPx = (panState.startTMax - panState.startTMin) / plotW;
  let shift = -dx * dtPerPx;

  let newMin = panState.startTMin + shift;
  let newMax = panState.startTMax + shift;
  if (newMin < T_MIN_FULL) { newMax += T_MIN_FULL - newMin; newMin = T_MIN_FULL; }
  if (newMax > T_MAX_FULL) { newMin -= newMax - T_MAX_FULL; newMax = T_MAX_FULL; }

  T_MIN = Math.max(newMin, T_MIN_FULL);
  T_MAX = Math.min(newMax, T_MAX_FULL);
  updateZoomUI();
  draw();
});

window.addEventListener('mouseup', () => {
  if (panState) {
    panState = null;
    canvas.classList.remove('panning');
  }
});

// ============================================================
// Save PNG at specified resolution with header
// ============================================================
function savePNG(exportScale) {
  const EXPORT_SCALE = exportScale || 2;
  const isLight = document.body.classList.contains('light-theme');

  // --- Measure header content from DOM ---
  const titleText = document.querySelector('h1').textContent;
  const subtitleText = document.querySelector('.subtitle').textContent;
  const legendItems = [];
  document.querySelectorAll('.legend-item').forEach(item => {
    const swatch = item.querySelector('.legend-swatch');
    const cs = getComputedStyle(swatch);
    legendItems.push({
      color: cs.backgroundColor,
      borderColor: cs.borderTopColor,
      isDot: swatch.classList.contains('dot'),
      isBar: swatch.classList.contains('bar'),
      text: item.textContent.trim()
    });
  });

  // --- Header layout constants ---
  const PAD_TOP = 12;
  const TITLE_H = 24;
  const GAP1 = 4;
  const SUB_H = 16;
  const GAP2 = 8;
  const LEG_PAD = 8;
  const LEG_ROW_H = 16;
  const LEG_BOT = 8;

  // Pre-measure legend to determine if it wraps
  const tmpC = document.createElement('canvas');
  const tmpX = tmpC.getContext('2d');
  tmpX.font = '12px IBM Plex Mono';
  const LEG_ITEM_GAP = 20;
  const LEG_SWATCH_W = 20;
  const maxLegW = W - 32;
  let rows = [[]];
  let rowW = 0;
  for (const item of legendItems) {
    const iw = LEG_SWATCH_W + tmpX.measureText(item.text).width + LEG_ITEM_GAP;
    if (rowW > 0 && rowW + iw > maxLegW) {
      rows.push([]);
      rowW = 0;
    }
    rows[rows.length - 1].push(item);
    rowW += iw;
  }
  const legendBoxH = LEG_PAD + rows.length * LEG_ROW_H + LEG_BOT;
  const headerH = PAD_TOP + TITLE_H + GAP1 + SUB_H + GAP2 + legendBoxH + 8;

  // --- Create offscreen canvas ---
  const totalH = headerH + TOTAL_H;
  const off = document.createElement('canvas');
  off.width = W * EXPORT_SCALE;
  off.height = totalH * EXPORT_SCALE;
  const oc = off.getContext('2d');
  oc.setTransform(EXPORT_SCALE, 0, 0, EXPORT_SCALE, 0, 0);

  // Background
  oc.fillStyle = theme.bodyBg;
  oc.fillRect(0, 0, W, totalH);

  // Title
  let y = PAD_TOP;
  oc.font = '600 20px IBM Plex Sans, sans-serif';
  oc.fillStyle = theme.titleText;
  oc.textAlign = 'left';
  oc.textBaseline = 'top';
  oc.fillText(titleText, 0, y);

  // Version stamp (top-right, subtle)
  const versionText = document.getElementById('versionStamp').textContent;
  oc.font = '9px IBM Plex Mono, monospace';
  oc.fillStyle = theme.versionText;
  oc.textAlign = 'right';
  oc.textBaseline = 'top';
  oc.fillText(versionText, W, y + 4);
  oc.textAlign = 'left';

  y += TITLE_H + GAP1;

  // Subtitle
  oc.font = '13px IBM Plex Mono, monospace';
  oc.fillStyle = theme.subtitleText;
  oc.fillText(subtitleText, 0, y);
  y += SUB_H + GAP2;

  // Legend box
  oc.fillStyle = theme.legendBg;
  oc.strokeStyle = theme.legendBorder;
  oc.lineWidth = 1;
  const legBoxY = y;
  oc.beginPath();
  oc.roundRect(16, legBoxY, W - 32, legendBoxH, 6);
  oc.fill();
  oc.stroke();

  // Legend items
  oc.font = '12px IBM Plex Mono, monospace';
  let ly = legBoxY + LEG_PAD;
  for (const row of rows) {
    let lx = 32;
    for (const item of row) {
      // Swatch
      oc.fillStyle = item.color;
      if (item.isDot) {
        oc.beginPath();
        oc.arc(lx + 4, ly + 6, 4, 0, Math.PI * 2);
        oc.fill();
      } else if (item.isBar) {
        oc.fillRect(lx, ly + 1, 14, 10);
      } else {
        // Check if this is the "Restful" item (dotted line style)
        if (item.text.includes('Restful')) {
          oc.strokeStyle = item.borderColor || item.color;
          oc.lineWidth = 2;
          oc.setLineDash([6, 4]);
          oc.beginPath();
          oc.moveTo(lx, ly + 6);
          oc.lineTo(lx + 14, ly + 6);
          oc.stroke();
          oc.setLineDash([]);
        } else {
          // Regular solid line
          oc.fillRect(lx, ly + 4, 14, 4);
        }
      }
      lx += LEG_SWATCH_W;
      // Label
      oc.fillStyle = theme.legendText;
      oc.textAlign = 'left';
      oc.textBaseline = 'top';
      oc.fillText(item.text, lx, ly);
      lx += oc.measureText(item.text).width + LEG_ITEM_GAP;
    }
    ly += LEG_ROW_H;
  }

  // --- Render chart at export scale, then composite ---
  canvas.width = W * EXPORT_SCALE;
  canvas.height = TOTAL_H * EXPORT_SCALE;
  ctx.setTransform(EXPORT_SCALE, 0, 0, EXPORT_SCALE, 0, 0);
  draw();

  oc.setTransform(1, 0, 0, 1, 0, 0);
  oc.drawImage(canvas, 0, headerH * EXPORT_SCALE,
               W * EXPORT_SCALE, TOTAL_H * EXPORT_SCALE);

  // --- Download ---
  const link = document.createElement('a');
  link.download = `sleep_dashboard_2026-02-04_${EXPORT_SCALE}x.png`;
  link.href = off.toDataURL('image/png');
  link.click();

  // --- Restore main canvas ---
  canvas.width = W * DPR;
  canvas.height = TOTAL_H * DPR;
  canvas.style.height = TOTAL_H + 'px';
  ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
  draw();
}

window.addEventListener('resize', () => {
  computeLayout();
  draw();
});
</script>
</body>
</html>
