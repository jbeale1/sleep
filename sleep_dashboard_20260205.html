<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sleep Study — 2026-02-05</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:wght@300;400;500;600&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #0a0e14;
    color: #c5cdd8;
    font-family: 'IBM Plex Sans', sans-serif;
    padding: 8px 32px 0;
    min-height: 100vh;
    overflow: hidden;
  }

  h1 {
    font-size: 20px;
    font-weight: 600;
    color: #e8ecf0;
    margin-bottom: 4px;
    letter-spacing: -0.3px;
  }

  .subtitle {
    font-size: 13px;
    color: #6b7a8d;
    margin-bottom: 8px;
    font-family: 'IBM Plex Mono', monospace;
  }

  .chart-container {
    position: relative;
    width: 100%;
  }

  canvas {
    display: block;
    width: 100% !important;
  }

  canvas.zoomed { cursor: grab; }
  canvas.zoomed.panning { cursor: grabbing; }

  .legend {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    margin-bottom: 6px;
    padding: 6px 16px;
    background: #111822;
    border-radius: 6px;
    border: 1px solid #1e2a38;
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    font-family: 'IBM Plex Mono', monospace;
    color: #8899aa;
  }

  .legend-swatch {
    width: 14px;
    height: 4px;
    border-radius: 2px;
  }

  .legend-swatch.dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
  }

  .legend-swatch.bar {
    width: 14px;
    height: 10px;
    border-radius: 2px;
  }

  .tooltip-box {
    position: absolute;
    display: none;
    pointer-events: none;
    background: #161e28;
    border: 1px solid #2a3a4a;
    border-radius: 6px;
    padding: 8px 12px;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 11px;
    color: #c5cdd8;
    z-index: 100;
    white-space: nowrap;
    box-shadow: 0 4px 16px rgba(0,0,0,0.4);
  }

  .tooltip-box .tt-time {
    font-weight: 600;
    color: #e8ecf0;
    margin-bottom: 4px;
  }

  .tooltip-box .tt-row {
    display: flex;
    align-items: center;
    gap: 6px;
    margin: 2px 0;
  }

  .tooltip-box .tt-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .crosshair {
    position: absolute;
    top: 0;
    width: 1px;
    background: rgba(100,140,180,0.25);
    pointer-events: none;
    display: none;
  }

  .btn-bar {
    position: fixed;
    top: 12px;
    right: 16px;
    display: flex;
    gap: 8px;
    z-index: 200;
  }

  .theme-toggle {
    background: #1a2430;
    border: 1px solid #2a3a4a;
    color: #8899aa;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 11px;
    padding: 5px 12px;
    border-radius: 4px;
    cursor: pointer;
  }
  .theme-toggle:hover { background: #243040; color: #b0c0d0; }

  .version-stamp {
    position: fixed;
    top: 38px;
    right: 16px;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 9px;
    color: #2a3a4a;
    z-index: 200;
    text-align: right;
  }
  body.light-theme .version-stamp { color: #c0c0c0; }

  body.light-theme { background: #ffffff; color: #333; }
  body.light-theme h1 { color: #111; }
  body.light-theme .subtitle { color: #555; }
  body.light-theme .legend { background: #f0f0f0; border-color: #ccc; }
  body.light-theme .legend-item { color: #555; }
  body.light-theme .tooltip-box { background: #fff; border-color: #bbb; color: #333; box-shadow: 0 4px 16px rgba(0,0,0,0.15); }
  body.light-theme .tooltip-box .tt-time { color: #111; }
  body.light-theme .crosshair { background: rgba(0,0,0,0.2); }
  body.light-theme .theme-toggle { background: #e8e8e8; border-color: #ccc; color: #555; }
  body.light-theme .theme-toggle:hover { background: #ddd; color: #333; }

  @media print {
    body { background: #fff !important; color: #333 !important; padding: 4px 16px !important; overflow: visible !important; }
    h1 { color: #111 !important; }
    .subtitle { color: #555 !important; }
    .legend { background: #f5f5f5 !important; border-color: #ccc !important; }
    .legend-item { color: #555 !important; }
    .btn-bar { display: none !important; }
    .version-stamp { display: none !important; }
    .tooltip-box, .crosshair { display: none !important; }
  }
</style>
</head>
<body>

<div class="btn-bar">
  <button class="theme-toggle" id="resetZoom" style="display:none;" onclick="resetZoom()">&#x21BA; Reset Zoom</button>
  <button class="theme-toggle" id="savePng" onclick="savePNG(2)">&#x1F4BE; Save PNG 2x</button>
  <button class="theme-toggle" id="savePng1x" onclick="savePNG(1)">&#x1F4BE; Save PNG 1x</button>
  <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">&#x263C; Light</button>
</div>
<div class="version-stamp" id="versionStamp">v1.0.0 &middot; 2026-02-06</div>

<h1>Overnight Sleep Study</h1>
<div class="subtitle">2026-02-05 22:56 &rarr; 2026-02-06 06:59 &nbsp;&middot;&nbsp; ~8h 02m recording &nbsp;&nbsp; • &nbsp;Apneas &gt;10s: 152, &gt;50s: 0</div>

<div class="legend" id="legendBar">
  <div class="legend-item"><div class="legend-swatch" id="lsw-spo2" style="background:#48b8e8"></div>SpO&#x2082; (%)</div>
  <div class="legend-item"><div class="legend-swatch" id="lsw-hr" style="background:#e85878"></div>Heart Rate (bpm)</div>
  <div class="legend-item"><div class="legend-swatch" id="lsw-hrma" style="background:rgba(255,220,80,0.85)"></div>HR Trend (~5m avg)</div>
  <div class="legend-item"><div class="legend-swatch" id="lsw-resp" style="background:#58d888"></div>Resp. Rate (br/min)</div>
  <div class="legend-item"><div class="legend-swatch bar" id="lsw-apnea" style="background:rgba(255,80,60,0.5)"></div>Apnea Event</div>
  <div class="legend-item"><div class="legend-swatch bar" id="lsw-apnealong" style="background:rgba(255,220,40,0.8)"></div>Apnea &gt;50s</div>
  <div class="legend-item"><div class="legend-swatch dot" id="lsw-omod" style="background:#f0a030"></div>Obstruction (mod)</div>
  <div class="legend-item"><div class="legend-swatch dot" id="lsw-osev" style="background:#ff4040"></div>Obstruction (sev)</div>
  <div class="legend-item"><div class="legend-swatch bar" id="lsw-mot" style="background:rgba(160,140,220,0.5)"></div>Motion</div>
  <div class="legend-item"><div class="legend-swatch" id="lsw-good" style="background:rgba(80,200,120,0.5); border-top: 2px dotted rgba(80,200,120,0.8); height:0; width:18px;"></div>Restful (&ge;15m)</div>
</div>

<div class="chart-container" id="chartArea">
  <canvas id="mainCanvas"></canvas>
  <div class="crosshair" id="crosshair"></div>
  <div class="tooltip-box" id="tooltip"></div>
</div>

<script>
// ============================================================
// DATA (minutes since midnight of recording start date)
// ============================================================
const RAW = {"sleepU":{"t0":1376.6833,"dt":0.066667,"spo2":[97,97,98,98,98,98,98,98,98,98,98,98,97,98,98,98,98,98,98,98,99,99,99,98,98,98,98,98,98,97,97,96,97,97,97,97,97,97,98,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,98,99,99,99,99,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,98,98,98,98,97,97,97,97,97,97,97,97,97,97,96,98,97,97,97,97,96,96,97,97,97,97,97,98,98,98,98,98,98,98,97,97,96,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,96,96,97,98,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,97,97,98,98,98,98,98,98,97,96,95,95,95,94,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,94,94,94,95,95,95,94,94,94,94,96,98,98,98,98,98,97,96,95,96,95,95,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,95,97,97,97,96,96,97,98,98,97,97,96,96,96,96,95,94,93,93,93,94,94,94,94,94,93,92,92,92,92,92,92,92,93,93,92,92,93,93,93,93,93,93,93,93,93,93,92,92,93,93,93,93,94,95,95,95,94,94,94,94,93,93,93,93,93,92,92,93,95,95,93,92,92,92,92,91,92,94,93,93,92,92,91,90,91,92,92,92,92,94,95,95,95,95,95,95,95,95,95,95,96,95,95,95,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,98,98,98,98,98,97,97,98,98,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,98,98,98,98,98,98,98,98,98,98,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,99,99,99,99,99,98,98,98,98,98,98,98,98,98,98,97,97,97,98,98,97,97,97,97,98,98,98,98,98,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,98,97,97,97,97,98,98,99,99,99,99,99,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,98,98,98,99,99,99,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,98,98,98,97,97,97,97,97,97,97,97,98,98,98,98,97,97,97,97,97,98,98,98,97,97,97,97,97,97,97,97,97,97,98,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,97,97,97,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,96,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,97,97,98,98,97,97,97,97,97,97,97,97,97,98,98,98,98,98,97,97,97,98,98,98,98,98,98,98,98,98,98,97,98,98,97,97,97,97,97,97,98,98,97,97,98,97,97,97,96,96,96,96,96,96,96,97,97,98,98,98,98,97,97,97,97,97,97,97,97,97,96,96,96,97,98,98,98,98,98,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,96,97,96,96,96,96,96,96,96,96,96,96,97,97,97,96,96,96,96,96,96,96,96,97,98,97,97,97,97,96,96,97,98,98,98,98,98,97,97,97,97,96,97,98,98,98,97,97,97,97,96,96,95,95,95,98,98,98,98,98,98,97,97,96,96,96,96,95,97,98,98,98,98,98,98,98,97,97,97,97,97,96,96,96,97,98,98,97,96,96,95,95,94,94,98,99,99,98,98,98,98,98,97,97,97,97,98,97,97,98,98,98,98,98,98,98,98,98,98,98,98,97,96,97,96,96,96,96,96,97,97,97,96,96,96,96,95,94,97,97,95,94,94,94,92,91,93,99,99,98,98,98,97,97,96,96,96,96,94,97,99,98,98,98,98,97,97,97,98,97,96,96,96,96,95,94,97,99,98,98,98,98,98,98,98,97,97,97,96,96,97,96,96,98,98,98,98,97,97,97,97,96,96,96,96,96,96,96,95,94,96,98,98,98,98,98,98,97,96,96,96,96,95,95,99,98,98,98,98,98,98,97,97,98,98,97,97,97,96,96,96,97,97,96,96,97,98,98,97,97,96,96,96,95,95,95,98,98,98,97,96,94,93,93,93,92,91,96,99,99,98,98,98,98,98,97,96,97,98,98,98,98,98,98,97,97,98,98,97,97,98,97,96,96,97,97,97,96,96,96,97,96,96,96,96,96,96,96,96,95,96,96,96,96,96,96,97,97,96,96,96,96,95,96,96,96,96,96,96,96,95,95,95,95,96,98,98,98,98,98,98,98,98,98,98,99,99,99,98,98,98,98,97,97,97,98,98,98,98,98,98,98,98,98,97,97,97,98,98,97,97,97,97,97,97,97,98,98,98,98,97,97,97,96,96,96,96,96,96,96,96,96,96,96,97,98,98,97,97,97,97,96,96,96,96,96,97,98,97,97,98,98,97,97,97,97,96,96,96,96,96,96,96,96,97,98,98,97,97,96,96,95,94,95,98,98,98,98,97,97,96,96,96,96,96,95,95,98,98,98,97,96,96,96,95,94,96,98,98,98,97,96,96,97,98,98,98,97,97,96,96,96,95,95,94,96,98,98,97,96,96,96,95,94,94,96,98,98,98,98,98,97,98,97,96,95,95,96,98,98,98,98,97,96,96,96,96,96,95,96,98,98,98,98,98,98,98,97,96,96,97,97,96,96,96,98,98,98,98,97,97,97,96,96,96,97,98,98,98,98,98,98,97,97,97,96,96,97,98,98,98,98,97,97,96,96,96,96,96,96,96,98,98,98,98,98,98,98,97,96,96,96,96,96,96,96,96,99,99,98,98,98,98,98,98,97,97,97,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,98,97,97,97,97,98,98,98,98,98,98,98,97,96,96,96,96,96,97,98,97,97,97,97,96,97,97,97,96,97,98,98,98,97,97,96,96,96,97,97,96,96,96,98,98,97,97,97,97,96,96,96,96,96,96,96,96,96,95,95,98,98,98,97,96,96,95,95,94,93,92,92,99,98,98,97,97,97,97,96,96,98,98,98,98,98,98,98,98,97,97,98,98,98,97,96,95,95,93,93,98,98,98,97,97,97,97,97,96,96,96,96,98,98,98,98,98,98,97,97,97,97,97,96,96,96,95,96,98,98,98,98,97,97,97,97,96,96,96,96,96,96,97,98,98,98,97,97,96,96,96,96,97,96,98,99,98,98,98,99,99,99,99,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,96,96,96,96,96,96,96,98,98,98,98,98,97,96,97,97,96,96,98,98,98,98,98,98,98,98,97,96,96,96,96,96,96,96,96,95,95,96,98,98,97,96,96,96,97,98,98,97,96,96,96,95,96,99,99,99,98,98,98,97,97,96,96,96,98,98,98,98,98,98,97,96,96,96,97,97,96,96,98,99,99,98,98,98,98,96,96,96,95,94,96,97,97,97,98,99,99,99,99,99,99,98,98,98,98,98,98,98,97,96,96,95,96,98,99,99,99,99,98,98,98,98,98,98,98,97,96,96,95,96,98,99,99,99,98,98,98,97,96,96,95,94,94,98,99,99,99,98,98,99,98,98,98,97,96,95,95,93,92,91,91,91,98,99,99,99,98,98,98,98,97,96,95,94,94,99,99,99,98,98,97,96,95,93,91,91,90,90,95,99,99,98,98,98,98,98,98,96,95,94,92,91,90,90,99,99,99,99,99,99,99,99,98,98,96,95,93,92,90,90,86,86,85,85,90,90,90,99,99,99,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,97,96,96,97,98,98,98,98,98,97,96,96,96,96,96,97,98,98,98,98,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,98,98,98,98,98,97,96,95,95,95,96,97,98,98,98,98,98,97,97,97,97,96,96,96,97,98,98,98,97,96,96,96,96,95,94,94,94,95,95,95,96,98,99,99,99,98,98,96,96,95,95,95,96,98,98,99,99,98,98,98,98,98,96,96,95,95,94,94,94,93,93,97,99,99,99,99,99,99,98,98,96,96,96,96,96,95,94,94,94,94,94,94,94,94,96,98,98,98,98,98,98,98,98,98,97,96,95,94,94,93,92,91,90,89,89,89,88,88,90,90,94,94,94,93,98,99,98,98,98,98,98,98,97,96,96,96,96,95,95,94,94,94,94,94,94,93,93,93,93,93,94,94,94,99,99,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,97,98,98,98,98,99,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,98,98,98,98,98,97,98,97,97,97,97,97,97,97,96,96,97,97,97,96,96,96,96,96,96,96,96,97,97,98,98,97,97,97,97,97,96,96,96,96,95,95,95,96,96,96,96,96,96,96,96,96,96,97,98,98,98,97,97,98,98,97,97,96,96,96,96,96,96,98,98,98,98,98,98,98,98,98,97,97,98,97,96,96,96,96,97,97,97,98,97,97,96,96,96,96,96,95,95,96,97,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,97,96,96,96,96,95,96,97,98,98,98,98,98,98,98,97,97,96,96,96,96,96,96,97,98,98,98,98,98,98,98,97,97,97,97,97,97,97,99,99,98,98,98,97,96,96,96,97,98,98,98,97,97,97,96,96,96,96,95,95,94,97,98,98,98,97,97,97,96,96,96,96,95,95,95,94,94,94,98,98,97,96,96,96,96,96,95,94,93,93,92,96,98,98,96,96,95,95,94,93,92,91,90,90,89,98,98,97,96,96,95,94,94,93,92,91,91,98,98,98,98,98,97,96,96,96,95,94,92,91,90,92,98,98,98,98,97,97,96,96,95,94,94,92,90,90,91,99,99,98,98,96,96,95,94,93,92,92,92,92,89,96,98,99,98,98,98,98,97,96,95,93,92,91,90,90,97,99,98,98,98,98,98,98,98,97,96,96,95,95,95,95,95,99,99,98,98,97,97,96,96,95,94,93,92,93,98,98,98,98,98,97,96,96,95,95,93,92,92,96,98,98,98,98,98,98,98,97,96,96,95,93,94,96,98,98,98,98,97,96,96,95,94,93,92,91,90,96,98,98,98,98,98,97,96,95,94,93,91,90,89,94,98,98,98,98,98,97,96,96,95,95,94,93,91,91,95,98,98,98,98,97,97,96,96,95,95,94,93,93,96,98,98,98,98,98,97,97,96,95,94,93,93,96,98,98,98,98,98,98,97,97,96,95,95,93,92,93,95,98,98,98,98,98,98,98,97,97,97,95,94,96,97,98,98,97,97,96,96,95,95,94,94,94,96,98,97,96,96,96,96,95,94,93,93,92,91,92,95,98,98,97,96,96,96,95,95,94,94,93,93,95,98,98,98,98,98,97,96,96,95,94,94,94,89,93,98,98,98,98,98,97,97,96,96,94,94,94,96,98,98,98,98,98,98,97,97,96,95,94,94,93,96,98,98,98,98,98,97,96,96,95,94,93,92,94,97,98,98,98,98,98,98,97,96,96,96,94,93,93,95,98,98,98,98,98,98,97,96,96,96,96,96,91,95,98,98,98,98,98,98,98,98,97,96,95,94,94,94,94,94,94,99,99,99,99,98,97,97,97,98,98,98,98,98,96,96,95,93,92,93,96,98,98,97,96,96,96,95,95,94,96,99,99,98,98,98,97,96,96,95,94,93,92,94,99,98,98,97,96,96,95,94,93,92,91,91,97,99,98,98,97,96,96,95,93,92,90,89,89,98,99,98,98,97,96,96,94,94,92,90,90,92,99,98,98,97,96,96,95,93,93,91,91,95,98,98,98,97,96,95,94,93,92,90,89,88,96,99,98,98,97,96,95,94,93,91,90,90,97,99,98,96,96,95,94,93,92,91,96,99,98,98,96,95,94,93,91,90,89,97,99,99,98,98,96,96,95,94,93,92,91,97,99,98,98,98,97,96,95,94,92,91,90,88,88,92,99,99,98,97,96,96,95,93,92,91,91,97,99,98,98,97,96,96,95,94,93,92,91,89,87,87,92,99,98,98,97,96,96,95,94,93,93,91,91,94,98,98,98,97,96,96,95,95,94,93,96,98,97,96,96,95,95,94,92,91,90,94,96,96,95,94,93,96,98,97,97,96,96,96,96,93,93,96,99,99,98,97,96,96,96,95,94,94,95,96,96,95,95,95,94,94,94,92,91,91,95,98,97,96,95,95,94,93,93,92,92,90,90,98,99,98,98,97,96,95,94,94,93,94,97,99,99,99,98,98,97,96,96,95,95,96,97,96,95,95,93,92,91,93,98,99,98,98,97,96,96,96,95,93,92,90,94,99,99,98,97,96,95,94,93,91,90,89,88,88,92,99,98,98,97,96,95,94,93,97,99,98,98,98,96,96,95,93,92,90,91,96,99,99,98,98,97,96,96,95,95,95,96,98,98,98,98,98,97,96,96,95,94,93,96,98,98,97,96,96,95,94,93,92,94,96,98,97,96,96,96,96,96,96,95,94,93,92,92,96,98,98,97,97,96,96,95,94,93,93,95,96,96,96,95,94,93,91,90,90,95,98,98,97,97,96,95,94,93,92,94,97,98,98,98,97,96,95,95,95,96,96,96,95,94,92,92,92,92,92,92,92,99,98,98,98,98,98,96,96,96,96,98,98,98,97,96,95,94,95,96,98,97,97,96,96,95,95,96,96,96,96,95,94,94,96,97,96,96,95,93,92,91,91,96,98,98,97,96,95,94,94,95,96,97,96,96,95,94,93,93,95,97,96,96,95,94,93,96,97,96,95,94,93,93,91,90,96,98,98,97,96,96,95,94,96,98,98,97,96,96,95,94,92,91,94,98,98,98,97,96,95,95,94,93,92,96,98,98,98,96,96,95,94,93,91,90,90,96,98,98,98,98,97,96,95,94,93,92,91,94,98,98,98,98,97,96,96,95,94,94,92,90,90,90,90,98,99,99,98,98,98,98,97,96,96,96,96,97,98,98,98,98,98,97,97,96,96,97,98,98,98,97,97,96,96,96,95,95,96,97,98,97,97,96,96,95,95,94,93,96,98,98,97,97,96,96,95,95,94,93,93,95,98,97,97,98,97,97,96,96,95,95,96,96,97,97,97,97,96,96,95,95,94,93,93,93,93,99,99,99,98,98,97,96,95,94,96,97,98,98,98,97,96,96,95,95,94,93,93,96,98,98,98,98,97,96,96,95,94,93,92,91,94,98,98,98,98,98,98,98,98,98,98,96,96,95,96,96,98,98,98,97,96,96,96,95,94,93,92,92,96,98,98,98,98,98,98,97,96,96,96,95,95,94,94,96,98,98,98,97,96,96,96,95,95,94,96,98,98,97,96,96,95,94,93,93,93,93,93,96,99,99,98,98,98,98,98,98,98,97,97,97,98,98,98,98,98,98,97,97,96,97,97,98,98,98,97,97,96,96,96,96,96,96,96,96,95,95,95,95,95,94,94,94,94,96,97,97,97,97,96,96,95,95,94,94,93,93,92,92,95,97,98,98,98,98,98,97,96,96,95,94,94,93,94,94,95,96,97,98,98,98,98,97,96,96,95,94,94,93,92,92,92,92,92,94,97,97,98,98,98,98,97,96,95,95,94,94,95,96,97,97,96,96,96,95,95,96,96,96,96,95,95,95,95,95,94,93,93,93,93,94,94,92,92,95,96,97,97,97,97,96,95,95,94,93,92,97,96,96,95,95,95,94,95,95,95,94,93,93,91,91,91,90,89,88,87,87,86,95,95,94,94,93,93,92,92,91,90,89,89,88,92,92,92,92,92,91,93,94,95,95,94,94,93,92,92,93,93,93,92,92,93,93,93,93,93,93,93,93,94,94,98,99,98,98,98,98,98,98,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,96,96,96,96,95,95,95,95,95,96,97,97,98,98,98,98,97,97,96,96,96,96,95,95,95,95,95,95,96,97,97,98,98,97,97,97,96,96,96,95,95,95,96,97,98,98,98,97,97,96,96,96,96,95,95,95,95,96,96,96,96,96,97,97,97,97,96,96,96,96,96,97,98,98,98,97,97,96,96,95,95,95,94,94,94,94,94,93,98,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,97,97,97,97,98,98,98,97,97,96,96,96,96,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,97,98,98,97,97,98,98,98,98,98,98,98,98,98,98,98,97,97,98,98,98,98,97,97,97,97,97,97,97,97,98,98,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,96,96,96,97,97,97,97,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,97,97,97,97,97,97,97,99,98,98,98,98,98,98,97,97,97,97,97,97,98,98,97,97,97,97,96,97,97,96,96,97,96,97,97,96,97,97,97,96,96,96,96,97,97,97,97,97,97,97,96,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,96,96,96,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,98,98,98,97,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,98,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,98,97,97,97,97,97,97,97,97,97,96,96,96,97,97,97,97,97,97,97,97,97,97,96,96,96,97,97,97,97,98,97,97,97,97,97,97,97,97,97,97,97,96,96,96,96,96,96,97,97,97,97,97,97,97,98,98,98,98,98,97,97,97,97,97,96,96,96,96,96,96,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,97,97,97,97,97,97,97,97,97,97,97,96,96,96,96,96,96,97,97,97,97,97,97,96,96,96,96,96,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,96,97,97,97,97,97,97,97,97,97,97,96,96,96,96,97,97,97,97,97,97,97,96,96,96,96,96,97,97,97,97,97,96,96,96,96,97,97,97,96,96,96,96,96,96,97,97,97,97,96,96,96,96,96,96,97,97,97,97,97,96,97,97,97,97,97,97,97,97,96,96,96,96,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,98,98,98,99,99,99,98,98,98,98,98,98,98,98,99,99,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,99,99,99,98,98,98,98,98,97,97,97,97,97,97,96,96,96,96,96,96,96,96,96,96,97,97,98,97,96,96,96,96,96,96,96,97,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,98,97,97,97,97,96,97,97,97,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,98,98,98,98,98,98,97,98,98,97,97,98,97,97,97,97,97,97,97,96,97,97,97,97,97,97,97,97,97,97,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,97,97,97,97,97,97,98,97,97,97,97,96,96,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,96,96,97,96,96,96,96,96,96,97,97,97,97,97,97,97,97,97,96,97,96,96,96,97,96,96,96,96,96,96,96,96,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,96,96,96,96,96,96,96,96,96,96,97,97,97,98,98,97,97,97,98,98,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,98,97,97,97,97,98,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,96,96,96,97,97,97,97,97,97,97,97,97,97,97,97,97,96,96,96,96,96,96,96,96,97,97,96,96,96,96,96,96,96,96,96,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,96,96,96,96,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,96,97,97,97,97,97,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,96,96,96,96,96,96,96,96,95,95,95,96,96,96,97,98,98,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,96,96,97,97,97,96,96,96,96,97,97,97,97,97,97,97,97,96,96,96,96,96,96,97,97,97,97,97,97,96,97,97,98,98,98,98,98,98,98,98,98,98,98,99,99,99,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,97,97,97,96,95,95,96,97,97,97,97,96,96,96,96,96,96,97,97,97,97,97,96,96,96,96,96,96,98,98,98,98,97,97,96,96,96,96,94,96,96,97,97,97,97,96,96,96,94,94,94,94,94,94,94,98,98,98,97,97,96,96,96,96,96,96,96,98,98,97,97,97,96,96,96,96,96,96,96,96,97,97,97,98,97,97,97,97,97,97,97,97,98,98,97,97,97,96,96,96,96,96,96,96,96,97,97,98,98,98,97,97,97,97,97,97,97,97,97,97,96,96,96,96,96,96,96,96,96,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,98,97,97,97,97,97,97,97,98,98,98,97,97,97,97,97,97,97,97,98,98,97,97,97,97,96,96,96,96,96,98,98,97,97,96,96,96,96,96,96,96,96,96,96,96,96,97,97,97,97,97,96,96,96,96,96,98,97,97,97,97,97,96,95,95,95,95,95,95,95,98,98,97,97,97,97,96,96,95,95,95,95,95,95,95,90,97,99,98,98,98,98,98,98,98,97,97,97,98,98,98,98,97,97,96,96,96,95,95,94,94,96,98,98,98,98,98,98,97,97,96,96,96,97,98,98,98,98,98,98,97,96,96,97,97,97,97,96,96,96,96,96,97,97,97,97,96,96,96,95,96,97,98,97,97,97,96,96,95,95,95,96,97,98,97,97,96,96,96,97,98,98,97,97,96,96,96,96,95,95,95,96,97,97,97,96,96,95,95,95,96,98,97,98,97,97,97,97,98,97,96,96,96,96,95,94,94,96,98,98,97,97,97,96,96,95,94,94,92,92,95,99,99,98,98,98,98,98,98,97,97,98,98,98,98,97,97,97,97,97,97,97,96,96,96,96,96,96,96,95,96,96,97,96,96,96,96,95,95,96,96,96,96,95,95,96,98,98,97,96,95,94,93,92,91,91,92,97,98,98,97,97,96,96,95,95,96,97,98,98,98,97,96,96,95,94,94,94,96,98,98,98,98,97,97,96,96,96,97,98,98,98,98,97,96,96,95,95,94,97,98,98,97,96,96,95,95,95,93,94,96,98,98,98,98,97,97,96,96,96,97,97,96,96,95,95,94,93,92,92,96,98,98,98,97,97,96,96,95,94,93,93,92,95,98,98,98,98,97,97,96,96,96,95,94,93,93,95,98,98,98,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,96,96,96,96,97,97,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,95,95,95,94,94,95,95,96,96,96,96,96,96,96,96,95,96,96,96,96,96,96,96,97,97,97,97,96,96,95,95,95,94,94,96,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,96,97,97,98,98,98,98,98,97,97,97,97,96,96,96,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,97,96,96,96,96,96,96,97,98,98,98,97,98,98,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,95,95,95,96,96,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,96,94,93,93,94,94,94,94,94,94,94,95,96,97,97,96,96,95,95,96,96,95,95,95,95,95,95,95,96,96,97,98,97,96,95,95,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,95,95,95,95,95,95,95,95,94,94,94,95,95,95,95,95,96,98,98,98,98,98,98,97,97,96,97,97,97,97,97,97,98,98,98,98,97,96,96,96,96,96,96,96,96,96,98,98,98,98,98,98,98,98,97,97,97,97,97,98,97,96,95,94,94,93,93,93,93,93,93,93,93,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,95,98,99,99,98,98,98,98,98,97,97,97,97,97,97,97,98,98,98,98,98,98,97,97,97,96,96,95,95,95,95,95,95,98,98,98,97,97,96,96,95,95,95,95,95,95,98,99,99,98,98,98,98,98,98,98,98,97,97,96,96,96,96,96,96,96,96,95,95,95,95,95,95,95,95,95,95,95,95,95,95,96,97,97,98,98,98,97,97,96,96,96,96,96,96,96,96,96,97,98,98,98,98,98,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,96,96,96,96,96,96,98,98,97,96,96,95,95,95,95,95,95,96,98,99,99,99,98,98,98,98,97,96,96,97,97,98,97,97,96,96,96,96,96,96,96,95,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,95,95,96,95,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,96,95,96,96,96,96,95,95,95,95,95,96,96,95,95,95,95,95,95,95,95,94,95,95,95,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,95,95,95,95,95,95,96,96,96,96,96,97,96,96,96,96,95,95,96,96,95,95,95,95,96,96,97,97,96,96,96,95,95,95,95,96,95,96,97,98,97,96,96,96,96,96,96,96,96,96,96,96,95,95,96,95,95,96,97,96,96,95,95,95,94,94,95,95,95,95,96,96,96,95,95,94,94,94,94,94,96,97,98,98,98,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,96,96,96,96,96,96,96,95,96,96,96,96,96,96,95,95,95,95,94,95,96,97,97,96,97,96,96,96,96,96,96,96,96,96,96,96,95,94,96,98,97,96,98,98,96,96,96,95,94,94,94,94,94,96,97,97,96,96,96,96,96,95,95,95,94,94,96,97,97,96,96,96,96,96,96,95,95,95,94,94,95,96,96,96,95,94,94,94,94,94,96,99,98,97,98,98,98,98,97,97,96,96,97,98,98,98,98,97,97,97,97,97,97,97,96,96,96,96,96,96,97,98,98,97,97,97,96,96,96,96,97,97,97,96,96,96,96,96,96,96,97,97,97,97,96,96,96,96,96,96,96,97,97,97,97,96,96,96,95,95,95,95,94,98,99,98,98,98,98,98,98,98,97,97,96,96,96,96,97,97,96,97,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,97,97,97,96,96,96,96,96,96,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,95,95,95,96,96,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,97,97,97,97,97,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,98,98,97,97,96,96,96,96,96,96,96,97,98,98,98,98,98,98,98,97,97,97,97,97,98,98,97,97,97,97,98,98,98,97,97,97,97,97,98,97,97,97,98,98,97,97,97,98,98,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,99,98,98,98,98,98,98,97,97,97,97,97,97,97,97,96,96,97,97,97,97,97,97,96,96,96,96,96,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,97,97,97,97,97,97,97,98,98,97,97,97,98,97,97,97,97,98,98,97,97,98,98,98,98,97,97,97,97,97,97,97,97,97,97,97,null],"hr":[76,76,77,77,76,76,76,77,76,74,76,77,78,77,75,75,75,75,75,76,76,75,75,77,78,78,77,76,75,74,74,75,74,73,73,73,74,74,73,74,74,74,74,74,73,74,74,74,74,75,74,73,74,75,74,72,73,73,73,73,74,74,75,75,74,74,75,76,75,76,76,77,76,75,74,76,76,76,75,75,76,75,75,75,75,75,75,74,74,73,74,75,75,74,75,75,75,75,74,75,74,74,74,76,76,76,76,76,75,75,76,76,78,78,78,77,77,76,76,76,76,76,76,76,76,75,74,74,74,75,76,76,75,76,76,77,76,75,75,75,75,75,76,75,73,73,74,75,76,76,76,76,73,85,84,81,77,76,77,76,75,76,78,78,77,76,76,76,76,75,75,76,76,76,77,78,79,78,78,78,77,75,74,75,75,74,75,75,76,76,75,75,75,75,75,75,75,76,76,76,76,77,76,75,75,75,76,76,76,76,75,74,74,75,75,73,73,73,74,73,73,73,74,73,73,73,74,73,75,75,75,74,73,73,73,72,72,74,74,77,77,77,77,77,77,77,77,77,75,75,75,75,75,75,76,76,76,77,76,76,77,77,77,76,75,75,75,78,84,84,84,85,84,79,75,75,76,75,73,73,73,80,80,77,75,75,74,73,72,73,74,74,74,74,75,76,76,75,75,75,75,75,75,76,76,76,76,76,77,77,77,77,77,78,76,75,77,78,78,79,79,79,78,77,76,77,77,76,76,77,76,78,78,78,80,82,81,79,78,79,77,77,77,76,76,76,76,75,75,75,75,75,80,79,75,75,76,76,76,76,76,76,77,76,76,76,76,77,77,77,77,77,86,86,86,86,86,86,86,86,86,86,86,84,84,84,84,84,84,86,87,83,80,76,76,75,75,77,77,76,75,75,75,74,73,73,73,73,74,73,73,74,74,74,74,73,71,71,71,72,72,73,74,73,72,71,71,70,69,68,70,70,69,69,70,71,70,71,73,73,72,70,67,68,70,70,69,68,69,70,68,68,70,71,71,71,72,72,73,73,74,74,74,73,73,73,74,74,74,73,73,72,71,71,71,71,71,71,72,74,74,74,72,70,69,69,72,75,75,75,76,74,72,71,71,70,70,70,71,71,72,73,73,73,73,71,70,72,73,73,71,69,69,70,70,69,69,70,70,71,71,72,72,71,68,68,67,68,67,68,68,69,68,67,67,68,68,67,66,67,67,67,67,66,66,66,67,67,67,67,67,69,70,68,67,71,74,75,75,76,76,75,72,69,67,67,68,67,66,67,67,67,67,65,64,63,64,69,74,77,77,77,73,67,66,66,66,66,66,64,64,65,67,67,67,67,67,79,91,88,83,80,80,78,77,76,73,70,67,67,68,69,67,67,67,68,67,67,69,69,67,63,64,65,64,64,65,66,67,70,71,69,66,67,68,67,66,65,66,68,71,69,65,65,70,75,75,75,75,89,86,84,78,76,73,70,64,63,62,62,63,65,66,64,60,61,63,63,62,61,63,63,63,65,66,65,63,65,66,67,67,66,65,65,65,68,68,68,81,86,80,74,72,70,67,65,63,63,65,67,67,66,65,64,63,64,66,66,64,63,63,64,67,66,64,63,65,65,63,66,70,68,63,64,68,69,67,63,62,63,66,65,62,62,65,65,63,66,70,68,64,66,67,64,61,61,64,68,70,67,62,67,76,79,75,67,63,62,66,64,62,60,62,63,63,63,62,63,64,65,69,74,78,77,73,68,65,65,65,63,60,60,62,66,65,62,59,62,63,61,62,65,64,59,59,62,67,73,77,71,62,60,62,62,61,60,67,66,62,58,60,62,69,77,75,68,61,62,63,65,64,61,60,62,63,62,64,68,67,63,61,64,65,66,65,64,62,61,60,60,62,69,77,81,76,69,63,62,62,62,61,66,68,67,64,67,70,69,70,71,68,62,62,64,66,68,66,63,64,67,68,70,77,78,70,63,61,62,63,63,63,64,64,64,64,65,63,62,66,76,78,75,75,78,76,69,62,61,64,66,64,64,66,64,61,62,61,61,64,65,65,63,61,60,61,63,64,64,64,63,63,66,71,73,71,68,67,64,63,64,64,63,62,63,64,66,71,71,66,64,66,66,65,65,69,75,81,75,67,64,66,65,63,62,64,64,68,75,79,73,64,61,62,64,63,62,62,69,79,82,81,71,65,65,66,65,63,63,65,65,65,69,78,82,75,65,61,60,61,59,60,63,65,66,66,65,66,70,75,77,74,68,66,66,65,65,68,77,82,82,77,73,66,64,63,61,60,62,65,66,63,62,64,66,65,62,62,65,66,65,66,67,67,64,62,62,64,66,67,64,64,65,66,66,67,66,66,67,69,68,67,69,72,70,63,61,64,67,67,71,78,85,83,76,68,62,61,63,64,66,67,68,72,80,84,81,72,66,64,63,63,65,64,64,68,68,65,63,67,66,74,84,81,74,67,62,63,64,63,63,63,66,65,66,65,66,69,73,75,72,68,65,66,66,65,63,65,71,72,66,63,64,67,70,72,76,80,78,74,70,67,64,66,69,67,64,69,76,81,83,80,70,63,63,62,63,63,68,68,63,61,65,67,65,64,63,63,69,72,78,83,83,79,70,67,65,66,65,68,72,74,72,72,69,66,66,67,64,64,60,72,72,72,78,96,102,97,86,77,68,63,64,73,81,82,81,81,76,69,65,71,71,65,65,71,68,63,66,72,70,63,61,64,70,72,68,61,62,66,67,66,65,65,66,68,68,65,64,69,78,84,79,69,63,62,63,64,67,69,68,64,62,64,67,67,64,63,70,80,82,76,67,62,61,64,66,68,69,69,75,78,87,97,92,87,83,74,65,65,71,70,65,63,67,68,68,66,63,62,67,71,68,64,60,64,69,67,63,63,63,77,79,79,71,64,62,63,63,68,69,66,63,64,66,65,64,65,70,77,82,80,74,64,63,64,64,64,64,64,68,70,67,63,66,71,70,63,61,64,67,68,65,63,63,64,65,68,74,80,85,78,72,67,71,70,67,66,73,79,77,69,65,65,65,68,67,66,64,65,69,74,78,74,65,64,66,66,65,64,67,77,81,76,66,64,66,69,70,71,69,66,63,66,68,67,64,63,66,73,81,86,80,68,63,64,64,63,64,72,82,81,74,66,66,65,64,64,63,65,69,74,74,75,77,75,70,65,64,65,65,64,66,74,84,88,85,74,68,65,64,65,64,64,64,66,67,69,70,73,79,85,81,71,66,65,67,68,69,73,80,87,87,80,68,62,63,63,63,64,67,71,83,86,82,74,68,66,66,66,64,63,64,67,72,78,86,91,91,88,78,69,63,63,65,64,63,66,69,72,73,73,73,73,73,73,91,87,78,73,69,66,68,74,78,75,70,67,68,73,74,77,78,74,68,65,66,71,72,69,64,64,69,70,72,73,69,69,77,84,78,69,67,69,70,70,72,69,64,63,66,66,66,66,65,65,66,70,77,79,71,65,66,68,68,66,64,64,64,67,73,82,86,82,75,69,69,70,68,67,66,66,67,70,69,67,67,73,80,86,84,76,70,69,68,65,64,65,67,77,83,86,79,68,64,65,67,67,68,68,69,87,88,82,75,69,67,68,68,70,72,71,65,63,66,67,67,73,84,87,82,74,67,65,69,69,68,67,68,73,82,84,83,79,74,68,66,66,66,66,65,66,67,68,68,74,82,88,89,86,75,69,68,69,71,72,71,69,67,70,77,85,90,87,80,72,67,67,67,67,73,78,81,81,90,99,98,93,90,90,90,95,93,93,90,82,72,67,69,72,69,65,66,67,71,72,71,69,69,69,71,71,71,70,71,71,70,70,75,83,86,84,77,70,67,69,70,70,68,70,73,73,67,64,65,69,72,71,68,64,65,69,69,68,68,72,69,65,67,68,67,63,67,68,67,69,75,73,68,66,67,67,68,69,74,78,74,70,72,70,67,67,67,67,72,79,85,85,77,70,65,65,66,65,68,69,68,66,69,77,80,83,81,73,66,65,66,67,67,67,68,67,70,74,72,68,76,79,79,79,82,96,93,82,72,70,77,84,82,71,67,66,67,68,71,76,81,87,87,83,75,69,67,68,69,71,71,69,67,67,68,73,79,87,87,86,78,70,65,66,69,71,70,68,69,77,79,78,71,69,74,75,72,66,67,70,71,70,68,68,67,65,67,74,80,86,87,83,74,68,68,71,71,71,71,72,72,77,82,79,72,71,72,69,66,66,66,66,68,72,84,87,85,83,86,84,77,74,74,67,67,71,77,77,74,75,83,90,84,78,78,79,83,88,89,82,75,70,68,67,68,69,70,70,69,69,73,91,93,89,87,87,87,99,99,98,95,91,85,81,81,82,82,83,85,87,88,85,80,78,78,78,79,81,81,76,74,73,69,65,65,68,72,78,82,82,83,80,74,69,70,72,71,69,71,72,73,76,78,77,76,78,79,79,81,82,81,80,84,83,76,68,67,69,71,75,78,77,74,72,72,71,69,72,75,77,77,79,81,82,81,81,80,76,71,71,74,76,77,75,74,71,71,75,79,84,86,82,79,79,77,69,64,65,68,70,72,76,79,79,80,79,76,77,79,75,66,62,64,68,70,68,66,66,68,68,68,68,86,88,81,74,73,72,68,64,63,65,66,64,62,63,64,64,64,65,65,66,69,73,76,79,78,77,78,79,74,72,73,74,71,68,69,71,72,71,71,71,72,73,74,72,70,71,74,76,77,78,79,90,97,92,86,83,84,83,81,79,76,74,72,73,73,72,71,71,70,71,71,71,71,71,71,73,77,78,79,85,93,95,90,89,91,93,92,91,90,87,83,84,85,84,79,75,76,77,76,77,78,79,78,76,74,73,74,73,73,72,75,76,74,74,74,85,90,89,85,83,79,74,73,73,70,70,72,73,74,76,75,73,70,72,73,72,69,71,72,71,71,71,71,72,72,72,73,73,74,74,73,70,71,73,74,73,72,70,72,76,74,74,73,72,69,69,69,69,68,69,70,71,70,70,70,71,74,75,73,68,68,68,68,69,71,73,77,79,86,86,81,77,74,72,71,72,71,71,70,70,72,77,79,79,77,73,70,69,69,69,67,67,68,71,72,71,71,72,73,72,72,77,81,80,76,73,72,73,74,74,73,74,74,80,92,90,86,80,71,66,65,67,69,69,69,69,70,72,72,72,72,75,78,78,73,70,69,70,69,68,70,73,74,73,69,71,77,83,86,81,75,70,69,70,69,68,68,70,71,69,69,70,77,85,84,79,71,68,67,67,68,71,74,76,77,80,80,80,80,80,80,92,85,74,68,69,73,75,80,82,76,70,69,70,69,68,68,69,69,67,69,74,76,72,67,67,69,69,67,65,67,69,71,70,70,71,71,79,87,88,84,75,68,66,66,68,68,67,68,69,71,76,76,71,68,69,70,68,67,67,69,69,70,72,81,86,80,71,67,68,69,68,67,69,70,71,78,87,84,76,68,65,66,66,66,66,68,69,69,68,68,75,83,83,81,77,73,71,69,68,67,67,68,69,71,71,85,89,82,71,65,66,68,67,64,63,66,67,67,69,69,69,69,75,96,97,88,75,71,72,72,70,69,70,71,77,82,82,77,77,76,74,69,67,67,66,67,68,69,69,69,70,70,70,70,70,83,77,71,71,72,71,69,71,76,79,83,86,81,74,67,67,69,70,68,69,72,73,73,81,83,84,82,77,71,67,66,70,71,69,69,69,72,78,86,86,79,71,67,68,68,69,70,72,72,73,80,86,90,84,75,69,67,68,68,68,69,70,72,72,74,80,85,85,85,81,80,71,69,69,70,70,72,76,78,79,83,89,84,77,69,69,70,70,69,72,74,73,72,75,80,84,88,90,84,76,73,73,72,71,70,71,75,79,82,81,79,74,70,68,68,70,70,70,71,72,73,73,82,83,85,89,90,83,77,70,68,70,72,73,72,72,85,85,84,80,75,72,71,71,72,73,74,78,83,88,87,78,70,67,66,66,67,69,71,70,70,72,77,86,84,78,71,68,69,68,68,68,69,70,70,77,87,84,79,74,72,71,72,72,72,73,72,73,73,73,73,83,79,74,70,69,68,68,70,71,70,69,72,84,82,82,81,78,75,74,74,73,71,72,72,81,87,89,83,74,71,71,71,70,70,71,71,71,74,78,83,82,81,75,70,67,69,70,68,67,68,70,72,72,82,85,82,80,75,71,69,69,69,68,69,71,72,72,72,72,90,88,83,82,84,83,80,75,72,71,70,70,71,72,72,72,72,72,72,84,96,87,76,74,78,78,75,70,70,69,69,70,70,69,71,82,88,81,73,67,67,68,70,71,76,82,88,87,80,76,73,71,69,70,71,69,68,73,83,88,87,78,71,68,68,69,71,71,70,70,74,84,86,81,74,72,71,71,70,71,71,71,71,77,85,88,83,77,74,72,70,70,72,72,71,71,79,86,81,75,71,72,73,73,71,69,70,75,83,89,86,81,78,74,72,74,74,73,74,76,82,85,84,77,70,70,72,75,74,72,73,74,77,82,83,80,77,75,74,73,74,75,81,85,85,82,76,74,76,78,76,75,75,77,82,85,81,78,74,75,77,77,74,73,75,81,86,85,81,75,73,73,74,74,74,76,74,74,77,79,82,88,85,79,75,76,78,76,76,78,78,83,85,87,86,81,76,72,73,76,78,77,76,77,79,79,79,84,88,85,79,75,75,74,73,75,76,75,77,79,81,91,94,92,86,82,82,81,76,76,79,87,88,85,79,75,72,72,73,75,75,77,81,80,75,76,77,79,82,87,79,75,73,74,75,74,73,75,75,93,94,94,91,86,81,81,78,77,83,87,87,81,83,80,75,72,74,76,75,74,74,89,92,86,77,73,72,71,71,72,73,74,76,79,79,88,82,80,77,77,78,79,76,80,86,92,93,95,92,85,76,74,76,78,76,76,79,78,74,72,74,75,78,79,87,91,88,80,75,74,76,75,75,76,77,78,79,82,87,88,85,77,77,77,77,74,75,78,78,78,83,89,88,80,76,77,77,74,74,78,84,87,83,84,81,76,73,76,77,76,78,82,87,92,94,94,94,88,80,77,77,79,83,83,85,87,90,85,80,75,74,74,77,80,78,82,85,86,80,75,73,77,77,76,76,79,86,92,87,80,75,76,80,80,77,79,78,75,74,81,87,90,90,87,81,76,77,79,78,77,77,79,83,82,80,79,80,79,77,77,78,83,86,84,81,79,79,76,76,74,77,83,89,90,87,84,80,78,79,79,78,81,83,79,78,78,80,82,85,90,91,91,91,91,91,91,115,109,95,82,77,77,79,81,89,87,81,74,70,70,71,76,81,88,85,77,73,73,74,76,76,75,75,76,76,78,82,82,80,76,76,78,79,76,77,84,84,79,74,76,80,76,74,74,79,81,77,74,72,74,74,78,78,78,77,73,72,75,79,81,83,75,74,79,80,80,79,84,87,91,84,81,79,82,79,76,77,79,75,71,71,73,74,75,75,77,82,87,89,84,79,78,78,77,73,74,80,85,90,85,79,74,75,80,82,80,80,80,84,90,93,94,89,81,74,72,73,73,73,73,74,81,86,90,91,89,82,75,75,77,78,78,78,81,83,87,91,92,92,92,100,102,103,95,85,80,84,85,87,90,96,97,94,88,81,76,77,77,77,81,86,87,85,83,82,81,81,79,80,83,87,90,91,86,80,77,76,77,78,79,79,84,88,88,82,78,78,79,79,78,79,81,85,89,92,93,91,86,79,74,75,78,81,83,83,87,92,96,94,86,77,75,77,77,76,77,81,84,88,88,88,88,103,105,103,93,83,79,78,81,84,83,79,71,70,73,76,76,76,75,75,80,86,90,90,85,80,75,74,76,75,77,78,77,81,88,92,91,88,82,76,77,82,85,83,79,78,78,80,82,87,90,89,80,74,73,75,74,74,74,75,76,82,86,89,89,92,93,86,78,74,75,75,75,74,75,76,79,82,84,81,77,73,74,75,75,74,78,84,88,92,91,85,76,75,76,76,75,75,78,79,79,79,79,91,102,97,91,83,77,74,74,75,76,73,73,78,82,84,80,74,73,74,75,76,78,77,76,76,75,75,76,76,76,78,78,76,76,78,81,80,79,77,75,75,77,82,82,80,75,74,74,72,72,73,74,74,72,71,72,74,79,86,88,83,80,81,82,77,73,72,73,76,79,78,79,80,82,84,83,81,79,79,79,82,81,75,71,74,77,78,76,74,74,75,78,83,85,85,86,86,86,83,81,78,77,78,79,81,83,83,86,80,74,72,70,72,75,77,80,82,81,77,75,77,80,80,80,77,76,77,80,79,79,80,82,78,81,87,85,85,87,85,82,79,80,82,83,83,83,80,75,74,74,78,80,81,79,78,79,82,82,81,79,78,77,74,71,73,75,77,80,80,80,81,82,80,79,81,80,79,79,81,81,81,81,81,82,83,85,85,85,85,85,84,86,87,85,84,86,86,85,84,83,83,81,82,82,81,81,81,82,82,82,82,91,115,120,114,107,103,99,92,86,84,84,83,82,78,75,75,77,80,82,81,79,78,78,78,78,77,76,75,76,76,75,77,80,82,80,80,82,86,90,90,89,83,77,75,76,75,74,75,75,74,74,73,74,74,74,75,80,82,80,77,77,76,75,76,78,80,81,79,77,79,84,85,85,81,78,78,78,74,70,72,73,73,71,71,72,72,75,76,78,82,81,79,76,75,74,75,77,80,82,83,79,77,78,80,80,82,82,82,80,78,77,75,73,71,73,76,76,76,76,79,100,101,101,99,98,96,94,92,91,89,88,84,82,83,85,88,89,90,90,91,91,91,91,90,92,94,94,92,87,83,81,82,82,80,79,79,80,80,80,80,79,78,79,81,83,85,84,83,83,84,83,80,78,80,84,85,86,87,83,80,80,82,82,82,82,80,77,78,81,83,83,85,86,87,87,86,89,92,93,91,91,91,91,90,89,89,89,88,87,88,88,86,86,86,84,80,79,79,79,80,81,82,83,83,85,87,86,84,83,83,81,81,83,83,81,81,80,80,81,83,85,86,87,86,85,84,83,84,85,85,86,88,89,89,89,89,88,87,88,88,86,85,87,87,86,84,86,90,98,103,102,93,87,86,86,85,84,81,81,81,80,80,80,79,80,81,81,82,84,89,88,87,87,87,87,87,96,90,89,85,81,82,82,80,79,81,81,80,80,82,81,81,79,80,78,76,78,78,76,76,77,76,75,77,77,77,78,78,78,79,78,79,81,81,83,83,82,81,81,79,79,80,80,79,77,76,76,76,77,78,80,79,79,78,78,78,79,78,78,77,75,74,75,76,75,75,75,76,77,80,80,80,77,76,75,74,74,75,77,79,80,81,81,81,80,81,80,79,79,79,77,77,77,76,75,77,76,76,76,77,76,75,74,75,74,74,74,75,76,76,77,78,78,77,76,75,74,73,74,76,78,79,79,79,78,78,77,76,76,76,78,79,80,80,80,80,80,79,79,78,77,76,76,76,76,76,77,78,78,79,79,79,79,80,83,83,83,81,81,80,80,80,80,80,80,79,76,74,75,77,78,80,80,80,79,80,79,78,78,78,75,75,77,81,84,86,86,85,85,85,84,84,83,82,80,82,81,79,77,77,76,75,76,77,78,79,80,79,79,81,82,82,82,81,79,78,78,80,79,79,78,78,77,76,76,75,75,76,78,80,79,78,78,79,79,80,79,79,78,78,77,76,75,76,79,81,84,85,85,85,85,85,84,84,84,83,83,82,80,79,78,76,76,78,82,84,85,85,84,82,82,82,82,82,82,81,81,80,79,79,80,81,81,80,79,77,78,78,79,80,81,81,81,79,76,76,77,77,78,81,82,82,81,81,81,79,77,77,77,77,78,81,82,82,82,81,80,79,77,75,75,77,78,80,80,80,79,76,73,73,74,74,74,75,74,73,73,74,75,76,78,76,73,72,73,72,71,73,75,77,76,74,73,74,76,77,78,80,82,81,81,81,79,75,73,73,73,75,76,77,78,78,78,78,78,81,99,94,86,82,77,78,77,75,74,74,72,72,73,73,74,74,75,76,79,79,77,77,75,73,74,73,73,73,75,76,76,77,78,78,77,76,76,76,75,74,74,75,76,78,79,80,80,77,76,73,70,72,75,78,79,80,79,78,77,77,75,75,73,72,71,69,70,74,76,76,76,76,75,75,75,75,75,78,96,92,79,75,75,74,73,71,70,69,69,68,68,69,69,68,66,68,67,68,70,71,73,74,74,72,70,69,69,71,74,77,80,81,80,76,73,72,73,73,74,74,75,75,76,77,75,74,74,73,73,73,73,70,69,69,71,70,71,73,74,74,76,77,77,78,78,77,77,78,77,76,76,76,76,77,77,77,79,81,85,85,83,83,81,79,78,77,77,78,77,77,78,77,76,76,76,77,77,78,78,77,77,78,78,78,78,78,80,84,86,83,80,81,80,78,76,77,77,76,76,76,77,77,77,76,76,76,77,78,78,78,78,78,79,80,79,78,77,77,76,76,75,75,75,75,74,74,74,75,74,74,74,74,76,77,76,76,76,79,83,84,82,83,82,81,79,77,76,75,75,75,75,76,76,78,81,84,85,85,85,84,83,83,83,83,82,80,80,80,79,79,79,81,81,81,79,77,77,79,87,92,90,87,85,84,83,83,84,83,80,78,78,79,81,81,82,82,82,82,82,82,82,82,88,86,83,81,81,81,81,81,81,81,81,86,85,83,81,79,84,86,80,74,73,72,71,71,72,71,71,72,72,73,73,73,74,74,73,72,71,69,68,68,69,69,69,70,70,71,70,72,73,72,71,72,72,72,72,71,72,72,72,72,72,72,72,73,73,74,73,73,73,73,73,73,72,72,70,69,70,71,71,73,73,73,72,74,74,74,74,75,75,75,74,74,75,75,74,73,75,75,75,74,75,76,75,75,76,76,75,74,74,74,75,75,77,77,77,76,75,75,75,76,76,76,76,77,77,76,76,76,76,76,77,78,77,77,76,76,76,75,74,74,75,73,72,73,73,73,74,76,77,76,76,75,74,73,74,74,74,72,72,71,70,71,72,73,73,75,74,72,69,69,72,71,70,69,69,70,68,68,68,68,69,69,69,67,71,70,69,67,70,70,71,70,69,69,70,71,70,69,71,71,70,70,71,72,71,72,72,71,72,74,75,74,72,73,73,71,71,73,73,72,71,72,73,75,74,73,72,72,74,75,75,72,71,72,73,73,74,75,73,70,70,72,70,70,72,74,72,72,72,74,75,77,78,78,75,73,74,75,74,73,74,74,75,74,73,70,72,74,74,73,73,73,73,72,73,73,73,71,73,75,74,74,74,74,74,74,74,74,73,73,73,74,74,74,71,70,71,72,73,73,73,74,74,74,74,72,71,70,71,73,73,73,74,74,73,72,72,73,74,74,72,73,73,75,76,75,74,73,74,73,74,75,75,74,74,73,73,74,75,74,74,75,77,76,74,74,75,76,76,76,75,76,74,74,74,75,75,74,73,73,73,73,73,74,75,73,72,74,75,76,75,75,74,74,74,74,74,74,74,73,73,74,74,75,76,76,75,74,74,74,75,75,75,74,74,74,74,75,75,74,73,74,74,74,73,74,74,73,74,74,74,74,74,74,74,73,74,75,74,74,74,74,75,75,75,75,75,75,76,77,75,74,75,75,74,73,74,75,76,74,74,74,74,74,74,74,75,77,79,81,79,77,75,74,74,75,74,74,73,74,76,76,76,75,77,76,78,78,80,76,73,72,73,74,74,74,74,74,75,77,78,76,72,72,74,74,75,75,76,81,86,90,87,80,74,73,73,72,72,72,74,74,74,73,74,74,74,75,75,75,75,74,73,73,75,75,74,74,75,74,74,75,75,73,73,73,74,75,77,77,76,76,77,74,74,74,74,74,75,76,76,76,75,75,76,77,77,76,75,75,77,78,76,75,74,75,75,75,75,76,77,76,76,77,78,77,79,82,83,81,78,75,74,74,75,76,76,75,76,79,83,86,89,87,80,74,72,73,74,75,76,76,75,75,75,76,75,74,73,75,75,75,75,75,75,76,79,78,75,74,77,81,82,86,84,78,74,75,75,75,75,74,73,72,74,74,73,72,72,72,74,80,85,86,83,78,77,77,82,93,93,93,93,93,93,93,93,90,86,81,73,71,71,72,73,68,69,70,69,68,68,70,72,80,82,82,76,77,77,74,73,74,88,90,84,74,72,72,72,72,73,76,77,77,77,77,75,76,76,75,73,73,73,73,73,73,79,78,78,78,74,70,72,77,78,78,84,90,87,75,74,73,74,73,73,74,74,74,74,74,74,74,74,73,72,72,72,73,73,74,75,75,75,75,75,72,73,74,72,72,75,77,77,77,77,77,77,77,73,73,74,74,74,74,74,74,74,74,80,92,88,80,72,73,74,74,74,74,74,74,74,74,74,77,74,73,74,75,76,76,76,76,76,76,76,75,74,74,75,75,75,75,75,75,75,75,75,73,74,74,74,74,74,74,74,74,74,74,74,74,74,75,74,73,75,74,73,73,73,73,73,73,76,77,77,75,74,75,75,75,75,75,75,77,74,72,72,73,74,75,75,75,75,75,74,73,72,73,74,72,71,73,76,76,77,77,77,77,77,77,73,72,72,75,76,75,75,75,75,75,77,77,77,76,75,74,73,72,72,72,72,72,72,75,74,75,76,73,71,72,76,76,75,75,75,75,75,75,75,81,102,105,98,95,94,90,83,78,78,78,77,74,73,72,74,76,75,74,74,76,77,79,85,89,89,89,89,89,86,82,78,78,79,79,81,85,86,88,89,89,85,79,76,78,80,81,79,76,75,76,78,78,77,78,77,76,75,74,74,75,77,79,80,81,79,77,78,80,79,79,79,79,80,84,88,88,81,77,78,80,82,86,85,80,76,76,78,78,77,76,78,78,77,77,78,76,74,75,78,79,79,81,84,85,81,76,73,80,87,91,88,83,77,75,77,77,77,78,81,84,85,83,79,75,75,76,77,77,78,81,86,86,92,92,95,104,102,98,93,89,85,79,77,78,78,76,76,76,75,74,78,81,78,75,76,79,79,74,73,75,77,77,77,76,75,78,80,79,75,75,79,80,77,73,75,77,81,87,86,79,76,76,77,76,75,75,78,83,89,90,85,75,72,74,75,74,76,78,82,82,82,79,75,76,77,76,76,77,79,84,87,88,82,75,73,76,76,75,75,82,86,85,88,90,83,76,73,75,76,79,81,82,78,77,77,78,77,77,76,75,77,77,89,95,92,85,78,75,77,78,77,78,77,75,74,75,76,76,77,78,82,86,92,92,86,76,73,75,77,77,76,74,74,76,82,84,84,82,82,83,81,75,73,76,77,77,77,78,81,87,90,91,88,86,84,85,88,91,90,88,89,89,85,80,80,83,84,82,79,78,80,82,86,90,90,89,88,85,80,77,79,80,77,75,78,81,79,75,74,76,76,73,71,70,72,72,72,75,81,84,81,74,75,77,76,79,78,78,78,78,76,81,86,89,87,85,83,81,80,81,83,84,84,84,87,90,101,89,89,90,90,91,90,92,91,89,87,86,83,79,79,82,85,86,88,88,88,88,89,89,87,81,77,81,84,84,79,76,78,82,84,83,81,78,76,76,79,81,83,83,79,78,80,81,79,77,80,83,83,89,101,103,100,95,94,93,92,91,91,91,91,91,89,87,86,87,87,88,88,84,81,80,81,83,84,85,85,87,88,84,80,79,81,83,83,83,82,80,80,81,81,79,78,81,85,86,86,88,90,91,90,89,89,89,87,83,81,82,82,80,80,83,85,84,83,80,78,78,79,80,81,82,83,81,79,79,80,81,81,83,82,80,79,79,80,81,81,81,79,78,78,79,78,77,78,77,78,81,82,84,88,90,90,86,80,77,78,79,82,84,84,85,83,79,75,75,78,76,75,74,77,79,78,78,78,79,81,80,76,74,77,80,79,78,78,79,79,78,76,75,73,73,75,78,82,80,77,78,79,79,78,78,79,79,78,79,78,76,74,74,74,74,75,77,78,77,75,75,78,81,84,84,84,84,86,88,87,85,84,79,79,79,80,80,77,76,77,79,84,85,85,84,83,79,77,78,78,79,79,78,76,77,78,81,83,84,85,86,89,90,88,85,81,80,81,80,79,77,77,78,79,81,82,80,76,76,78,81,81,81,80,80,79,78,79,79,79,78,80,82,82,81,81,83,83,83,83,83,85,88,97,91,85,82,81,78,76,75,78,78,79,79,78,75,73,73,77,79,78,76,75,76,77,77,77,77,77,78,77,76,74,74,75,76,77,77,80,79,77,76,77,76,75,76,74,71,71,72,74,74,74,74,74,74,77,74,76,80,83,83,78,77,77,77,77,77,77,77,77,77,77,83,85,83,78,76,76,77,76,76,76,76,76,76,79,88,89,85,84,83,81,80,79,80,80,80,81,82,82,82,82,82,82,86,86,85,82,82,80,76,75,75,75,75,75,75,81,94,88,83,81,81,79,78,78,79,79,79,78,76,74,75,76,75,74,75,78,78,77,77,77,76,75,75,75,75,77,77,77,77,77,83,85,84,82,79,76,77,78,78,80,78,76,76,76,76,76,76,77,78,78,77,76,77,77,77,77,76,77,77,76,77,78,77,76,78,78,78,77,80,81,85,85,82,84,84,83,84,86,90,93,93,91,87,85,82,81,80,79,79,79,79,79,79,79,97,103,99,93,89,85,83,79,79,81,81,78,75,77,79,78,77,78,80,79,76,76,79,83,82,77,73,74,77,79,76,73,75,79,79,76,74,76,79,78,79,83,86,83,79,81,84,82,81,82,86,84,81,78,79,79,77,77,78,78,76,77,79,79,76,75,78,79,77,74,75,78,78,76,76,79,80,75,71,71,74,76,76,75,74,78,80,80,79,79,79,79,77,75,76,77,75,73,73,74,75,75,77,79,81,80,78,78,79,79,86,89,89,84,78,76,76,76,76,76,77,78,78,76,75,78,82,84,81,79,79,82,80,76,75,77,77,77,82,86,86,83,79,78,76,74,73,75,78,78,76,75,78,79,76,71,72,78,81,76,70,71,76,78,75,71,72,76,78,77,77,78,77,74,73,74,76,76,77,77,78,78,78,95,95,93,84,75,74,77,77,76,76,79,80,78,75,76,75,74,74,74,77,84,86,82,78,77,77,76,74,74,75,78,78,76,74,76,78,79,77,76,77,77,76,78,80,83,83,81,77,74,74,75,74,73,74,78,79,78,76,79,80,79,79,82,81,77,75,76,76,74,74,78,79,79,77,78,84,86,80,72,71,74,77,78,77,79,82,81,78,79,84,90,82,73,73,74,73,72,74,76,78,77,77,79,78,77,73,72,72,73,75,74,75,76,76,76,76,82,103,106,95,92,92,89,82,77,78,82,85,86,87,86,81,77,80,83,81,75,73,73,75,77,78,80,81,83,85,87,87,84,81,79,77,78,81,81,79,78,76,75,74,74,76,78,80,81,78,76,75,76,76,76,76,76,78,80,83,83,80,77,77,79,79,79,79,80,80,80,80,98,108,100,89,86,89,88,87,85,81,78,77,79,78,80,82,84,86,86,86,86,85,82,80,80,79,78,77,78,78,80,81,80,79,79,78,79,77,73,74,78,80,77,76,80,84,83,82,84,88,90,87,80,76,80,83,82,81,83,86,86,82,78,79,78,77,76,79,81,81,79,80,81,79,76,74,77,79,77,74,75,78,79,77,77,78,78,81,79,76,74,78,79,77,75,76,77,76,74,74,76,76,78,80,83,82,80,77,77,76,74,73,75,77,76,76,77,76,75,76,79,84,85,86,90,94,96,91,83,80,80,78,76,76,80,83,84,86,87,87,87,89,89,90,91,91,92,92,83,86,92,98,92,88,88,88,95,93,90,88,87,86,87,86,87,90,92,92,92,93,93,91,91,92,92,88,87,89,90,90,91,92,91,90,88,87,87,87,86,88,90,88,88,88,88,86,86,86,86,86,87,87,88,91,94,93,90,88,87,86,88,88,102,107,105,100,93,88,86,87,90,89,87,85,87,87,86,85,85,86,88,87,85,85,86,86,87,88,88,86,86,87,87,87,87,87,88,87,86,86,87,88,88,88,88,100,95,90,86,87,87,87,89,90,90,87,87,87,88,89,90,89,87,86,86,86,84,83,82,82,82,82,83,84,85,84,83,84,85,85,85,87,90,88,86,86,87,87,86,85,86,85,85,84,84,83,83,83,83,84,86,87,84,84,null],"mot":[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,1,1,3,1,0,5,1,0,1,1,9,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,4,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,14,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,20,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,3,9,8,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,3,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,1,0,0,0,0,0,0,4,16,3,8,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,3,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,11,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,10,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,6,null]},"rr":[[1380.0,7],[1381.0,7],[1382.0,5],[1383.0,5],[1384.0,2],[1385.0,2],[1386.0,1],[1387.0,9],[1388.0,10],[1389.0,11],[1390.0,10],[1391.0,12],[1392.0,7],[1393.0,11],[1394.0,4],[1395.0,9],[1396.0,11],[1397.0,6],[1398.0,3],[1399.0,5],[1400.0,8],[1401.0,0],[1402.0,4],[1403.0,6],[1404.0,10],[1405.0,10],[1406.0,8],[1407.0,9],[1408.0,8],[1409.0,7],[1410.0,8],[1411.0,9],[1412.0,8],[1413.0,6],[1414.0,6],[1415.0,8],[1416.0,4],[1417.0,11],[1418.0,6],[1419.0,3],[1420.0,8],[1421.0,9],[1422.0,2],[1423.0,9],[1424.0,6],[1425.0,13],[1426.0,9],[1427.0,13],[1428.0,13],[1429.0,10],[1430.0,11],[1431.0,10],[1432.0,10],[1433.0,12],[1434.0,8],[1435.0,9],[1436.0,10],[1437.0,10],[1438.0,9],[1439.0,8],[1440.0,9],[1441.0,9],[1442.0,8],[1443.0,11],[1444.0,11],[1445.0,14],[1446.0,8],[1447.0,10],[1448.0,9],[1449.0,8],[1450.0,8],[1451.0,14],[1452.0,10],[1453.0,9],[1454.0,10],[1455.0,6],[1456.0,12],[1457.0,14],[1458.0,10],[1459.0,8],[1460.0,7],[1461.0,13],[1462.0,12],[1463.0,8],[1464.0,9],[1465.0,9],[1466.0,9],[1467.0,9],[1468.0,11],[1469.0,10],[1470.0,12],[1471.0,7],[1472.0,12],[1473.0,10],[1474.0,11],[1475.0,8],[1476.0,14],[1477.0,11],[1478.0,7],[1479.0,11],[1480.0,10],[1481.0,6],[1482.0,11],[1483.0,8],[1484.0,9],[1485.0,11],[1486.0,8],[1487.0,7],[1488.0,13],[1489.0,9],[1490.0,9],[1491.0,10],[1492.0,7],[1493.0,8],[1494.0,11],[1495.0,9],[1496.0,15],[1497.0,7],[1498.0,8],[1499.0,11],[1500.0,7],[1501.0,3],[1502.0,5],[1503.0,8],[1504.0,3],[1505.0,9],[1506.0,10],[1507.0,12],[1508.0,7],[1509.0,13],[1510.0,9],[1511.0,8],[1512.0,7],[1513.0,7],[1514.0,6],[1515.0,9],[1516.0,10],[1517.0,12],[1518.0,7],[1519.0,7],[1520.0,13],[1521.0,15],[1522.0,12],[1523.0,12],[1524.0,7],[1525.0,10],[1526.0,8],[1527.0,7],[1528.0,12],[1529.0,8],[1530.0,9],[1531.0,7],[1532.0,8],[1533.0,3],[1534.0,8],[1535.0,9],[1536.0,12],[1537.0,6],[1538.0,7],[1539.0,7],[1540.0,8],[1541.0,8],[1542.0,3],[1543.0,5],[1544.0,4],[1545.0,1],[1546.0,4],[1547.0,3],[1548.0,1],[1549.0,4],[1550.0,6],[1551.0,2],[1552.0,6],[1553.0,3],[1554.0,5],[1555.0,4],[1556.0,2],[1557.0,2],[1558.0,3],[1559.0,1],[1560.0,1],[1561.0,5],[1562.0,5],[1563.0,4],[1564.0,4],[1565.0,5],[1566.0,2],[1567.0,2],[1568.0,2],[1569.0,1],[1570.0,3],[1571.0,2],[1572.0,2],[1573.0,3],[1574.0,4],[1575.0,2],[1576.0,4],[1577.0,4],[1578.0,3],[1579.0,6],[1580.0,3],[1581.0,2],[1582.0,5],[1583.0,5],[1584.0,2],[1585.0,3],[1586.0,4],[1587.0,6],[1588.0,4],[1589.0,1],[1590.0,6],[1591.0,3],[1592.0,3],[1593.0,7],[1594.0,10],[1595.0,5],[1596.0,3],[1597.0,6],[1598.0,7],[1599.0,4],[1600.0,4],[1601.0,7],[1602.0,2],[1603.0,8],[1604.0,5],[1605.0,5],[1606.0,8],[1607.0,4],[1608.0,8],[1609.0,4],[1610.0,3],[1611.0,8],[1612.0,8],[1613.0,10],[1614.0,5],[1615.0,11],[1616.0,10],[1617.0,8],[1618.0,8],[1619.0,11],[1620.0,11],[1621.0,8],[1622.0,11],[1623.0,8],[1624.0,7],[1625.0,11],[1626.0,9],[1627.0,6],[1628.0,3],[1629.0,10],[1630.0,12],[1631.0,10],[1632.0,10],[1633.0,9],[1634.0,12],[1635.0,9],[1636.0,4],[1637.0,7],[1638.0,6],[1639.0,9],[1640.0,9],[1641.0,5],[1642.0,8],[1643.0,9],[1644.0,10],[1645.0,12],[1646.0,9],[1647.0,13],[1648.0,7],[1649.0,8],[1650.0,11],[1651.0,8],[1652.0,7],[1653.0,7],[1654.0,8],[1655.0,7],[1656.0,8],[1657.0,5],[1658.0,6],[1659.0,8],[1660.0,6],[1661.0,5],[1662.0,8],[1663.0,7],[1664.0,8],[1665.0,8],[1666.0,7],[1667.0,8],[1668.0,7],[1669.0,7],[1670.0,8],[1671.0,8],[1672.0,7],[1673.0,5],[1674.0,6],[1675.0,7],[1676.0,7],[1677.0,7],[1678.0,4],[1679.0,7],[1680.0,7],[1681.0,5],[1682.0,7],[1683.0,8],[1684.0,7],[1685.0,4],[1686.0,5],[1687.0,4],[1688.0,5],[1689.0,4],[1690.0,4],[1691.0,7],[1692.0,5],[1693.0,6],[1694.0,3],[1695.0,10],[1696.0,7],[1697.0,7],[1698.0,7],[1699.0,6],[1700.0,6],[1701.0,6],[1702.0,8],[1703.0,9],[1704.0,10],[1705.0,8],[1706.0,9],[1707.0,8],[1708.0,9],[1709.0,5],[1710.0,14],[1711.0,11],[1712.0,10],[1713.0,11],[1714.0,10],[1715.0,10],[1716.0,11],[1717.0,10],[1718.0,11],[1719.0,11],[1720.0,11],[1721.0,11],[1722.0,12],[1723.0,10],[1724.0,11],[1725.0,13],[1726.0,6],[1727.0,13],[1728.0,12],[1729.0,12],[1730.0,12],[1731.0,7],[1732.0,10],[1733.0,10],[1734.0,6],[1735.0,11],[1736.0,10],[1737.0,13],[1738.0,12],[1739.0,10],[1740.0,5],[1741.0,7],[1742.0,6],[1743.0,7],[1744.0,5],[1745.0,3],[1746.0,7],[1747.0,4],[1748.0,5],[1749.0,8],[1750.0,6],[1751.0,4],[1752.0,3],[1753.0,4],[1754.0,15],[1755.0,8],[1756.0,9],[1757.0,12],[1758.0,9],[1759.0,8],[1760.0,9],[1761.0,6],[1762.0,6],[1763.0,11],[1764.0,9],[1765.0,11],[1766.0,6],[1767.0,2],[1768.0,7],[1769.0,5],[1770.0,5],[1771.0,6],[1772.0,1],[1773.0,4],[1774.0,8],[1775.0,9],[1776.0,8],[1777.0,6],[1778.0,7],[1779.0,8],[1780.0,5],[1781.0,8],[1782.0,10],[1783.0,8],[1784.0,5],[1785.0,6],[1786.0,6],[1787.0,4],[1788.0,8],[1789.0,7],[1790.0,7],[1791.0,10],[1792.0,11],[1793.0,13],[1794.0,11],[1795.0,11],[1796.0,8],[1797.0,5],[1798.0,4],[1799.0,9],[1800.0,11],[1801.0,7],[1802.0,6],[1803.0,8],[1804.0,8],[1805.0,12],[1806.0,7],[1807.0,10],[1808.0,10],[1809.0,11],[1810.0,10],[1811.0,11],[1812.0,8],[1813.0,7],[1814.0,9],[1815.0,13],[1816.0,10],[1817.0,11],[1818.0,11],[1819.0,11],[1820.0,9],[1821.0,10],[1822.0,7],[1823.0,10],[1824.0,8],[1825.0,6],[1826.0,10],[1827.0,12],[1828.0,7],[1829.0,8],[1830.0,9],[1831.0,9],[1832.0,9],[1833.0,5],[1834.0,5],[1835.0,7],[1836.0,7],[1837.0,4],[1838.0,4],[1839.0,12],[1840.0,8],[1841.0,11],[1842.0,10],[1843.0,10],[1844.0,9],[1845.0,6],[1846.0,4],[1847.0,6],[1848.0,8],[1849.0,8],[1850.0,6],[1851.0,2],[1852.0,6],[1853.0,9],[1854.0,7],[1855.0,7],[1856.0,10],[1857.0,10],[1858.0,8],[1859.0,4]],"apnea":[[1455.7,12.4],[1460.8,10.4],[1467.4,13.9],[1473.5,10.8],[1476.3,13.4],[1481.9,21.9],[1483.8,13.4],[1488.7,14.7],[1489.1,14.9],[1496.9,24.6],[1498.2,11.1],[1498.8,30.3],[1500.3,15.8],[1501.2,17.4],[1501.7,37.6],[1502.8,21.5],[1504.1,39.4],[1506.2,13.1],[1506.9,13.6],[1515.7,13.1],[1537.2,22.9],[1538.2,18.1],[1540.0,30.1],[1542.1,25.5],[1543.1,30.8],[1544.0,29.4],[1544.8,11.3],[1545.0,24.5],[1545.8,31.5],[1546.6,36.5],[1547.5,40.3],[1548.6,32.1],[1549.6,25.4],[1550.6,25.5],[1551.4,36.0],[1552.5,24.0],[1553.3,29.5],[1554.2,31.4],[1555.2,25.6],[1555.9,31.9],[1556.9,29.2],[1557.8,27.8],[1558.7,31.3],[1559.6,25.4],[1560.5,31.8],[1561.7,27.6],[1562.6,11.0],[1564.7,20.7],[1565.5,21.8],[1566.3,11.9],[1566.5,14.1],[1567.2,27.6],[1568.0,22.9],[1568.8,17.8],[1569.6,29.9],[1570.3,20.8],[1571.0,11.4],[1571.8,17.0],[1572.6,12.2],[1572.9,20.2],[1573.6,11.8],[1574.3,35.0],[1575.5,23.9],[1576.4,11.0],[1578.0,21.0],[1579.5,13.7],[1580.2,29.3],[1581.2,19.2],[1582.0,18.6],[1583.2,16.7],[1584.1,32.6],[1584.9,11.4],[1586.5,15.8],[1587.2,15.6],[1588.0,11.6],[1589.6,21.6],[1590.4,11.7],[1591.0,14.7],[1591.7,16.2],[1593.2,13.7],[1595.8,18.8],[1596.5,14.6],[1597.4,12.4],[1599.3,25.4],[1600.0,27.8],[1601.0,21.3],[1602.8,14.5],[1603.6,15.8],[1604.2,13.0],[1605.6,27.2],[1607.3,23.8],[1608.3,11.8],[1609.0,18.6],[1609.7,29.0],[1610.6,10.3],[1611.0,15.6],[1612.5,13.3],[1614.1,27.2],[1615.1,17.1],[1615.9,11.7],[1625.7,14.4],[1671.7,20.5],[1674.5,37.4],[1678.6,20.6],[1740.0,17.2],[1740.8,16.4],[1741.5,30.3],[1742.4,23.4],[1743.3,23.5],[1744.1,18.8],[1744.8,34.2],[1746.0,10.7],[1746.5,31.9],[1747.4,30.1],[1748.2,25.7],[1749.1,13.2],[1749.8,21.5],[1750.5,11.7],[1750.7,25.2],[1751.6,16.0],[1752.2,35.8],[1753.2,31.2],[1754.5,14.3],[1755.0,10.4],[1755.3,15.4],[1761.5,13.9],[1762.5,14.7],[1764.3,11.2],[1766.3,16.8],[1767.0,12.8],[1767.5,27.6],[1769.7,15.8],[1770.5,12.6],[1771.3,13.2],[1772.1,16.2],[1772.8,31.4],[1774.7,12.6],[1775.9,16.3],[1801.5,34.2],[1802.8,21.1],[1813.3,27.4],[1814.0,16.5],[1825.5,14.3],[1833.5,15.2],[1834.0,13.7],[1835.2,19.5],[1836.4,20.7],[1837.2,16.5],[1839.3,12.4],[1841.9,14.0],[1846.3,15.8],[1851.5,24.0]],"obstr":[[1385.0,30.6,1],[1385.6,69.95,1],[1394.2,27.3,0],[1401.0,78.8,0],[1419.4,38.6,1],[1421.9,49.95,1],[1439.2,17.88,1],[1440.8,22.6,1],[1442.8,18.5,0],[1446.9,14.92,1],[1447.8,8.95,1],[1449.0,8.17,1],[1451.3,8.6,1],[1452.2,16.72,0],[1453.5,15.28,1],[1454.4,10.95,0],[1455.0,19.52,1],[1459.5,18.57,0],[1466.1,21.12,1],[1467.0,15.83,1],[1467.7,3.98,0],[1467.8,5.3,0],[1468.2,19.05,1],[1469.0,7.27,1],[1469.1,5.15,0],[1469.6,5.27,0],[1469.7,9.15,1],[1470.4,20.37,1],[1471.2,5.77,1],[1472.1,18.9,1],[1472.9,9.45,1],[1473.8,6.22,0],[1474.6,14.88,1],[1475.7,18.98,1],[1476.0,2.55,1],[1480.3,7.38,0],[1480.5,9.1,0],[1481.5,7.88,1],[1481.6,13.53,0],[1482.3,8.45,1],[1482.4,5.07,1],[1482.9,9.35,1],[1484.2,4.68,1],[1484.2,14.5,0],[1485.0,3.6,0],[1485.1,15.23,0],[1486.0,17.55,1],[1487.0,13.7,1],[1487.7,22.23,1],[1488.1,2.95,0],[1488.3,3.62,0],[1488.5,3.03,1],[1489.0,2.62,0],[1489.4,2.45,0],[1490.2,8.42,1],[1490.3,13.98,1],[1490.9,18.25,0],[1491.5,4.18,0],[1492.2,14.2,1],[1492.7,18.27,1],[1493.2,22.95,1],[1494.0,13.1,1],[1494.6,18.83,1],[1495.0,7.38,1],[1495.1,8.33,0],[1495.7,18.82,1],[1496.2,7.08,1],[1496.3,7.2,1],[1496.4,2.6,0],[1496.8,2.27,0],[1496.9,2.7,0],[1497.3,6.3,1],[1497.5,9.62,0],[1498.4,9.45,1],[1498.6,3.15,1],[1499.3,6.45,1],[1500.5,6.77,1],[1500.7,2.98,0],[1501.5,6.5,1],[1501.6,8.75,0],[1502.3,16.72,1],[1502.7,2.62,0],[1503.3,9.85,1],[1503.5,8.92,1],[1503.7,5.65,1],[1504.7,9.45,1],[1504.9,5.32,1],[1505.0,21.6,1],[1508.6,4.83,0],[1508.7,9.88,1],[1508.9,7.35,0],[1509.4,18.45,1],[1510.9,26.38,1],[1511.3,4.48,1],[1511.4,15.73,0],[1512.1,26.68,1],[1513.3,25.25,1],[1514.9,6.92,1],[1515.0,26.18,1],[1516.9,8.9,1],[1517.0,8.88,1],[1517.2,4.4,1],[1517.3,4.5,0],[1517.4,4.15,0],[1518.6,49.43,1],[1521.3,3.07,1],[1524.1,19.85,0],[1525.2,12.38,0],[1525.9,14.33,1],[1526.2,4.83,1],[1526.9,22.0,1],[1528.2,17.93,0],[1529.0,13.45,1],[1530.2,24.95,0],[1531.1,23.25,1],[1532.2,13.1,1],[1532.5,4.9,0],[1533.0,35.47,1],[1534.0,4.5,1],[1534.1,8.97,1],[1534.7,24.92,1],[1535.8,21.38,1],[1536.2,4.0,1],[1536.8,17.3,1],[1537.7,8.88,1],[1537.9,8.38,1],[1538.6,9.6,1],[1538.7,12.3,1],[1539.6,15.58,1],[1540.5,8.67,1],[1540.7,4.18,1],[1541.5,22.23,1],[1542.5,5.7,1],[1542.6,24.45,1],[1543.7,15.22,1],[1544.5,10.98,0],[1545.4,23.98,1],[1546.4,8.83,1],[1546.5,4.45,0],[1547.2,11.35,1],[1547.4,4.65,0],[1548.2,22.82,1],[1549.2,8.25,1],[1549.4,10.12,1],[1550.2,16.57,1],[1551.0,19.88,1],[1552.0,15.8,1],[1552.9,17.33,1],[1553.8,7.27,1],[1553.9,9.38,0],[1554.7,8.93,1],[1555.6,14.67,1],[1556.5,19.47,1],[1557.4,20.85,1],[1558.3,7.98,1],[1558.4,10.65,0],[1559.2,24.1,1],[1560.2,24.7,1],[1561.1,29.95,1],[1562.2,10.68,1],[1562.4,12.6,1],[1562.8,17.28,1],[1563.5,20.4,1],[1564.2,17.93,1],[1565.1,13.55,1],[1565.9,14.68,1],[1566.8,22.1,1],[1567.6,18.12,1],[1568.4,17.4,1],[1569.3,17.55,1],[1570.1,14.68,1],[1570.7,13.48,1],[1571.5,19.1,1],[1572.3,18.33,1],[1573.2,13.15,1],[1574.0,19.95,1],[1575.0,23.38,1],[1575.9,21.0,1],[1576.6,13.83,1],[1577.4,5.83,1],[1577.8,15.68,1],[1578.4,27.85,1],[1579.1,20.25,1],[1579.9,16.3,1],[1580.8,19.85,1],[1581.5,26.62,1],[1582.8,18.73,1],[1583.7,12.38,1],[1584.6,12.2,1],[1585.2,23.17,1],[1586.0,18.8,1],[1586.8,21.17,1],[1587.6,10.92,1],[1588.3,16.38,1],[1588.8,4.27,0],[1589.2,20.77,1],[1590.0,9.02,1],[1590.6,16.15,1],[1591.3,22.28,1],[1592.0,4.65,1],[1592.5,24.53,1],[1592.9,6.22,0],[1593.0,4.7,0],[1593.4,15.08,0],[1594.0,12.6,1],[1594.5,15.43,0],[1595.0,15.45,1],[1595.6,13.12,1],[1596.2,14.65,1],[1596.7,13.0,1],[1597.2,9.38,1],[1597.7,14.07,1],[1598.4,9.3,1],[1599.0,13.1,1],[1599.7,13.52,1],[1600.5,18.95,1],[1601.3,13.55,1],[1602.2,36.1,1],[1603.2,7.67,1],[1603.9,15.47,0],[1604.5,9.17,1],[1605.3,13.28,1],[1606.1,5.8,1],[1606.2,11.52,1],[1606.9,13.0,0],[1607.7,29.9,1],[1608.5,9.18,1],[1609.3,8.12,1],[1610.2,21.9,1],[1611.2,4.95,1],[1612.0,17.22,1],[1613.1,19.93,1],[1613.8,12.4,0],[1614.6,12.05,1],[1614.8,7.05,1],[1616.2,8.67,0],[1617.7,16.52,1],[1618.5,29.9,1],[1619.8,11.88,1],[1620.8,37.18,1],[1621.9,17.52,1],[1623.7,22.4,1],[1624.5,21.45,0],[1625.9,14.27,1],[1626.2,10.57,0],[1627.2,28.77,0],[1628.7,22.3,1],[1631.4,7.88,0],[1722.7,14.45,0],[1723.7,13.52,0],[1724.8,13.55,0],[1725.1,3.22,1],[1725.2,14.92,0],[1726.0,22.33,1],[1726.7,12.15,1],[1728.8,4.15,0],[1729.6,4.07,0],[1729.7,3.55,0],[1730.5,2.6,0],[1730.6,3.98,0],[1730.7,2.8,0],[1730.8,8.95,1],[1730.9,4.73,1],[1731.0,18.27,1],[1731.3,4.28,0],[1731.4,7.9,1],[1731.7,29.45,1],[1732.7,16.95,1],[1733.8,18.88,0],[1734.3,4.32,0],[1734.4,18.52,1],[1734.8,14.9,1],[1735.1,3.8,0],[1735.7,12.95,1],[1736.2,8.5,1],[1739.6,3.07,0],[1742.0,7.68,0],[1749.4,1.65,0],[1750.1,1.08,0],[1753.8,21.57,0],[1806.2,21.78,0],[1812.9,16.98,0],[1820.4,14.85,1],[1822.2,21.07,1],[1823.6,13.38,1],[1824.3,18.15,1],[1825.1,19.45,1],[1828.1,15.6,1],[1829.3,15.75,1],[1830.3,15.9,1],[1831.2,16.43,1],[1832.1,3.93,1],[1832.2,3.18,1],[1832.3,5.38,1],[1832.8,11.48,1],[1833.0,16.47,1],[1859.2,24.7,0]]};
const T_MIN_FULL = 1373.7;
const T_MAX_FULL = 1862.1;
let T_MIN = T_MIN_FULL;
let T_MAX = T_MAX_FULL;

// ============================================================
// Color Themes
// ============================================================
const THEMES = {
  dark: {
    bodyBg: '#0a0e14',
    titleText: '#e8ecf0',
    subtitleText: '#6b7a8d',
    legendBg: '#111822',
    legendBorder: '#1e2a38',
    legendText: '#8899aa',
    versionText: '#2a3a4a',
    panelBg: '#0d1219',
    panelBorder: '#1a2430',
    gridLine: 'rgba(30,42,56,0.6)',
    gridLineX: 'rgba(30,42,56,0.4)',
    yAxisText: '#4a5a6a',
    xAxisText: '#5a6a7a',
    xAxisLine: '#1a2430',
    spo2: '#48b8e8',
    hr: '#e85878',
    resp: '#58d888',
    respArea: 'rgba(88,216,136,0.12)',
    spo2Ref: 'rgba(255,80,60,0.3)',
    evtLabel: '#ff6050',
    apneaBar: 'rgba(255,70,50,0.35)',
    obstrSevere: '#ff4040',
    obstrMod: '#f0a030',
    sevLabel: 'rgba(255,70,50,0.4)',
    modLabel: 'rgba(240,160,48,0.4)',
    motionBar: 'rgba(160,140,220,0.7)',
    motionAxis: 'rgba(160,140,220,0.7)',
    hrMA: 'rgba(255,220,80,0.85)',
    apneaLong: 'rgba(255,220,40,0.8)',
    apneaLongText: '#ffe060',
    spo2DipText: '#ff6060',
    goodSleep: 'rgba(80,200,120,0.5)',
  },
  light: {
    bodyBg: '#ffffff',
    titleText: '#111111',
    subtitleText: '#555555',
    legendBg: '#f0f0f0',
    legendBorder: '#cccccc',
    legendText: '#555555',
    versionText: '#c0c0c0',
    panelBg: '#f8f8f8',
    panelBorder: '#cccccc',
    gridLine: 'rgba(0,0,0,0.12)',
    gridLineX: 'rgba(0,0,0,0.10)',
    yAxisText: '#444444',
    xAxisText: '#444444',
    xAxisLine: '#999999',
    spo2: '#0077aa',
    hr: '#cc2244',
    resp: '#228844',
    respArea: 'rgba(34,136,68,0.10)',
    spo2Ref: 'rgba(200,50,30,0.4)',
    evtLabel: '#cc3322',
    apneaBar: 'rgba(200,50,30,0.4)',
    obstrSevere: '#cc2222',
    obstrMod: '#cc7700',
    sevLabel: 'rgba(200,50,30,0.5)',
    modLabel: 'rgba(200,120,0,0.5)',
    motionBar: 'rgba(80,60,160,0.65)',
    motionAxis: 'rgba(80,60,140,0.8)',
    hrMA: 'rgba(180,120,0,0.85)',
    apneaLong: 'rgba(200,160,0,0.75)',
    apneaLongText: '#806000',
    spo2DipText: '#cc0000',
    goodSleep: 'rgba(40,160,80,0.45)',
  }
};
let theme = THEMES.dark;

function updateLegendColors() {
  document.getElementById('lsw-spo2').style.background = theme.spo2;
  document.getElementById('lsw-hr').style.background = theme.hr;
  document.getElementById('lsw-hrma').style.background = theme.hrMA;
  document.getElementById('lsw-resp').style.background = theme.resp;
  document.getElementById('lsw-apnea').style.background = theme.apneaBar;
  document.getElementById('lsw-apnealong').style.background = theme.apneaLong;
  document.getElementById('lsw-omod').style.background = theme.obstrMod;
  document.getElementById('lsw-osev').style.background = theme.obstrSevere;
  document.getElementById('lsw-mot').style.background = theme.motionBar;
  const goodEl = document.getElementById('lsw-good');
  goodEl.style.background = 'none';
  goodEl.style.borderTop = '2px dotted ' + theme.goodSleep;
}

function toggleTheme() {
  const body = document.body;
  const btn = document.getElementById('themeToggle');
  if (body.classList.contains('light-theme')) {
    body.classList.remove('light-theme');
    theme = THEMES.dark;
    btn.innerHTML = '&#x263C; Light';
  } else {
    body.classList.add('light-theme');
    theme = THEMES.light;
    btn.innerHTML = '&#x263D; Dark';
  }
  draw();
  updateLegendColors();
}

// Auto-switch theme for printing
window.addEventListener('beforeprint', () => {
  if (!document.body.classList.contains('light-theme')) {
    document.body.classList.add('light-theme');
    document.body.dataset.wasdk = '1';
    theme = THEMES.light;
    draw();
    updateLegendColors();
  }
});
window.addEventListener('afterprint', () => {
  if (document.body.dataset.wasdk === '1') {
    document.body.classList.remove('light-theme');
    delete document.body.dataset.wasdk;
    theme = THEMES.dark;
    draw();
    updateLegendColors();
  }
});

// ============================================================
// Layout (dynamic — fills viewport)
// ============================================================
const canvas = document.getElementById('mainCanvas');
const ctx = canvas.getContext('2d');

const DPR = window.devicePixelRatio || 1;
// Panel proportional weights: SpO2, HR, Resp, Events, Motion
const PANEL_WEIGHTS = [0.25, 0.25, 0.20, 0.20, 0.10];
const PANEL_GAP = 4;
const MARGIN = { top: 6, right: 24, bottom: 28, left: 54 };

let W, TOTAL_H, PANEL_HEIGHTS, plotW;

function computeLayout() {
  W = canvas.parentElement.clientWidth;
  // Available height = viewport minus header elements
  const headerH = document.getElementById('chartArea').getBoundingClientRect().top;
  const availH = window.innerHeight - headerH - 4;
  TOTAL_H = Math.max(300, availH);
  const panelSpace = TOTAL_H - MARGIN.top - MARGIN.bottom - PANEL_GAP * (PANEL_WEIGHTS.length - 1);
  PANEL_HEIGHTS = PANEL_WEIGHTS.map(w => Math.round(w * panelSpace));
  plotW = W - MARGIN.left - MARGIN.right;

  canvas.width = W * DPR;
  canvas.height = TOTAL_H * DPR;
  canvas.style.height = TOTAL_H + 'px';
  ctx.setTransform(DPR, 0, 0, DPR, 0, 0);

  const crosshair = document.getElementById('crosshair');
  crosshair.style.height = (TOTAL_H - MARGIN.bottom) + 'px';
}

computeLayout();

function tToX(t) { return MARGIN.left + (t - T_MIN) / (T_MAX - T_MIN) * plotW; }
function xToT(x) { return T_MIN + (x - MARGIN.left) / plotW * (T_MAX - T_MIN); }

function minToClockStr(m) {
  let h = Math.floor(m / 60) % 24;
  let mn = Math.floor(m % 60);
  let s = Math.round((m % 1) * 60);
  let str = `${h.toString().padStart(2,'0')}:${mn.toString().padStart(2,'0')}`;
  if (s !== 0) str += `:${s.toString().padStart(2,'0')}`;
  return str;
}

function minToClockStrFull(m) {
  let h = Math.floor(m / 60) % 24;
  let mn = Math.floor(m % 60);
  let s = Math.round((m % 1) * 60);
  return `${h.toString().padStart(2,'0')}:${mn.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
}

function panelTop(i) {
  let y = MARGIN.top;
  for (let j = 0; j < i; j++) y += PANEL_HEIGHTS[j] + PANEL_GAP;
  return y;
}

function valToY(v, vMin, vMax, panelIdx) {
  const pt = panelTop(panelIdx);
  const ph = PANEL_HEIGHTS[panelIdx];
  const pad = 6;
  return pt + pad + (1 - (v - vMin) / (vMax - vMin)) * (ph - 2*pad);
}

// ============================================================
// Drawing helpers
// ============================================================
function drawPanelBg(idx) {
  const y = panelTop(idx);
  const h = PANEL_HEIGHTS[idx];
  ctx.fillStyle = theme.panelBg;
  ctx.fillRect(MARGIN.left, y, plotW, h);
  ctx.strokeStyle = theme.panelBorder;
  ctx.lineWidth = 1;
  ctx.strokeRect(MARGIN.left, y, plotW, h);
}

function drawLine(data, tKey, vKey, vMin, vMax, panelIdx, color, lineWidth) {
  ctx.beginPath();
  ctx.strokeStyle = color;
  ctx.lineWidth = lineWidth || 1.2;
  ctx.lineJoin = 'round';
  let first = true;
  for (const pt of data) {
    const x = tToX(pt[tKey]);
    const y = valToY(pt[vKey], vMin, vMax, panelIdx);
    if (x < MARGIN.left || x > MARGIN.left + plotW) continue;
    if (first) { ctx.moveTo(x, y); first = false; }
    else ctx.lineTo(x, y);
  }
  ctx.stroke();
}

function drawArea(data, tKey, vKey, vMin, vMax, panelIdx, fillColor) {
  const pt0 = panelTop(panelIdx);
  const ph = PANEL_HEIGHTS[panelIdx];
  const baseY = pt0 + ph - 6;
  ctx.beginPath();
  let first = true;
  let lastX;
  for (const pt of data) {
    const x = tToX(pt[tKey]);
    const y = valToY(pt[vKey], vMin, vMax, panelIdx);
    if (x < MARGIN.left || x > MARGIN.left + plotW) continue;
    if (first) { ctx.moveTo(x, baseY); ctx.lineTo(x, y); first = false; }
    else ctx.lineTo(x, y);
    lastX = x;
  }
  if (lastX !== undefined) {
    ctx.lineTo(lastX, baseY);
    ctx.closePath();
    ctx.fillStyle = fillColor;
    ctx.fill();
  }
}

function drawYAxis(vMin, vMax, panelIdx, ticks, unit, color) {
  ctx.font = '10px IBM Plex Mono';
  ctx.textAlign = 'right';
  ctx.textBaseline = 'middle';
  for (const v of ticks) {
    const y = valToY(v, vMin, vMax, panelIdx);
    ctx.strokeStyle = theme.gridLine;
    ctx.lineWidth = 0.5;
    ctx.beginPath();
    ctx.moveTo(MARGIN.left, y);
    ctx.lineTo(MARGIN.left + plotW, y);
    ctx.stroke();
    ctx.fillStyle = theme.yAxisText;
    ctx.fillText(v.toString(), MARGIN.left - 6, y);
  }
  ctx.save();
  ctx.translate(14, panelTop(panelIdx) + PANEL_HEIGHTS[panelIdx]/2);
  ctx.rotate(-Math.PI/2);
  ctx.textAlign = 'center';
  ctx.font = '500 10px IBM Plex Mono';
  ctx.fillStyle = color;
  ctx.fillText(unit, 0, 0);
  ctx.restore();
}

function drawXAxis() {
  const y = TOTAL_H - MARGIN.bottom + 4;
  ctx.font = '11px IBM Plex Mono';
  ctx.fillStyle = theme.xAxisText;
  ctx.textAlign = 'center';
  ctx.textBaseline = 'top';

  // Work in integer seconds to avoid floating-point modulo errors
  const rangeMin = T_MAX - T_MIN;
  const rangeSec = rangeMin * 60;

  // Adaptive intervals (all in seconds)
  let majorSec, minorSec, tickSec;
  // tickSec = smallest marks (short hairline at bottom only)
  // minorSec = intermediate (dashed line through panels)
  // majorSec = labelled (solid line through panels)
  if (rangeSec > 14400)     { majorSec = 3600; minorSec = 1800; tickSec = 0; }
  else if (rangeSec > 5400) { majorSec = 1800; minorSec = 900;  tickSec = 0; }
  else if (rangeSec > 2700) { majorSec = 900;  minorSec = 300;  tickSec = 60; }
  else if (rangeSec > 1200) { majorSec = 300;  minorSec = 60;   tickSec = 0; }
  else if (rangeSec > 480)  { majorSec = 120;  minorSec = 60;   tickSec = 10; }
  else if (rangeSec > 180)  { majorSec = 60;   minorSec = 10;   tickSec = 0; }
  else                      { majorSec = 30;   minorSec = 10;   tickSec = 0; }

  const finest = tickSec > 0 ? tickSec : minorSec;
  const tMinSec = Math.round(T_MIN * 60);
  const tMaxSec = Math.round(T_MAX * 60);
  const firstSec = Math.ceil(tMinSec / finest) * finest;

  for (let s = firstSec; s <= tMaxSec; s += finest) {
    const tMin = s / 60;
    const x = tToX(tMin);
    if (x < MARGIN.left - 1 || x > MARGIN.left + plotW + 1) continue;

    const isMajor = (s % majorSec) === 0;
    const isMinor = !isMajor && (s % minorSec) === 0;

    if (isMajor) {
      ctx.strokeStyle = theme.gridLineX;
      ctx.lineWidth = 0.8;
      ctx.setLineDash([]);
      ctx.beginPath();
      ctx.moveTo(x, MARGIN.top);
      ctx.lineTo(x, TOTAL_H - MARGIN.bottom);
      ctx.stroke();
      // Major tick mark on axis
      ctx.strokeStyle = theme.xAxisText;
      ctx.lineWidth = 1.2;
      ctx.beginPath();
      ctx.moveTo(x, TOTAL_H - MARGIN.bottom - 7);
      ctx.lineTo(x, TOTAL_H - MARGIN.bottom);
      ctx.stroke();
      ctx.fillText(minToClockStr(tMin), x, y);
    } else if (isMinor) {
      // Minor ticks: solid marks on axis, 5px tall
      ctx.strokeStyle = theme.xAxisText;
      ctx.lineWidth = 0.7;
      ctx.setLineDash([]);
      ctx.beginPath();
      ctx.moveTo(x, TOTAL_H - MARGIN.bottom - 5);
      ctx.lineTo(x, TOTAL_H - MARGIN.bottom);
      ctx.stroke();
    } else {
      // Finest tick marks: short solid marks, 3px tall
      ctx.strokeStyle = theme.xAxisText;
      ctx.lineWidth = 0.4;
      ctx.setLineDash([]);
      ctx.beginPath();
      ctx.moveTo(x, TOTAL_H - MARGIN.bottom - 3);
      ctx.lineTo(x, TOTAL_H - MARGIN.bottom);
      ctx.stroke();
    }
  }
  ctx.strokeStyle = theme.xAxisLine;
  ctx.lineWidth = 1;
  ctx.setLineDash([]);
  ctx.beginPath();
  ctx.moveTo(MARGIN.left, TOTAL_H - MARGIN.bottom);
  ctx.lineTo(MARGIN.left + plotW, TOTAL_H - MARGIN.bottom);
  ctx.stroke();
}

// ============================================================
// Prepare data arrays
// ============================================================
// SleepU stored compactly: {t0, dt, spo2:[], hr:[], mot:[]}
// Reconstruct time from index: t = t0 + i * dt
const _su = RAW.sleepU;
const spo2Data = [];
const hrData   = [];
const motData  = [];
for (let i = 0; i < _su.spo2.length; i++) {
  const t = _su.t0 + i * _su.dt;
  if (_su.spo2[i] !== null) spo2Data.push({t, v: _su.spo2[i]});
  if (_su.hr[i]   !== null) hrData.push({t, v: _su.hr[i]});
  if (_su.mot[i]  !== null) motData.push({t, v: _su.mot[i]});
}
const rrData    = RAW.rr.map(d => ({t: d[0], v: d[1]}));
const apneaData = RAW.apnea.map(d => ({t: d[0], dur: d[1]}));
const obstrData = RAW.obstr.map(d => ({t: d[0], dur: d[1], sev: d[2]}));

// ============================================================
// Compute dynamic Y-axis ranges from data
// ============================================================
const spo2Vals = spo2Data.map(d => d.v);
const hrVals = hrData.map(d => d.v);
const rrVals = rrData.map(d => d.v);

const SPO2_MIN = Math.max(70, Math.min(...spo2Vals) - 2);
const SPO2_MAX = 100;
const HR_MIN = Math.max(30, Math.floor((Math.min(...hrVals) - 3) / 5) * 5);
const HR_MAX = Math.min(200, Math.ceil((Math.max(...hrVals) + 3) / 5) * 5);
const RR_MIN = 0;
const RR_MAX = Math.ceil((Math.max(...rrVals) + 2) / 5) * 5;
const MOT_MAX = Math.max(10, Math.ceil(Math.max(...motData.map(d => d.v)) / 5) * 5);

// Compute apnea Y-axis range (seconds)
const APNEA_MAX_DUR = apneaData.length > 0
  ? Math.ceil(Math.max(...apneaData.map(d => d.dur)) / 10) * 10
  : 60;

// Compute HR moving average (window ~5 minutes centered)
const HR_MA_WINDOW = 75;  // samples each side (~5 min half-window at 4s interval)
const hrMA = [];
for (let i = 0; i < hrData.length; i++) {
  let lo = Math.max(0, i - HR_MA_WINDOW);
  let hi = Math.min(hrData.length - 1, i + HR_MA_WINDOW);
  let sum = 0;
  for (let j = lo; j <= hi; j++) sum += hrData[j].v;
  hrMA.push({t: hrData[i].t, v: Math.round(sum / (hi - lo + 1) * 10) / 10});
}

// Detect SpO2 dips below 85% (local minima with >=20 sample spacing)
const SPO2_DIP_THRESH = 85;
const spo2Dips = [];
const DIP_MIN_SEP = 20; // minimum samples between reported dips
for (let i = 1; i < spo2Data.length - 1; i++) {
  const v = spo2Data[i].v;
  if (v >= SPO2_DIP_THRESH) continue;
  // Check it's a local minimum within a window of ±5 samples
  let isMin = true;
  for (let j = Math.max(0, i-5); j <= Math.min(spo2Data.length-1, i+5); j++) {
    if (j !== i && spo2Data[j].v < v) { isMin = false; break; }
  }
  if (!isMin) continue;
  // Enforce spacing from previous dip
  if (spo2Dips.length > 0 && i - spo2Dips[spo2Dips.length-1].idx < DIP_MIN_SEP) {
    // Keep the deeper one
    if (v < spo2Dips[spo2Dips.length-1].v) spo2Dips[spo2Dips.length-1] = {idx: i, t: spo2Data[i].t, v};
    continue;
  }
  spo2Dips.push({idx: i, t: spo2Data[i].t, v});
}

// Compute HR 15-minute moving average (for good-sleep detection)
const HR_MA15_WINDOW = 112;  // samples each side (~7.5 min half-window → 15 min total at 4s)
const hrMA15 = [];
for (let i = 0; i < hrData.length; i++) {
  let lo = Math.max(0, i - HR_MA15_WINDOW);
  let hi = Math.min(hrData.length - 1, i + HR_MA15_WINDOW);
  let sum = 0;
  for (let j = lo; j <= hi; j++) sum += hrData[j].v;
  hrMA15.push({t: hrData[i].t, v: sum / (hi - lo + 1)});
}

// ============================================================
// Detect "good sleep" periods (≥20 min contiguous)
//   1. No apnea events
//   2. No obstructions (moderate or severe)
//   3. SpO2 ≥ 96%
//   4. 15-min HR MA non-increasing
// ============================================================
const GOOD_MIN_DURATION = 15; // minutes
const HR_RISE_TOL = 1.0;     // bpm tolerance for "non-increasing"
const HR_LOOKBACK = 30;      // samples (~2 min) for slope check

// Build sorted event intervals for quick overlap checks
const evtIntervals = [];
for (const a of apneaData) evtIntervals.push({t0: a.t, t1: a.t + a.dur / 60});
for (const o of obstrData) evtIntervals.push({t0: o.t, t1: o.t + o.dur / 60});
evtIntervals.sort((a, b) => a.t0 - b.t0);

// Scan at HR data resolution
const goodMask = new Uint8Array(hrData.length); // 1 = good at this sample
for (let i = 0; i < hrData.length; i++) {
  const t = hrData[i].t;

  // Check 1 & 2: no apnea or obstruction overlapping this time
  let hasEvent = false;
  for (const ev of evtIntervals) {
    if (ev.t0 > t + 0.5) break; // events are sorted, no need to check further
    if (ev.t1 >= t - 0.5) { hasEvent = true; break; }
  }
  if (hasEvent) continue;

  // Check 3: SpO2 ≥ 96% (find nearest SpO2 sample)
  // Binary-ish search: SpO2 data is same resolution as HR from same source
  let spo2Ok = false;
  for (let si = Math.max(0, i - 2); si <= Math.min(spo2Data.length - 1, i + 2); si++) {
    if (Math.abs(spo2Data[si].t - t) < 0.2) {
      if (spo2Data[si].v >= 96) spo2Ok = true;
      break;
    }
  }
  if (!spo2Ok) continue;

  // Check 4: 15-min HR MA non-increasing (not rising >1 bpm vs 2 min ago)
  if (i >= HR_LOOKBACK) {
    if (hrMA15[i].v > hrMA15[i - HR_LOOKBACK].v + HR_RISE_TOL) continue;
  }

  goodMask[i] = 1;
}

// Extract contiguous runs ≥ GOOD_MIN_DURATION
const goodPeriods = [];
let runStart = -1;
for (let i = 0; i <= hrData.length; i++) {
  if (i < hrData.length && goodMask[i]) {
    if (runStart < 0) runStart = i;
  } else {
    if (runStart >= 0) {
      const tStart = hrData[runStart].t;
      const tEnd = hrData[i - 1].t;
      if (tEnd - tStart >= GOOD_MIN_DURATION) {
        goodPeriods.push({t0: tStart, t1: tEnd});
      }
      runStart = -1;
    }
  }
}

// Append restful total to subtitle
const restfulTotal = Math.round(goodPeriods.reduce((s, gp) => s + (gp.t1 - gp.t0), 0));
document.querySelector('.subtitle').insertAdjacentHTML('beforeend',
  ` \u00a0\u00a0\u2022 \u00a0Restful: ${restfulTotal}m`);

// Generate tick arrays
function makeTicks(lo, hi, step) {
  const ticks = [];
  for (let v = Math.ceil(lo/step)*step; v <= hi; v += step) ticks.push(v);
  return ticks;
}

const spo2Ticks = makeTicks(SPO2_MIN, SPO2_MAX, 5);
const hrTicks = makeTicks(HR_MIN, HR_MAX, (HR_MAX - HR_MIN > 40) ? 10 : 5);
const rrTicks = makeTicks(RR_MIN, RR_MAX, 5);
const apneaTicks = makeTicks(0, APNEA_MAX_DUR, APNEA_MAX_DUR > 80 ? 20 : 10);
const motTicks = makeTicks(0, MOT_MAX, MOT_MAX > 30 ? Math.ceil(MOT_MAX / 3 / 5) * 5 : 5);

// ============================================================
// DRAW
// ============================================================
function draw() {
  ctx.fillStyle = theme.bodyBg;
  ctx.fillRect(0, 0, W, TOTAL_H);
  for (let i = 0; i < 5; i++) drawPanelBg(i);
  drawXAxis();

  // Panel 0: SpO2
  drawYAxis(SPO2_MIN, SPO2_MAX, 0, spo2Ticks, 'SpO\u2082 %', theme.spo2);
  const y90 = valToY(90, SPO2_MIN, SPO2_MAX, 0);
  ctx.strokeStyle = theme.spo2Ref;
  ctx.lineWidth = 1;
  ctx.setLineDash([4,4]);
  ctx.beginPath(); ctx.moveTo(MARGIN.left, y90); ctx.lineTo(MARGIN.left+plotW, y90); ctx.stroke();
  ctx.setLineDash([]);
  drawLine(spo2Data, 't', 'v', SPO2_MIN, SPO2_MAX, 0, theme.spo2, 1.0);

  // Label SpO2 dips below 85%
  ctx.font = 'bold 11px IBM Plex Mono';
  ctx.fillStyle = theme.spo2DipText;
  ctx.textAlign = 'center';
  ctx.textBaseline = 'top';
  for (const dip of spo2Dips) {
    const dx = tToX(dip.t);
    const dy = valToY(dip.v, SPO2_MIN, SPO2_MAX, 0);
    ctx.fillText(dip.v + '%', dx, dy + 3);
  }

  // Panel 1: HR
  drawYAxis(HR_MIN, HR_MAX, 1, hrTicks, 'HR bpm', theme.hr);
  drawLine(hrData, 't', 'v', HR_MIN, HR_MAX, 1, theme.hr, 1.0);
  drawLine(hrMA, 't', 'v', HR_MIN, HR_MAX, 1, theme.hrMA, 2.0);

  // Panel 2: Respiratory Rate
  drawYAxis(RR_MIN, RR_MAX, 2, rrTicks, 'Resp br/m', theme.resp);
  drawArea(rrData, 't', 'v', RR_MIN, RR_MAX, 2, theme.respArea);
  drawLine(rrData, 't', 'v', RR_MIN, RR_MAX, 2, theme.resp, 1.2);

  // Panel 3: Events (apnea bars scaled to seconds Y-axis)
  const EVT_TOP = panelTop(3);
  const EVT_H = PANEL_HEIGHTS[3];
  drawYAxis(0, APNEA_MAX_DUR, 3, apneaTicks, 'Apnea (s)', theme.evtLabel);

  // Draw good-sleep indicators (green dotted line at panel midpoint)
  const goodY = EVT_TOP + EVT_H * 0.5;
  ctx.strokeStyle = theme.goodSleep;
  ctx.lineWidth = 2;
  ctx.setLineDash([6, 4]);
  for (const gp of goodPeriods) {
    const x0 = Math.max(tToX(gp.t0), MARGIN.left);
    const x1 = Math.min(tToX(gp.t1), MARGIN.left + plotW);
    if (x1 <= x0) continue;
    ctx.beginPath();
    ctx.moveTo(x0, goodY);
    ctx.lineTo(x1, goodY);
    ctx.stroke();
  }
  ctx.setLineDash([]);

  // Draw all apnea bars first (clipped to plot area)
  const apneaBars = [];
  const plotLeft = MARGIN.left;
  const plotRight = MARGIN.left + plotW;
  for (const a of apneaData) {
    let x = tToX(a.t);
    const w = Math.max(1.5, (a.dur / 60) / (T_MAX - T_MIN) * plotW);
    let x2 = x + w;
    // Clip to plot area
    if (x2 < plotLeft || x > plotRight) continue;
    x = Math.max(x, plotLeft);
    x2 = Math.min(x2, plotRight);
    const clampDur = Math.min(a.dur, APNEA_MAX_DUR);
    const barBot = EVT_TOP + EVT_H - 6;
    const barTop = valToY(clampDur, 0, APNEA_MAX_DUR, 3);
    const h = barBot - barTop;
    const isLong = a.dur > 50;
    ctx.fillStyle = isLong ? theme.apneaLong : theme.apneaBar;
    ctx.fillRect(x, barTop, x2 - x, h);
    apneaBars.push({x, w: x2 - x, barTop, barBot, dur: a.dur, isLong});
  }

  // Collect obstruction dot bounding boxes
  const obstrBoxes = [];
  for (const o of obstrData) {
    const ox = tToX(o.t);
    if (ox < plotLeft || ox > plotRight) continue;
    const oy = EVT_TOP + (o.sev === 1 ? 6 : 16);
    const r = o.sev === 1 ? 2.5 : 2;
    obstrBoxes.push({x: ox - r, y: oy - r, w: r*2, h: r*2});
    ctx.beginPath();
    ctx.arc(ox, oy, r, 0, Math.PI*2);
    ctx.fillStyle = o.sev === 1 ? theme.obstrSevere : theme.obstrMod;
    ctx.fill();
  }

  // Place >50s apnea labels: prefer left/right of bar, no leader lines
  ctx.font = 'bold 11px IBM Plex Mono';
  const LABEL_H = 12;
  const LABEL_GAP = 3;
  const placedLabels = []; // {x, y, w, h} bounding boxes

  function boxOverlaps(ax, ay, aw, ah, bx, by, bw, bh) {
    return ax < bx + bw && ax + aw > bx && ay < by + bh && ay + ah > by;
  }

  function labelCollides(lx, ly, lw) {
    for (const ob of obstrBoxes) {
      if (boxOverlaps(lx, ly, lw, LABEL_H, ob.x - 2, ob.y - 2, ob.w + 4, ob.h + 4)) return true;
    }
    for (const pl of placedLabels) {
      if (boxOverlaps(lx, ly, lw, LABEL_H, pl.x, pl.y, pl.w, pl.h)) return true;
    }
    for (const b of apneaBars) {
      if (boxOverlaps(lx, ly, lw, LABEL_H, b.x - 1, b.barTop, b.w + 2, b.barBot - b.barTop)) return true;
    }
    return false;
  }

  // Collect long bars and group into clusters (nearby = within 40px)
  const longBars = apneaBars.filter(b => b.isLong);
  const CLUSTER_DIST = 40;
  const clusters = [];
  for (const b of longBars) {
    const cx = b.x + b.w / 2;
    if (clusters.length > 0) {
      const last = clusters[clusters.length - 1];
      const lastCx = last[last.length - 1].x + last[last.length - 1].w / 2;
      if (cx - lastCx < CLUSTER_DIST) {
        last.push(b);
        continue;
      }
    }
    clusters.push([b]);
  }

  for (const cluster of clusters) {
    for (let ci = 0; ci < cluster.length; ci++) {
      const b = cluster[ci];
      const label = Math.round(b.dur) + 's';
      const lw = ctx.measureText(label).width + 4;
      const midY = b.barTop + Math.min(12, (b.barBot - b.barTop) * 0.3);

      // Build ordered candidate positions
      const candidates = [];
      const leftX = b.x - lw - LABEL_GAP;
      const rightX = b.x + b.w + LABEL_GAP;
      const aboveX = b.x + b.w/2 - lw/2;
      const aboveY = b.barTop - LABEL_H - 2;

      if (cluster.length === 1) {
        // Isolated: try right, left, then above
        candidates.push({x: rightX, y: midY});
        candidates.push({x: leftX, y: midY});
        candidates.push({x: aboveX, y: aboveY});
      } else if (cluster.length === 2) {
        // Pair: first goes left, second goes right
        if (ci === 0) {
          candidates.push({x: leftX, y: midY});
          candidates.push({x: rightX, y: midY});
          candidates.push({x: aboveX, y: aboveY});
        } else {
          candidates.push({x: rightX, y: midY});
          candidates.push({x: leftX, y: midY});
          candidates.push({x: aboveX, y: aboveY});
        }
      } else {
        // 3+: outer go outward, middle ones go above then left/right
        if (ci === 0) {
          candidates.push({x: leftX, y: midY});
          candidates.push({x: aboveX, y: aboveY});
          candidates.push({x: rightX, y: midY});
        } else if (ci === cluster.length - 1) {
          candidates.push({x: rightX, y: midY});
          candidates.push({x: aboveX, y: aboveY});
          candidates.push({x: leftX, y: midY});
        } else {
          candidates.push({x: aboveX, y: aboveY});
          candidates.push({x: rightX, y: midY});
          candidates.push({x: leftX, y: midY});
        }
      }

      // Try each candidate, pick first that fits
      let placed = false;
      for (const c of candidates) {
        if (c.x < MARGIN.left - 4 || c.x + lw > MARGIN.left + plotW + 4) continue;
        if (c.y < EVT_TOP) continue;
        if (!labelCollides(c.x, c.y, lw)) {
          ctx.fillStyle = theme.apneaLongText;
          ctx.textAlign = 'left';
          ctx.textBaseline = 'top';
          ctx.fillText(label, c.x, c.y);
          placedLabels.push({x: c.x, y: c.y, w: lw, h: LABEL_H});
          placed = true;
          break;
        }
      }
      // Fallback: draw to right regardless
      if (!placed) {
        const fx = rightX;
        const fy = midY;
        ctx.fillStyle = theme.apneaLongText;
        ctx.textAlign = 'left';
        ctx.textBaseline = 'top';
        ctx.fillText(label, fx, fy);
        placedLabels.push({x: fx, y: fy, w: lw, h: LABEL_H});
      }
    }
  }

  // Panel 4: Motion
  const MOT_TOP = panelTop(4);
  const MOT_H = PANEL_HEIGHTS[4];
  drawYAxis(0, MOT_MAX, 4, motTicks, 'Motion', theme.motionAxis);
  for (const m of motData) {
    if (m.v === 0) continue;
    const x = tToX(m.t);
    if (x < MARGIN.left || x > MARGIN.left + plotW) continue;
    const barH = Math.max(1, (Math.min(m.v, MOT_MAX) / MOT_MAX) * (MOT_H - 8));
    const y = MOT_TOP + MOT_H - 3 - barH;
    ctx.fillStyle = theme.motionBar;
    ctx.fillRect(x - 0.5, y, 1.5, barH);
  }
}

draw();

// ============================================================
// Tooltip / Crosshair
// ============================================================
const tooltip = document.getElementById('tooltip');
const chartArea = document.getElementById('chartArea');

function findNearest(arr, t) {
  const maxDist = Math.max(0.5, (T_MAX - T_MIN) * 0.006); // ~0.6% of visible range
  let best = null, bestDist = Infinity;
  for (const pt of arr) {
    const d = Math.abs(pt.t - t);
    if (d < bestDist) { bestDist = d; best = pt; }
  }
  return bestDist < maxDist ? best : null;
}

chartArea.addEventListener('mousemove', (e) => {
  if (panState) {
    crosshair.style.display = 'none';
    tooltip.style.display = 'none';
    return;
  }
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  const my = e.clientY - rect.top;

  if (mx < MARGIN.left || mx > MARGIN.left + plotW || my > TOTAL_H - MARGIN.bottom) {
    crosshair.style.display = 'none';
    tooltip.style.display = 'none';
    return;
  }

  const t = xToT(mx);
  crosshair.style.display = 'block';
  crosshair.style.left = mx + 'px';

  const sp = findNearest(spo2Data, t);
  const hr = findNearest(hrData, t);
  const hrm = findNearest(hrMA, t);
  const rr = findNearest(rrData, t);
  const mo = findNearest(motData, t);

  let apnStr = '';
  for (const a of apneaData) {
    if (t >= a.t && t <= a.t + a.dur/60) {
      apnStr = `${a.dur.toFixed(0)}s apnea`;
      break;
    }
  }

  let html = `<div class="tt-time">${minToClockStrFull(t)}</div>`;
  if (sp) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.spo2}"></div>SpO\u2082: ${sp.v}%</div>`;
  if (hr) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.hr}"></div>HR: ${hr.v} bpm</div>`;
  if (hrm) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.hrMA}"></div>HR avg: ${hrm.v} bpm</div>`;
  if (rr) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.resp}"></div>Resp: ${rr.v} br/min</div>`;
  if (mo && mo.v > 0) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.motionAxis}"></div>Motion: ${mo.v}</div>`;
  if (apnStr) html += `<div class="tt-row"><div class="tt-dot" style="background:${theme.obstrSevere}"></div>${apnStr}</div>`;

  tooltip.innerHTML = html;
  tooltip.style.display = 'block';

  let tx = mx + 16;
  let ty = my - 10;
  const tw = tooltip.offsetWidth;
  if (tx + tw > W - 8) tx = mx - tw - 16;
  if (ty < 4) ty = 4;
  tooltip.style.left = tx + 'px';
  tooltip.style.top = ty + 'px';
});

chartArea.addEventListener('mouseleave', () => {
  crosshair.style.display = 'none';
  tooltip.style.display = 'none';
});

// ============================================================
// Zoom & Pan
// ============================================================
const ZOOM_FACTOR = 0.8; // scroll-zoom sensitivity (smaller = zoom faster)
const MIN_RANGE = 2;     // minimum visible range in minutes

function updateZoomUI() {
  const btn = document.getElementById('resetZoom');
  const isZoomed = Math.abs(T_MIN - T_MIN_FULL) > 0.1 || Math.abs(T_MAX - T_MAX_FULL) > 0.1;
  btn.style.display = isZoomed ? 'block' : 'none';
  canvas.classList.toggle('zoomed', isZoomed);
}

function resetZoom() {
  T_MIN = T_MIN_FULL;
  T_MAX = T_MAX_FULL;
  updateZoomUI();
  draw();
}

// Wheel zoom: centered on cursor position
chartArea.addEventListener('wheel', (e) => {
  e.preventDefault();
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  if (mx < MARGIN.left || mx > MARGIN.left + plotW) return;

  const tCursor = xToT(mx);
  const range = T_MAX - T_MIN;
  const factor = e.deltaY > 0 ? 1 / ZOOM_FACTOR : ZOOM_FACTOR;
  const newRange = Math.max(MIN_RANGE, Math.min(T_MAX_FULL - T_MIN_FULL, range * factor));

  // Fraction of cursor within the current view
  const frac = (tCursor - T_MIN) / range;
  T_MIN = tCursor - frac * newRange;
  T_MAX = tCursor + (1 - frac) * newRange;

  // Clamp to full range
  if (T_MIN < T_MIN_FULL) { T_MAX += T_MIN_FULL - T_MIN; T_MIN = T_MIN_FULL; }
  if (T_MAX > T_MAX_FULL) { T_MIN -= T_MAX - T_MAX_FULL; T_MAX = T_MAX_FULL; }
  T_MIN = Math.max(T_MIN, T_MIN_FULL);
  T_MAX = Math.min(T_MAX, T_MAX_FULL);

  updateZoomUI();
  draw();
}, {passive: false});

// Click-drag pan
let panState = null;
chartArea.addEventListener('mousedown', (e) => {
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  if (mx < MARGIN.left || mx > MARGIN.left + plotW) return;
  // Only pan when zoomed in
  if (Math.abs(T_MAX - T_MIN - (T_MAX_FULL - T_MIN_FULL)) < 0.1) return;
  panState = { startX: e.clientX, startTMin: T_MIN, startTMax: T_MAX };
  canvas.classList.add('panning');
});

window.addEventListener('mousemove', (e) => {
  if (!panState) return;
  const dx = e.clientX - panState.startX;
  const dtPerPx = (panState.startTMax - panState.startTMin) / plotW;
  let shift = -dx * dtPerPx;

  let newMin = panState.startTMin + shift;
  let newMax = panState.startTMax + shift;
  if (newMin < T_MIN_FULL) { newMax += T_MIN_FULL - newMin; newMin = T_MIN_FULL; }
  if (newMax > T_MAX_FULL) { newMin -= newMax - T_MAX_FULL; newMax = T_MAX_FULL; }

  T_MIN = Math.max(newMin, T_MIN_FULL);
  T_MAX = Math.min(newMax, T_MAX_FULL);
  updateZoomUI();
  draw();
});

window.addEventListener('mouseup', () => {
  if (panState) {
    panState = null;
    canvas.classList.remove('panning');
  }
});

// ============================================================
// Save PNG at specified resolution with header
// ============================================================
function savePNG(exportScale) {
  const EXPORT_SCALE = exportScale || 2;
  const isLight = document.body.classList.contains('light-theme');

  // --- Measure header content from DOM ---
  const titleText = document.querySelector('h1').textContent;
  const subtitleText = document.querySelector('.subtitle').textContent;
  const legendItems = [];
  document.querySelectorAll('.legend-item').forEach(item => {
    const swatch = item.querySelector('.legend-swatch');
    const cs = getComputedStyle(swatch);
    legendItems.push({
      color: cs.backgroundColor,
      borderColor: cs.borderTopColor,
      isDot: swatch.classList.contains('dot'),
      isBar: swatch.classList.contains('bar'),
      text: item.textContent.trim()
    });
  });

  // --- Header layout constants ---
  const PAD_TOP = 12;
  const TITLE_H = 24;
  const GAP1 = 4;
  const SUB_H = 16;
  const GAP2 = 8;
  const LEG_PAD = 8;
  const LEG_ROW_H = 16;
  const LEG_BOT = 8;

  // Pre-measure legend to determine if it wraps
  const tmpC = document.createElement('canvas');
  const tmpX = tmpC.getContext('2d');
  tmpX.font = '12px IBM Plex Mono';
  const LEG_ITEM_GAP = 20;
  const LEG_SWATCH_W = 20;
  const maxLegW = W - 32;
  let rows = [[]];
  let rowW = 0;
  for (const item of legendItems) {
    const iw = LEG_SWATCH_W + tmpX.measureText(item.text).width + LEG_ITEM_GAP;
    if (rowW > 0 && rowW + iw > maxLegW) {
      rows.push([]);
      rowW = 0;
    }
    rows[rows.length - 1].push(item);
    rowW += iw;
  }
  const legendBoxH = LEG_PAD + rows.length * LEG_ROW_H + LEG_BOT;
  const headerH = PAD_TOP + TITLE_H + GAP1 + SUB_H + GAP2 + legendBoxH + 8;

  // --- Create offscreen canvas ---
  const totalH = headerH + TOTAL_H;
  const off = document.createElement('canvas');
  off.width = W * EXPORT_SCALE;
  off.height = totalH * EXPORT_SCALE;
  const oc = off.getContext('2d');
  oc.setTransform(EXPORT_SCALE, 0, 0, EXPORT_SCALE, 0, 0);

  // Background
  oc.fillStyle = theme.bodyBg;
  oc.fillRect(0, 0, W, totalH);

  // Title
  let y = PAD_TOP;
  oc.font = '600 20px IBM Plex Sans, sans-serif';
  oc.fillStyle = theme.titleText;
  oc.textAlign = 'left';
  oc.textBaseline = 'top';
  oc.fillText(titleText, 0, y);

  // Version stamp (top-right, subtle)
  const versionText = document.getElementById('versionStamp').textContent;
  oc.font = '9px IBM Plex Mono, monospace';
  oc.fillStyle = theme.versionText;
  oc.textAlign = 'right';
  oc.textBaseline = 'top';
  oc.fillText(versionText, W, y + 4);
  oc.textAlign = 'left';

  y += TITLE_H + GAP1;

  // Subtitle
  oc.font = '13px IBM Plex Mono, monospace';
  oc.fillStyle = theme.subtitleText;
  oc.fillText(subtitleText, 0, y);
  y += SUB_H + GAP2;

  // Legend box
  oc.fillStyle = theme.legendBg;
  oc.strokeStyle = theme.legendBorder;
  oc.lineWidth = 1;
  const legBoxY = y;
  oc.beginPath();
  oc.roundRect(16, legBoxY, W - 32, legendBoxH, 6);
  oc.fill();
  oc.stroke();

  // Legend items
  oc.font = '12px IBM Plex Mono, monospace';
  let ly = legBoxY + LEG_PAD;
  for (const row of rows) {
    let lx = 32;
    for (const item of row) {
      // Swatch
      oc.fillStyle = item.color;
      if (item.isDot) {
        oc.beginPath();
        oc.arc(lx + 4, ly + 6, 4, 0, Math.PI * 2);
        oc.fill();
      } else if (item.isBar) {
        oc.fillRect(lx, ly + 1, 14, 10);
      } else {
        // Check if this is the "Restful" item (dotted line style)
        if (item.text.includes('Restful')) {
          oc.strokeStyle = item.borderColor || item.color;
          oc.lineWidth = 2;
          oc.setLineDash([6, 4]);
          oc.beginPath();
          oc.moveTo(lx, ly + 6);
          oc.lineTo(lx + 14, ly + 6);
          oc.stroke();
          oc.setLineDash([]);
        } else {
          // Regular solid line
          oc.fillRect(lx, ly + 4, 14, 4);
        }
      }
      lx += LEG_SWATCH_W;
      // Label
      oc.fillStyle = theme.legendText;
      oc.textAlign = 'left';
      oc.textBaseline = 'top';
      oc.fillText(item.text, lx, ly);
      lx += oc.measureText(item.text).width + LEG_ITEM_GAP;
    }
    ly += LEG_ROW_H;
  }

  // --- Render chart at export scale, then composite ---
  canvas.width = W * EXPORT_SCALE;
  canvas.height = TOTAL_H * EXPORT_SCALE;
  ctx.setTransform(EXPORT_SCALE, 0, 0, EXPORT_SCALE, 0, 0);
  draw();

  oc.setTransform(1, 0, 0, 1, 0, 0);
  oc.drawImage(canvas, 0, headerH * EXPORT_SCALE,
               W * EXPORT_SCALE, TOTAL_H * EXPORT_SCALE);

  // --- Download ---
  const link = document.createElement('a');
  link.download = `sleep_dashboard_2026-02-05_${EXPORT_SCALE}x.png`;
  link.href = off.toDataURL('image/png');
  link.click();

  // --- Restore main canvas ---
  canvas.width = W * DPR;
  canvas.height = TOTAL_H * DPR;
  canvas.style.height = TOTAL_H + 'px';
  ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
  draw();
}

window.addEventListener('resize', () => {
  computeLayout();
  draw();
});
</script>
</body>
</html>